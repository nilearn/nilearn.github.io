

.. _example_connectivity_plot_adhd_covariance.py:


Computation of covariance matrix between brain regions
======================================================

This example shows how to extract signals from regions defined by an atlas,
and to estimate a covariance matrix based on these signals.



.. rst-class:: horizontal


    *

      .. image:: images/plot_adhd_covariance_1.png
            :scale: 47

    *

      .. image:: images/plot_adhd_covariance_2.png
            :scale: 47

    *

      .. image:: images/plot_adhd_covariance_3.png
            :scale: 47

    *

      .. image:: images/plot_adhd_covariance_4.png
            :scale: 47

    *

      .. image:: images/plot_adhd_covariance_5.png
            :scale: 47

    *

      .. image:: images/plot_adhd_covariance_6.png
            :scale: 47

    *

      .. image:: images/plot_adhd_covariance_7.png
            :scale: 47

    *

      .. image:: images/plot_adhd_covariance_8.png
            :scale: 47


**Script output**:

.. rst-class:: max_height

 ::

    -- Fetching datasets ...
  [NiftiMapsMasker.fit] loading regions from /home/lesteve/nilearn_data/msdl_atlas/MSDL_rois/msdl_rois.nii
  Processing file /home/lesteve/nilearn_data/adhd/data/3902469/3902469_rest_tshift_RPI_voreg_mni.nii.gz
  -- Computing confounds ...
  -- Computing region signals ...
  [NiftiMapsMasker.transform] loading images from /home/lesteve/nilearn_data/adhd/data/3902469/3902469_rest_tshift_RPI_voreg_mni.nii.gz
  [NiftiMapsMasker.transform] resampling images to fit maps
  [NiftiMapsMasker.transform] extracting region signals
  [NiftiMapsMasker.transform] cleaning extracted signals
  Processing file /home/lesteve/nilearn_data/adhd/data/7774305/7774305_rest_tshift_RPI_voreg_mni.nii.gz
  -- Computing confounds ...
  -- Computing region signals ...
  [NiftiMapsMasker.transform] loading images from /home/lesteve/nilearn_data/adhd/data/7774305/7774305_rest_tshift_RPI_voreg_mni.nii.gz
  [NiftiMapsMasker.transform] resampling images to fit maps
  [NiftiMapsMasker.transform] extracting region signals
  [NiftiMapsMasker.transform] cleaning extracted signals
  Processing file /home/lesteve/nilearn_data/adhd/data/3699991/3699991_rest_tshift_RPI_voreg_mni.nii.gz
  -- Computing confounds ...
  -- Computing region signals ...
  [NiftiMapsMasker.transform] loading images from /home/lesteve/nilearn_data/adhd/data/3699991/3699991_rest_tshift_RPI_voreg_mni.nii.gz
  [NiftiMapsMasker.transform] resampling images to fit maps
  [NiftiMapsMasker.transform] extracting region signals
  [NiftiMapsMasker.transform] cleaning extracted signals
  Processing file /home/lesteve/nilearn_data/adhd/data/2014113/2014113_rest_tshift_RPI_voreg_mni.nii.gz
  -- Computing confounds ...
  -- Computing region signals ...
  [NiftiMapsMasker.transform] loading images from /home/lesteve/nilearn_data/adhd/data/2014113/2014113_rest_tshift_RPI_voreg_mni.nii.gz
  [NiftiMapsMasker.transform] resampling images to fit maps
  [NiftiMapsMasker.transform] extracting region signals
  [NiftiMapsMasker.transform] cleaning extracted signals
  Processing file /home/lesteve/nilearn_data/adhd/data/4275075/4275075_rest_tshift_RPI_voreg_mni.nii.gz
  -- Computing confounds ...
  -- Computing region signals ...
  [NiftiMapsMasker.transform] loading images from /home/lesteve/nilearn_data/adhd/data/4275075/4275075_rest_tshift_RPI_voreg_mni.nii.gz
  [NiftiMapsMasker.transform] resampling images to fit maps
  [NiftiMapsMasker.transform] extracting region signals
  [NiftiMapsMasker.transform] cleaning extracted signals
  Processing file /home/lesteve/nilearn_data/adhd/data/1019436/1019436_rest_tshift_RPI_voreg_mni.nii.gz
  -- Computing confounds ...
  -- Computing region signals ...
  [NiftiMapsMasker.transform] loading images from /home/lesteve/nilearn_data/adhd/data/1019436/1019436_rest_tshift_RPI_voreg_mni.nii.gz
  [NiftiMapsMasker.transform] resampling images to fit maps
  [NiftiMapsMasker.transform] extracting region signals
  [NiftiMapsMasker.transform] cleaning extracted signals
  Processing file /home/lesteve/nilearn_data/adhd/data/3154996/3154996_rest_tshift_RPI_voreg_mni.nii.gz
  -- Computing confounds ...
  -- Computing region signals ...
  [NiftiMapsMasker.transform] loading images from /home/lesteve/nilearn_data/adhd/data/3154996/3154996_rest_tshift_RPI_voreg_mni.nii.gz
  [NiftiMapsMasker.transform] resampling images to fit maps
  [NiftiMapsMasker.transform] extracting region signals
  [NiftiMapsMasker.transform] cleaning extracted signals
  Processing file /home/lesteve/nilearn_data/adhd/data/3884955/3884955_rest_tshift_RPI_voreg_mni.nii.gz
  -- Computing confounds ...
  -- Computing region signals ...
  [NiftiMapsMasker.transform] loading images from /home/lesteve/nilearn_data/adhd/data/3884955/3884955_rest_tshift_RPI_voreg_mni.nii.gz
  [NiftiMapsMasker.transform] resampling images to fit maps
  [NiftiMapsMasker.transform] extracting region signals
  [NiftiMapsMasker.transform] cleaning extracted signals
  Processing file /home/lesteve/nilearn_data/adhd/data/0027034/0027034_rest_tshift_RPI_voreg_mni.nii.gz
  -- Computing confounds ...
  -- Computing region signals ...
  [NiftiMapsMasker.transform] loading images from /home/lesteve/nilearn_data/adhd/data/0027034/0027034_rest_tshift_RPI_voreg_mni.nii.gz
  [NiftiMapsMasker.transform] resampling images to fit maps
  [NiftiMapsMasker.transform] extracting region signals
  [NiftiMapsMasker.transform] cleaning extracted signals
  Processing file /home/lesteve/nilearn_data/adhd/data/4134561/4134561_rest_tshift_RPI_voreg_mni.nii.gz
  -- Computing confounds ...
  -- Computing region signals ...
  [NiftiMapsMasker.transform] loading images from /home/lesteve/nilearn_data/adhd/data/4134561/4134561_rest_tshift_RPI_voreg_mni.nii.gz
  [NiftiMapsMasker.transform] resampling images to fit maps
  [NiftiMapsMasker.transform] extracting region signals
  ________________________________________________________________________________
  [Memory] Calling nilearn.region.img_to_signals_maps...
  img_to_signals_maps(<nibabel.nifti1.Nifti1Image object at 0x2b0aa19b2290>, <nibabel.nifti1.Nifti1Image object at 0x2b0a9a47fe10>, mask_img=None)
  ______________________________________________img_to_signals_maps - 1.8s, 0.0min
  [NiftiMapsMasker.transform] cleaning extracted signals
  -- Computing group-sparse precision matrices ...
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.189e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 2: 9.808e-09
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 9.046e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.562e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 4.584e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 2.528e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 1.250e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 6.419e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 6 (12 %) variation (max norm): 3.168e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 7 (14 %) variation (max norm): 2.203e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 8 (16 %) variation (max norm): 1.122e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 9: 3.415e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 1: 1.428e-04
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 9.131e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.424e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 4.664e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 2.329e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 1.161e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 5.709e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 6 (12 %) variation (max norm): 2.635e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 7 (14 %) variation (max norm): 1.702e-02  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 7
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 1: 0.000e+00
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 9.608e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.702e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 5.447e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 3.429e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 2.005e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 1.115e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 6 (12 %) variation (max norm): 5.719e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 7 (14 %) variation (max norm): 2.938e-02  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 7
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  1 out of 4
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.555e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 5.754e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 1.778e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 5.088e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 1.914e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 6: 7.938e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 5.648e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 2.113e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 9.431e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 4.371e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 1.732e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 6: 9.247e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.685e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.023e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 1.852e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 6.432e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 1.906e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 6: 7.625e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 5.254e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.948e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 8.719e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 3.753e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 1.502e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 6: 6.608e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.666e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 8.317e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 1.958e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 5.456e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 2.318e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 6 (12 %) variation (max norm): 1.070e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 7: 4.994e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 6.130e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 2.331e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 1.274e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 6.676e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 2.964e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 6 (12 %) variation (max norm): 1.319e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 7: 5.915e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  2 out of 4
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.815e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 6.141e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 2.742e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 6.477e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 2.430e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 6 (12 %) variation (max norm): 1.109e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 7: 5.070e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.739e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 6.064e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 3.009e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 4: 9.915e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.666e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 7.145e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 2.979e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 1.213e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 5: 4.965e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.584e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 7.997e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 3.477e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 1.479e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 5: 6.688e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.984e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.085e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 2.497e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 1.101e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 2.461e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 6 (12 %) variation (max norm): 1.114e-02  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 6
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.704e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 5.803e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 2.518e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 4: 9.459e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.656e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 6.415e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 2.567e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 1.107e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 5: 4.342e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.531e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 7.203e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 2.723e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 1.289e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 5: 5.790e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.963e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 8.803e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 2.715e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 9.301e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 3.084e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 6 (12 %) variation (max norm): 1.291e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 7: 7.532e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.018e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 6.960e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 3.793e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 1.549e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 5: 5.784e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.975e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 8.172e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 3.888e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 1.886e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 5: 8.042e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  3 out of 4
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.177e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 6.693e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 4.071e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 1.296e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 5.677e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 6 (12 %) variation (max norm): 3.487e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 7 (14 %) variation (max norm): 1.014e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 8: 5.753e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.314e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.561e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 6.718e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.380e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.666e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 7.243e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.362e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.703e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 7.517e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.522e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 9.278e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 5.085e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 1.348e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 8.228e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 6 (12 %) variation (max norm): 3.792e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 7 (14 %) variation (max norm): 1.065e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 8: 6.046e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.220e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.437e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 5.360e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.219e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.533e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 5.841e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.552e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 8.774e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 4.653e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (8 %) variation (max norm): 2.012e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (10 %) variation (max norm): 8.308e-02  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 5
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 5.017e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 2.622e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 1.167e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 4: 5.612e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] probe_function interrupted loop
  [GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  4 out of 4
  [GroupSparseCovarianceCV.fit] Final optimization
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (1 %) variation (max norm): 2.293e+00  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (2 %) variation (max norm): 7.518e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (3 %) variation (max norm): 3.874e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 4 (4 %) variation (max norm): 1.484e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 5 (5 %) variation (max norm): 6.374e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 6 (6 %) variation (max norm): 3.158e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 7 (7 %) variation (max norm): 1.141e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 8 (8 %) variation (max norm): 5.332e-03  ...
  [GroupSparseCovarianceCV.fit] * iteration 9 (9 %) variation (max norm): 3.499e-03  ...
  [GroupSparseCovarianceCV.fit] * iteration 10 (10 %) variation (max norm): 1.870e-03  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 11: 9.688e-04
  -- Computing graph-lasso precision matrices ...
  [GraphLassoCV] Done refinement  1 out of 4:   0s
  [GraphLassoCV] Done refinement  2 out of 4:   0s
  [GraphLassoCV] Done refinement  3 out of 4:   0s
  [GraphLassoCV] Done refinement  4 out of 4:   1s
  [graph_lasso] Iteration   0, cost  1.75e+02, dual gap 1.936e+00
  [graph_lasso] Iteration   1, cost  1.75e+02, dual gap -1.311e-02
  [graph_lasso] Iteration   2, cost  1.75e+02, dual gap -1.601e-03
  [graph_lasso] Iteration   3, cost  1.75e+02, dual gap -2.242e-04
  [graph_lasso] Iteration   4, cost  1.75e+02, dual gap -1.691e-05
  -- Displaying results



**Python source code:** :download:`plot_adhd_covariance.py <plot_adhd_covariance.py>`

.. literalinclude:: plot_adhd_covariance.py
    :lines: 8-

**Total running time of the example:**  87.48 seconds 
( 1 minutes  27.48 seconds)
    