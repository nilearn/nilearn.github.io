
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/06_manipulating_images/plot_smooth_mean_image.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_06_manipulating_images_plot_smooth_mean_image.py>`
        to download the full example code or to run this example in your browser via Binder.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_06_manipulating_images_plot_smooth_mean_image.py:


Smoothing an image
==================

Here we smooth a mean :term:`EPI` image and plot the result

As we vary the smoothing :term:`FWHM`,
note how we decrease the amount of noise, but also lose spatial details.
In general, the best amount of smoothing for a given analysis
depends on the spatial extent of the effects that are expected.

We then show how to smooth a SurfaceImage.

.. GENERATED FROM PYTHON SOURCE LINES 17-33

.. code-block:: Python

    from nilearn.datasets import fetch_development_fmri
    from nilearn.image import mean_img, smooth_img
    from nilearn.plotting import plot_epi, show

    data = fetch_development_fmri(n_subjects=1)

    # Print basic information on the dataset
    print(
        f"First subject functional nifti image (4D) are located at: {data.func[0]}"
    )

    first_epi_file = data.func[0]

    # First compute the mean image, from the 4D series of image
    mean_func = mean_img(first_epi_file)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [fetch_development_fmri] Dataset found in 
    /home/runner/nilearn_data/development_fmri
    [fetch_development_fmri] Dataset found in 
    /home/runner/nilearn_data/development_fmri/development_fmri
    [fetch_development_fmri] Dataset found in 
    /home/runner/nilearn_data/development_fmri/development_fmri
    First subject functional nifti image (4D) are located at: /home/runner/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz




.. GENERATED FROM PYTHON SOURCE LINES 34-36

Then we smooth, with a varying amount of smoothing, from none to 20mm
by increments of 5mm

.. GENERATED FROM PYTHON SOURCE LINES 36-50

.. code-block:: Python

    for fwhm in [None, 5, 10, 15, 20, 25]:
        smoothed_img = smooth_img(mean_func, fwhm)
        title = "No smoothing" if fwhm is None else f"Smoothing {fwhm} mm"
        plot_epi(
            smoothed_img,
            title=title,
            colorbar=True,
            cmap="gray",
            vmin=0,
        )

    show()





.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_001.png
         :alt: plot smooth mean image
         :srcset: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_002.png
         :alt: plot smooth mean image
         :srcset: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_002.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_003.png
         :alt: plot smooth mean image
         :srcset: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_003.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_004.png
         :alt: plot smooth mean image
         :srcset: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_004.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_005.png
         :alt: plot smooth mean image
         :srcset: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_005.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_006.png
         :alt: plot smooth mean image
         :srcset: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_006.png
         :class: sphx-glr-multi-img





.. GENERATED FROM PYTHON SOURCE LINES 51-83

.. code-block:: Python

    from nilearn.datasets import (
        load_fsaverage,
        load_fsaverage_data,
        load_sample_motor_activation_image,
    )
    from nilearn.plotting import plot_surf_stat_map
    from nilearn.surface import SurfaceImage

    fsaverage_meshes = load_fsaverage()

    stat_img = load_sample_motor_activation_image()

    curvature = load_fsaverage_data(data_type="curvature")

    surface_image = SurfaceImage.from_volume(
        mesh=fsaverage_meshes["pial"],
        volume_img=stat_img,
    )

    for fwhm in [None, 5, 10, 15, 20, 25]:
        smoothed_img = smooth_img(surface_image, fwhm)
        title = "No smoothing" if fwhm is None else f"Smoothing {fwhm} mm"
        plot_surf_stat_map(
            surf_mesh=fsaverage_meshes["inflated"],
            stat_map=smoothed_img,
            title=title,
            threshold=1.0,
            vmax=8,
            bg_map=curvature,
        )

    show()



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_007.png
         :alt: No smoothing
         :srcset: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_007.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_008.png
         :alt: Smoothing 5 mm
         :srcset: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_008.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_009.png
         :alt: Smoothing 10 mm
         :srcset: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_009.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_010.png
         :alt: Smoothing 15 mm
         :srcset: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_010.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_011.png
         :alt: Smoothing 20 mm
         :srcset: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_011.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_012.png
         :alt: Smoothing 25 mm
         :srcset: /auto_examples/06_manipulating_images/images/sphx_glr_plot_smooth_mean_image_012.png
         :class: sphx-glr-multi-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 13.458 seconds)

**Estimated memory usage:**  296 MB


.. _sphx_glr_download_auto_examples_06_manipulating_images_plot_smooth_mean_image.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/nilearn/nilearn/main?urlpath=lab/tree/notebooks/auto_examples/06_manipulating_images/plot_smooth_mean_image.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_smooth_mean_image.ipynb <plot_smooth_mean_image.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_smooth_mean_image.py <plot_smooth_mean_image.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_smooth_mean_image.zip <plot_smooth_mean_image.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
