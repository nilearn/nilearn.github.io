
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/00_tutorials/plot_single_subject_single_run.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_00_tutorials_plot_single_subject_single_run.py>`
        to download the full example code or to run this example in your browser via Binder.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_00_tutorials_plot_single_subject_single_run.py:


Intro to GLM Analysis: a single-run, single-subject fMRI dataset
================================================================

In this tutorial, we use a General Linear Model (:term:`GLM`) to compare the
:term:`fMRI` signal during periods of auditory stimulation
versus periods of rest.

.. warning::

    The analysis described here is performed in the native space,
    directly on the original :term:`EPI` scans
    without any spatial or temporal preprocessing.
    More sensitive results would likely be obtained on the corrected,
    spatially normalized and smoothed images.

.. GENERATED FROM PYTHON SOURCE LINES 18-26

Retrieving the data
-------------------

.. note:: In this tutorial, we load the data using a data downloading
          function. To input your own data, you will need to provide
          a list of paths to your own files in the ``subject_data`` variable.
          These should abide to the Brain Imaging Data Structure
          (:term:`BIDS`) organization.

.. GENERATED FROM PYTHON SOURCE LINES 26-31

.. code-block:: Python


    from nilearn.datasets import fetch_spm_auditory

    subject_data = fetch_spm_auditory()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [fetch_spm_auditory] Dataset created in /home/runner/nilearn_data/spm_auditory
    [fetch_spm_auditory] Data absent, downloading...
    [fetch_spm_auditory] Downloading data from 
    https://www.fil.ion.ucl.ac.uk/spm/download/data/MoAEpilot/MoAEpilot.bids.zip ...
    [fetch_spm_auditory] Downloaded 1400832 of 30176409 bytes (4.6%%,   21.8s 
    remaining)
    [fetch_spm_auditory] Downloaded 6479872 of 30176409 bytes (21.5%%,    7.6s 
    remaining)
    [fetch_spm_auditory] Downloaded 10092544 of 30176409 bytes (33.4%%,    6.2s 
    remaining)
    [fetch_spm_auditory] Downloaded 13950976 of 30176409 bytes (46.2%%,    4.8s 
    remaining)
    [fetch_spm_auditory] Downloaded 17956864 of 30176409 bytes (59.5%%,    3.5s 
    remaining)
    [fetch_spm_auditory] Downloaded 21618688 of 30176409 bytes (71.6%%,    2.4s 
    remaining)
    [fetch_spm_auditory] Downloaded 25624576 of 30176409 bytes (84.9%%,    1.3s 
    remaining)
    [fetch_spm_auditory] Downloaded 29736960 of 30176409 bytes (98.5%%,    0.1s 
    remaining)
    [fetch_spm_auditory]  ...done. (9 seconds, 0 min)

    [fetch_spm_auditory] Extracting data from 
    /home/runner/nilearn_data/spm_auditory/MoAEpilot.bids.zip...
    [fetch_spm_auditory] .. done.





.. GENERATED FROM PYTHON SOURCE LINES 32-34

Inspecting the dataset
----------------------

.. GENERATED FROM PYTHON SOURCE LINES 36-37

print paths of func image

.. GENERATED FROM PYTHON SOURCE LINES 37-39

.. code-block:: Python

    subject_data.func[0]





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    '/home/runner/nilearn_data/spm_auditory/MoAEpilot/sub-01/func/sub-01_task-auditory_bold.nii'



.. GENERATED FROM PYTHON SOURCE LINES 40-41

We can display the mean functional image and the subject's anatomy:

.. GENERATED FROM PYTHON SOURCE LINES 41-53

.. code-block:: Python

    from nilearn.image import mean_img
    from nilearn.plotting import plot_anat, plot_img, plot_stat_map, show

    fmri_img = subject_data.func
    mean_img = mean_img(subject_data.func[0])
    plot_img(mean_img, cbar_tick_format="%i")

    plot_anat(subject_data.anat, cbar_tick_format="%i")

    show()





.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_001.png
         :alt: plot single subject single run
         :srcset: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_002.png
         :alt: plot single subject single run
         :srcset: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_002.png
         :class: sphx-glr-multi-img





.. GENERATED FROM PYTHON SOURCE LINES 54-61

Specifying the experimental paradigm
------------------------------------

We must now provide a description of the experiment, that is,
define the timing of the auditory stimulation and rest periods.
This is typically provided in an events.tsv file.
The path of this file is provided in the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 61-67

.. code-block:: Python

    import pandas as pd

    events = pd.read_table(subject_data.events)
    events







.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>onset</th>
          <th>duration</th>
          <th>trial_type</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>42</td>
          <td>42</td>
          <td>listening</td>
        </tr>
        <tr>
          <th>1</th>
          <td>126</td>
          <td>42</td>
          <td>listening</td>
        </tr>
        <tr>
          <th>2</th>
          <td>210</td>
          <td>42</td>
          <td>listening</td>
        </tr>
        <tr>
          <th>3</th>
          <td>294</td>
          <td>42</td>
          <td>listening</td>
        </tr>
        <tr>
          <th>4</th>
          <td>378</td>
          <td>42</td>
          <td>listening</td>
        </tr>
        <tr>
          <th>5</th>
          <td>462</td>
          <td>42</td>
          <td>listening</td>
        </tr>
        <tr>
          <th>6</th>
          <td>546</td>
          <td>42</td>
          <td>listening</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 68-74

Performing the :term:`GLM` analysis
-----------------------------------

It is now time to create and estimate a ``FirstLevelModel`` object,
that will generate the *design matrix*
using the information provided by the ``events`` object.

.. GENERATED FROM PYTHON SOURCE LINES 74-77

.. code-block:: Python


    from nilearn.glm.first_level import FirstLevelModel








.. GENERATED FROM PYTHON SOURCE LINES 78-92

Parameters of the first-level model

* ``t_r=7(s)`` is the time of repetition of acquisitions
* ``noise_model='ar1'`` specifies the noise covariance model:
  a lag-1 dependence
* ``standardize=False`` means that we do not want
  to rescale the time series to mean 0, variance 1
* ``hrf_model='spm'`` means that we rely
  on the :term:`SPM` "canonical hrf" model
  (without time or dispersion derivatives)
* ``drift_model='cosine'`` means that we model the signal drifts
  as slow oscillating time functions
* ``high_pass=0.01`` (Hz) defines the cutoff frequency
  (inverse of the time period).

.. GENERATED FROM PYTHON SOURCE LINES 92-102

.. code-block:: Python

    fmri_glm = FirstLevelModel(
        t_r=subject_data.t_r,
        noise_model="ar1",
        standardize=False,
        hrf_model="spm",
        drift_model="cosine",
        high_pass=0.01,
        verbose=1,
    )








.. GENERATED FROM PYTHON SOURCE LINES 103-105

.. include:: ../../../examples/html_repr_note.rst


.. GENERATED FROM PYTHON SOURCE LINES 106-108

.. code-block:: Python

    fmri_glm






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <style>#sk-container-id-4 {
      /* Definition of color scheme common for light and dark mode */
      --sklearn-color-text: #000;
      --sklearn-color-text-muted: #666;
      --sklearn-color-line: gray;
      /* Definition of color scheme for unfitted estimators */
      --sklearn-color-unfitted-level-0: #fff5e6;
      --sklearn-color-unfitted-level-1: #f6e4d2;
      --sklearn-color-unfitted-level-2: #ffe0b3;
      --sklearn-color-unfitted-level-3: chocolate;
      /* Definition of color scheme for fitted estimators */
      --sklearn-color-fitted-level-0: #f0f8ff;
      --sklearn-color-fitted-level-1: #d4ebff;
      --sklearn-color-fitted-level-2: #b3dbfd;
      --sklearn-color-fitted-level-3: cornflowerblue;

      /* Specific color for light theme */
      --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
      --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
      --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
      --sklearn-color-icon: #696969;

      @media (prefers-color-scheme: dark) {
        /* Redefinition of color scheme for dark theme */
        --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
        --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
        --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
        --sklearn-color-icon: #878787;
      }
    }

    #sk-container-id-4 {
      color: var(--sklearn-color-text);
    }

    #sk-container-id-4 pre {
      padding: 0;
    }

    #sk-container-id-4 input.sk-hidden--visually {
      border: 0;
      clip: rect(1px 1px 1px 1px);
      clip: rect(1px, 1px, 1px, 1px);
      height: 1px;
      margin: -1px;
      overflow: hidden;
      padding: 0;
      position: absolute;
      width: 1px;
    }

    #sk-container-id-4 div.sk-dashed-wrapped {
      border: 1px dashed var(--sklearn-color-line);
      margin: 0 0.4em 0.5em 0.4em;
      box-sizing: border-box;
      padding-bottom: 0.4em;
      background-color: var(--sklearn-color-background);
    }

    #sk-container-id-4 div.sk-container {
      /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
         but bootstrap.min.css set `[hidden] { display: none !important; }`
         so we also need the `!important` here to be able to override the
         default hidden behavior on the sphinx rendered scikit-learn.org.
         See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
      display: inline-block !important;
      position: relative;
    }

    #sk-container-id-4 div.sk-text-repr-fallback {
      display: none;
    }

    div.sk-parallel-item,
    div.sk-serial,
    div.sk-item {
      /* draw centered vertical line to link estimators */
      background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
      background-size: 2px 100%;
      background-repeat: no-repeat;
      background-position: center center;
    }

    /* Parallel-specific style estimator block */

    #sk-container-id-4 div.sk-parallel-item::after {
      content: "";
      width: 100%;
      border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
      flex-grow: 1;
    }

    #sk-container-id-4 div.sk-parallel {
      display: flex;
      align-items: stretch;
      justify-content: center;
      background-color: var(--sklearn-color-background);
      position: relative;
    }

    #sk-container-id-4 div.sk-parallel-item {
      display: flex;
      flex-direction: column;
    }

    #sk-container-id-4 div.sk-parallel-item:first-child::after {
      align-self: flex-end;
      width: 50%;
    }

    #sk-container-id-4 div.sk-parallel-item:last-child::after {
      align-self: flex-start;
      width: 50%;
    }

    #sk-container-id-4 div.sk-parallel-item:only-child::after {
      width: 0;
    }

    /* Serial-specific style estimator block */

    #sk-container-id-4 div.sk-serial {
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: var(--sklearn-color-background);
      padding-right: 1em;
      padding-left: 1em;
    }


    /* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
    clickable and can be expanded/collapsed.
    - Pipeline and ColumnTransformer use this feature and define the default style
    - Estimators will overwrite some part of the style using the `sk-estimator` class
    */

    /* Pipeline and ColumnTransformer style (default) */

    #sk-container-id-4 div.sk-toggleable {
      /* Default theme specific background. It is overwritten whether we have a
      specific estimator or a Pipeline/ColumnTransformer */
      background-color: var(--sklearn-color-background);
    }

    /* Toggleable label */
    #sk-container-id-4 label.sk-toggleable__label {
      cursor: pointer;
      display: flex;
      width: 100%;
      margin-bottom: 0;
      padding: 0.5em;
      box-sizing: border-box;
      text-align: center;
      align-items: start;
      justify-content: space-between;
      gap: 0.5em;
    }

    #sk-container-id-4 label.sk-toggleable__label .caption {
      font-size: 0.6rem;
      font-weight: lighter;
      color: var(--sklearn-color-text-muted);
    }

    #sk-container-id-4 label.sk-toggleable__label-arrow:before {
      /* Arrow on the left of the label */
      content: "▸";
      float: left;
      margin-right: 0.25em;
      color: var(--sklearn-color-icon);
    }

    #sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {
      color: var(--sklearn-color-text);
    }

    /* Toggleable content - dropdown */

    #sk-container-id-4 div.sk-toggleable__content {
      display: none;
      text-align: left;
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-0);
    }

    #sk-container-id-4 div.sk-toggleable__content.fitted {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-0);
    }

    #sk-container-id-4 div.sk-toggleable__content pre {
      margin: 0.2em;
      border-radius: 0.25em;
      color: var(--sklearn-color-text);
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-0);
    }

    #sk-container-id-4 div.sk-toggleable__content.fitted pre {
      /* unfitted */
      background-color: var(--sklearn-color-fitted-level-0);
    }

    #sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {
      /* Expand drop-down */
      display: block;
      width: 100%;
      overflow: visible;
    }

    #sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
      content: "▾";
    }

    /* Pipeline/ColumnTransformer-specific style */

    #sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
      color: var(--sklearn-color-text);
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    #sk-container-id-4 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
      background-color: var(--sklearn-color-fitted-level-2);
    }

    /* Estimator-specific style */

    /* Colorize estimator box */
    #sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    #sk-container-id-4 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-2);
    }

    #sk-container-id-4 div.sk-label label.sk-toggleable__label,
    #sk-container-id-4 div.sk-label label {
      /* The background is the default theme color */
      color: var(--sklearn-color-text-on-default-background);
    }

    /* On hover, darken the color of the background */
    #sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {
      color: var(--sklearn-color-text);
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    /* Label box, darken color on hover, fitted */
    #sk-container-id-4 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
      color: var(--sklearn-color-text);
      background-color: var(--sklearn-color-fitted-level-2);
    }

    /* Estimator label */

    #sk-container-id-4 div.sk-label label {
      font-family: monospace;
      font-weight: bold;
      display: inline-block;
      line-height: 1.2em;
    }

    #sk-container-id-4 div.sk-label-container {
      text-align: center;
    }

    /* Estimator-specific */
    #sk-container-id-4 div.sk-estimator {
      font-family: monospace;
      border: 1px dotted var(--sklearn-color-border-box);
      border-radius: 0.25em;
      box-sizing: border-box;
      margin-bottom: 0.5em;
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-0);
    }

    #sk-container-id-4 div.sk-estimator.fitted {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-0);
    }

    /* on hover */
    #sk-container-id-4 div.sk-estimator:hover {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    #sk-container-id-4 div.sk-estimator.fitted:hover {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-2);
    }

    /* Specification for estimator info (e.g. "i" and "?") */

    /* Common style for "i" and "?" */

    .sk-estimator-doc-link,
    a:link.sk-estimator-doc-link,
    a:visited.sk-estimator-doc-link {
      float: right;
      font-size: smaller;
      line-height: 1em;
      font-family: monospace;
      background-color: var(--sklearn-color-background);
      border-radius: 1em;
      height: 1em;
      width: 1em;
      text-decoration: none !important;
      margin-left: 0.5em;
      text-align: center;
      /* unfitted */
      border: var(--sklearn-color-unfitted-level-1) 1pt solid;
      color: var(--sklearn-color-unfitted-level-1);
    }

    .sk-estimator-doc-link.fitted,
    a:link.sk-estimator-doc-link.fitted,
    a:visited.sk-estimator-doc-link.fitted {
      /* fitted */
      border: var(--sklearn-color-fitted-level-1) 1pt solid;
      color: var(--sklearn-color-fitted-level-1);
    }

    /* On hover */
    div.sk-estimator:hover .sk-estimator-doc-link:hover,
    .sk-estimator-doc-link:hover,
    div.sk-label-container:hover .sk-estimator-doc-link:hover,
    .sk-estimator-doc-link:hover {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-3);
      color: var(--sklearn-color-background);
      text-decoration: none;
    }

    div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
    .sk-estimator-doc-link.fitted:hover,
    div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
    .sk-estimator-doc-link.fitted:hover {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-3);
      color: var(--sklearn-color-background);
      text-decoration: none;
    }

    /* Span, style for the box shown on hovering the info icon */
    .sk-estimator-doc-link span {
      display: none;
      z-index: 9999;
      position: relative;
      font-weight: normal;
      right: .2ex;
      padding: .5ex;
      margin: .5ex;
      width: min-content;
      min-width: 20ex;
      max-width: 50ex;
      color: var(--sklearn-color-text);
      box-shadow: 2pt 2pt 4pt #999;
      /* unfitted */
      background: var(--sklearn-color-unfitted-level-0);
      border: .5pt solid var(--sklearn-color-unfitted-level-3);
    }

    .sk-estimator-doc-link.fitted span {
      /* fitted */
      background: var(--sklearn-color-fitted-level-0);
      border: var(--sklearn-color-fitted-level-3);
    }

    .sk-estimator-doc-link:hover span {
      display: block;
    }

    /* "?"-specific style due to the `<a>` HTML tag */

    #sk-container-id-4 a.estimator_doc_link {
      float: right;
      font-size: 1rem;
      line-height: 1em;
      font-family: monospace;
      background-color: var(--sklearn-color-background);
      border-radius: 1rem;
      height: 1rem;
      width: 1rem;
      text-decoration: none;
      /* unfitted */
      color: var(--sklearn-color-unfitted-level-1);
      border: var(--sklearn-color-unfitted-level-1) 1pt solid;
    }

    #sk-container-id-4 a.estimator_doc_link.fitted {
      /* fitted */
      border: var(--sklearn-color-fitted-level-1) 1pt solid;
      color: var(--sklearn-color-fitted-level-1);
    }

    /* On hover */
    #sk-container-id-4 a.estimator_doc_link:hover {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-3);
      color: var(--sklearn-color-background);
      text-decoration: none;
    }

    #sk-container-id-4 a.estimator_doc_link.fitted:hover {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-3);
    }

    .estimator-table summary {
        padding: .5rem;
        font-family: monospace;
        cursor: pointer;
    }

    .estimator-table details[open] {
        padding-left: 0.1rem;
        padding-right: 0.1rem;
        padding-bottom: 0.3rem;
    }

    .estimator-table .parameters-table {
        margin-left: auto !important;
        margin-right: auto !important;
    }

    .estimator-table .parameters-table tr:nth-child(odd) {
        background-color: #fff;
    }

    .estimator-table .parameters-table tr:nth-child(even) {
        background-color: #f6f6f6;
    }

    .estimator-table .parameters-table tr:hover {
        background-color: #e0e0e0;
    }

    .estimator-table table td {
        border: 1px solid rgba(106, 105, 104, 0.232);
    }

    .user-set td {
        color:rgb(255, 94, 0);
        text-align: left;
    }

    .user-set td.value pre {
        color:rgb(255, 94, 0) !important;
        background-color: transparent !important;
    }

    .default td {
        color: black;
        text-align: left;
    }

    .user-set td i,
    .default td i {
        color: black;
    }

    .copy-paste-icon {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NDggNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNy4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjUgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTIwOCAwTDMzMi4xIDBjMTIuNyAwIDI0LjkgNS4xIDMzLjkgMTQuMWw2Ny45IDY3LjljOSA5IDE0LjEgMjEuMiAxNC4xIDMzLjlMNDQ4IDMzNmMwIDI2LjUtMjEuNSA0OC00OCA0OGwtMTkyIDBjLTI2LjUgMC00OC0yMS41LTQ4LTQ4bDAtMjg4YzAtMjYuNSAyMS41LTQ4IDQ4LTQ4ek00OCAxMjhsODAgMCAwIDY0LTY0IDAgMCAyNTYgMTkyIDAgMC0zMiA2NCAwIDAgNDhjMCAyNi41LTIxLjUgNDgtNDggNDhMNDggNTEyYy0yNi41IDAtNDgtMjEuNS00OC00OEwwIDE3NmMwLTI2LjUgMjEuNS00OCA0OC00OHoiLz48L3N2Zz4=);
        background-repeat: no-repeat;
        background-size: 14px 14px;
        background-position: 0;
        display: inline-block;
        width: 14px;
        height: 14px;
        cursor: pointer;
    }
    </style><body><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>First Level Model</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" checked><label for="sk-estimator-id-4" class="sk-toggleable__label  sk-toggleable__label-arrow"><div><div>FirstLevelModel</div></div><div><a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://nilearn.github.io/dev/modules/generated/nilearn.glm.first_level.FirstLevelModel.html">?<span>Documentation for FirstLevelModel</span></a><span class="sk-estimator-doc-link ">i<span>Not fitted</span></span></div></label><div class="sk-toggleable__content " data-param-prefix="">
            <div class="estimator-table">
                <details>
                    <summary>Parameters</summary>
                    <table class="parameters-table">
                      <tbody>
                    
            <tr class="user-set">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('t_r',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">t_r&nbsp;</td>
                <td class="value">7.0</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('slice_time_ref',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">slice_time_ref&nbsp;</td>
                <td class="value">0.0</td>
            </tr>
    

            <tr class="user-set">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('hrf_model',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">hrf_model&nbsp;</td>
                <td class="value">&#x27;spm&#x27;</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('drift_model',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">drift_model&nbsp;</td>
                <td class="value">&#x27;cosine&#x27;</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('high_pass',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">high_pass&nbsp;</td>
                <td class="value">0.01</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('drift_order',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">drift_order&nbsp;</td>
                <td class="value">1</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('fir_delays',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">fir_delays&nbsp;</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('min_onset',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">min_onset&nbsp;</td>
                <td class="value">-24</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('mask_img',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">mask_img&nbsp;</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('target_affine',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">target_affine&nbsp;</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('target_shape',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">target_shape&nbsp;</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('smoothing_fwhm',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">smoothing_fwhm&nbsp;</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('memory',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">memory&nbsp;</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('memory_level',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">memory_level&nbsp;</td>
                <td class="value">1</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('standardize',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">standardize&nbsp;</td>
                <td class="value">False</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('signal_scaling',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">signal_scaling&nbsp;</td>
                <td class="value">0</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('noise_model',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">noise_model&nbsp;</td>
                <td class="value">&#x27;ar1&#x27;</td>
            </tr>
    

            <tr class="user-set">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('verbose',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">verbose&nbsp;</td>
                <td class="value">1</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('n_jobs',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">n_jobs&nbsp;</td>
                <td class="value">1</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('minimize_memory',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">minimize_memory&nbsp;</td>
                <td class="value">True</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('subject_label',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">subject_label&nbsp;</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('random_state',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">random_state&nbsp;</td>
                <td class="value">None</td>
            </tr>
    
                      </tbody>
                    </table>
                </details>
            </div>
        </div></div></div></div></div><script>function copyToClipboard(text, element) {
        // Get the parameter prefix from the closest toggleable content
        const toggleableContent = element.closest('.sk-toggleable__content');
        const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
        const fullParamName = paramPrefix ? `${paramPrefix}${text}` : text;

        const originalStyle = element.style;
        const computedStyle = window.getComputedStyle(element);
        const originalWidth = computedStyle.width;
        const originalHTML = element.innerHTML.replace('Copied!', '');

        navigator.clipboard.writeText(fullParamName)
            .then(() => {
                element.style.width = originalWidth;
                element.style.color = 'green';
                element.innerHTML = "Copied!";

                setTimeout(() => {
                    element.innerHTML = originalHTML;
                    element.style = originalStyle;
                }, 2000);
            })
            .catch(err => {
                console.error('Failed to copy:', err);
                element.style.color = 'red';
                element.innerHTML = "Failed!";
                setTimeout(() => {
                    element.innerHTML = originalHTML;
                    element.style = originalStyle;
                }, 2000);
            });
        return false;
    }

    document.querySelectorAll('.fa-regular.fa-copy').forEach(function(element) {
        const toggleableContent = element.closest('.sk-toggleable__content');
        const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
        const paramName = element.parentElement.nextElementSibling.textContent.trim();
        const fullParamName = paramPrefix ? `${paramPrefix}${paramName}` : paramName;

        element.setAttribute('title', fullParamName);
    });
    </script></body>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 109-117

Now that we have specified the model, we can run it on the :term:`fMRI` image

.. note ::

  After fitting,
  the HTML representation of the estimator looks different
  than before before fitting.


.. GENERATED FROM PYTHON SOURCE LINES 117-120

.. code-block:: Python

    fmri_glm = fmri_glm.fit(fmri_img, events)
    fmri_glm





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [FirstLevelModel.fit] Loading data from 
    '/home/runner/nilearn_data/spm_auditory/MoAEpilot/sub-01/func/sub-01_task-audito
    ry_bold.nii'
    [FirstLevelModel.fit] Computing mask
    [FirstLevelModel.fit] Resampling mask
    [FirstLevelModel.fit] Finished fit
    [FirstLevelModel.fit] Computing run 1 out of 1 runs (go take a coffee, a big 
    one).
    [FirstLevelModel.fit] Performing mask computation.
    [FirstLevelModel.fit] Loading data from <nibabel.nifti1.Nifti1Image object at 
    0x7f92c2d24640>
    [FirstLevelModel.fit] Extracting region signals
    [FirstLevelModel.fit] Cleaning extracted signals
    [FirstLevelModel.fit] Masking took 0 seconds.
    [FirstLevelModel.fit] Performing GLM computation.
    [FirstLevelModel.fit] GLM took 0 seconds.
    [FirstLevelModel.fit] Computation of 1 runs done in 1 seconds.


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <style>#sk-container-id-5 {
      /* Definition of color scheme common for light and dark mode */
      --sklearn-color-text: #000;
      --sklearn-color-text-muted: #666;
      --sklearn-color-line: gray;
      /* Definition of color scheme for unfitted estimators */
      --sklearn-color-unfitted-level-0: #fff5e6;
      --sklearn-color-unfitted-level-1: #f6e4d2;
      --sklearn-color-unfitted-level-2: #ffe0b3;
      --sklearn-color-unfitted-level-3: chocolate;
      /* Definition of color scheme for fitted estimators */
      --sklearn-color-fitted-level-0: #f0f8ff;
      --sklearn-color-fitted-level-1: #d4ebff;
      --sklearn-color-fitted-level-2: #b3dbfd;
      --sklearn-color-fitted-level-3: cornflowerblue;

      /* Specific color for light theme */
      --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
      --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
      --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
      --sklearn-color-icon: #696969;

      @media (prefers-color-scheme: dark) {
        /* Redefinition of color scheme for dark theme */
        --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
        --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
        --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
        --sklearn-color-icon: #878787;
      }
    }

    #sk-container-id-5 {
      color: var(--sklearn-color-text);
    }

    #sk-container-id-5 pre {
      padding: 0;
    }

    #sk-container-id-5 input.sk-hidden--visually {
      border: 0;
      clip: rect(1px 1px 1px 1px);
      clip: rect(1px, 1px, 1px, 1px);
      height: 1px;
      margin: -1px;
      overflow: hidden;
      padding: 0;
      position: absolute;
      width: 1px;
    }

    #sk-container-id-5 div.sk-dashed-wrapped {
      border: 1px dashed var(--sklearn-color-line);
      margin: 0 0.4em 0.5em 0.4em;
      box-sizing: border-box;
      padding-bottom: 0.4em;
      background-color: var(--sklearn-color-background);
    }

    #sk-container-id-5 div.sk-container {
      /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
         but bootstrap.min.css set `[hidden] { display: none !important; }`
         so we also need the `!important` here to be able to override the
         default hidden behavior on the sphinx rendered scikit-learn.org.
         See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
      display: inline-block !important;
      position: relative;
    }

    #sk-container-id-5 div.sk-text-repr-fallback {
      display: none;
    }

    div.sk-parallel-item,
    div.sk-serial,
    div.sk-item {
      /* draw centered vertical line to link estimators */
      background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
      background-size: 2px 100%;
      background-repeat: no-repeat;
      background-position: center center;
    }

    /* Parallel-specific style estimator block */

    #sk-container-id-5 div.sk-parallel-item::after {
      content: "";
      width: 100%;
      border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
      flex-grow: 1;
    }

    #sk-container-id-5 div.sk-parallel {
      display: flex;
      align-items: stretch;
      justify-content: center;
      background-color: var(--sklearn-color-background);
      position: relative;
    }

    #sk-container-id-5 div.sk-parallel-item {
      display: flex;
      flex-direction: column;
    }

    #sk-container-id-5 div.sk-parallel-item:first-child::after {
      align-self: flex-end;
      width: 50%;
    }

    #sk-container-id-5 div.sk-parallel-item:last-child::after {
      align-self: flex-start;
      width: 50%;
    }

    #sk-container-id-5 div.sk-parallel-item:only-child::after {
      width: 0;
    }

    /* Serial-specific style estimator block */

    #sk-container-id-5 div.sk-serial {
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: var(--sklearn-color-background);
      padding-right: 1em;
      padding-left: 1em;
    }


    /* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
    clickable and can be expanded/collapsed.
    - Pipeline and ColumnTransformer use this feature and define the default style
    - Estimators will overwrite some part of the style using the `sk-estimator` class
    */

    /* Pipeline and ColumnTransformer style (default) */

    #sk-container-id-5 div.sk-toggleable {
      /* Default theme specific background. It is overwritten whether we have a
      specific estimator or a Pipeline/ColumnTransformer */
      background-color: var(--sklearn-color-background);
    }

    /* Toggleable label */
    #sk-container-id-5 label.sk-toggleable__label {
      cursor: pointer;
      display: flex;
      width: 100%;
      margin-bottom: 0;
      padding: 0.5em;
      box-sizing: border-box;
      text-align: center;
      align-items: start;
      justify-content: space-between;
      gap: 0.5em;
    }

    #sk-container-id-5 label.sk-toggleable__label .caption {
      font-size: 0.6rem;
      font-weight: lighter;
      color: var(--sklearn-color-text-muted);
    }

    #sk-container-id-5 label.sk-toggleable__label-arrow:before {
      /* Arrow on the left of the label */
      content: "▸";
      float: left;
      margin-right: 0.25em;
      color: var(--sklearn-color-icon);
    }

    #sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {
      color: var(--sklearn-color-text);
    }

    /* Toggleable content - dropdown */

    #sk-container-id-5 div.sk-toggleable__content {
      display: none;
      text-align: left;
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-0);
    }

    #sk-container-id-5 div.sk-toggleable__content.fitted {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-0);
    }

    #sk-container-id-5 div.sk-toggleable__content pre {
      margin: 0.2em;
      border-radius: 0.25em;
      color: var(--sklearn-color-text);
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-0);
    }

    #sk-container-id-5 div.sk-toggleable__content.fitted pre {
      /* unfitted */
      background-color: var(--sklearn-color-fitted-level-0);
    }

    #sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {
      /* Expand drop-down */
      display: block;
      width: 100%;
      overflow: visible;
    }

    #sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
      content: "▾";
    }

    /* Pipeline/ColumnTransformer-specific style */

    #sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
      color: var(--sklearn-color-text);
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    #sk-container-id-5 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
      background-color: var(--sklearn-color-fitted-level-2);
    }

    /* Estimator-specific style */

    /* Colorize estimator box */
    #sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    #sk-container-id-5 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-2);
    }

    #sk-container-id-5 div.sk-label label.sk-toggleable__label,
    #sk-container-id-5 div.sk-label label {
      /* The background is the default theme color */
      color: var(--sklearn-color-text-on-default-background);
    }

    /* On hover, darken the color of the background */
    #sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {
      color: var(--sklearn-color-text);
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    /* Label box, darken color on hover, fitted */
    #sk-container-id-5 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
      color: var(--sklearn-color-text);
      background-color: var(--sklearn-color-fitted-level-2);
    }

    /* Estimator label */

    #sk-container-id-5 div.sk-label label {
      font-family: monospace;
      font-weight: bold;
      display: inline-block;
      line-height: 1.2em;
    }

    #sk-container-id-5 div.sk-label-container {
      text-align: center;
    }

    /* Estimator-specific */
    #sk-container-id-5 div.sk-estimator {
      font-family: monospace;
      border: 1px dotted var(--sklearn-color-border-box);
      border-radius: 0.25em;
      box-sizing: border-box;
      margin-bottom: 0.5em;
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-0);
    }

    #sk-container-id-5 div.sk-estimator.fitted {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-0);
    }

    /* on hover */
    #sk-container-id-5 div.sk-estimator:hover {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    #sk-container-id-5 div.sk-estimator.fitted:hover {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-2);
    }

    /* Specification for estimator info (e.g. "i" and "?") */

    /* Common style for "i" and "?" */

    .sk-estimator-doc-link,
    a:link.sk-estimator-doc-link,
    a:visited.sk-estimator-doc-link {
      float: right;
      font-size: smaller;
      line-height: 1em;
      font-family: monospace;
      background-color: var(--sklearn-color-background);
      border-radius: 1em;
      height: 1em;
      width: 1em;
      text-decoration: none !important;
      margin-left: 0.5em;
      text-align: center;
      /* unfitted */
      border: var(--sklearn-color-unfitted-level-1) 1pt solid;
      color: var(--sklearn-color-unfitted-level-1);
    }

    .sk-estimator-doc-link.fitted,
    a:link.sk-estimator-doc-link.fitted,
    a:visited.sk-estimator-doc-link.fitted {
      /* fitted */
      border: var(--sklearn-color-fitted-level-1) 1pt solid;
      color: var(--sklearn-color-fitted-level-1);
    }

    /* On hover */
    div.sk-estimator:hover .sk-estimator-doc-link:hover,
    .sk-estimator-doc-link:hover,
    div.sk-label-container:hover .sk-estimator-doc-link:hover,
    .sk-estimator-doc-link:hover {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-3);
      color: var(--sklearn-color-background);
      text-decoration: none;
    }

    div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
    .sk-estimator-doc-link.fitted:hover,
    div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
    .sk-estimator-doc-link.fitted:hover {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-3);
      color: var(--sklearn-color-background);
      text-decoration: none;
    }

    /* Span, style for the box shown on hovering the info icon */
    .sk-estimator-doc-link span {
      display: none;
      z-index: 9999;
      position: relative;
      font-weight: normal;
      right: .2ex;
      padding: .5ex;
      margin: .5ex;
      width: min-content;
      min-width: 20ex;
      max-width: 50ex;
      color: var(--sklearn-color-text);
      box-shadow: 2pt 2pt 4pt #999;
      /* unfitted */
      background: var(--sklearn-color-unfitted-level-0);
      border: .5pt solid var(--sklearn-color-unfitted-level-3);
    }

    .sk-estimator-doc-link.fitted span {
      /* fitted */
      background: var(--sklearn-color-fitted-level-0);
      border: var(--sklearn-color-fitted-level-3);
    }

    .sk-estimator-doc-link:hover span {
      display: block;
    }

    /* "?"-specific style due to the `<a>` HTML tag */

    #sk-container-id-5 a.estimator_doc_link {
      float: right;
      font-size: 1rem;
      line-height: 1em;
      font-family: monospace;
      background-color: var(--sklearn-color-background);
      border-radius: 1rem;
      height: 1rem;
      width: 1rem;
      text-decoration: none;
      /* unfitted */
      color: var(--sklearn-color-unfitted-level-1);
      border: var(--sklearn-color-unfitted-level-1) 1pt solid;
    }

    #sk-container-id-5 a.estimator_doc_link.fitted {
      /* fitted */
      border: var(--sklearn-color-fitted-level-1) 1pt solid;
      color: var(--sklearn-color-fitted-level-1);
    }

    /* On hover */
    #sk-container-id-5 a.estimator_doc_link:hover {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-3);
      color: var(--sklearn-color-background);
      text-decoration: none;
    }

    #sk-container-id-5 a.estimator_doc_link.fitted:hover {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-3);
    }

    .estimator-table summary {
        padding: .5rem;
        font-family: monospace;
        cursor: pointer;
    }

    .estimator-table details[open] {
        padding-left: 0.1rem;
        padding-right: 0.1rem;
        padding-bottom: 0.3rem;
    }

    .estimator-table .parameters-table {
        margin-left: auto !important;
        margin-right: auto !important;
    }

    .estimator-table .parameters-table tr:nth-child(odd) {
        background-color: #fff;
    }

    .estimator-table .parameters-table tr:nth-child(even) {
        background-color: #f6f6f6;
    }

    .estimator-table .parameters-table tr:hover {
        background-color: #e0e0e0;
    }

    .estimator-table table td {
        border: 1px solid rgba(106, 105, 104, 0.232);
    }

    .user-set td {
        color:rgb(255, 94, 0);
        text-align: left;
    }

    .user-set td.value pre {
        color:rgb(255, 94, 0) !important;
        background-color: transparent !important;
    }

    .default td {
        color: black;
        text-align: left;
    }

    .user-set td i,
    .default td i {
        color: black;
    }

    .copy-paste-icon {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NDggNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNy4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjUgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTIwOCAwTDMzMi4xIDBjMTIuNyAwIDI0LjkgNS4xIDMzLjkgMTQuMWw2Ny45IDY3LjljOSA5IDE0LjEgMjEuMiAxNC4xIDMzLjlMNDQ4IDMzNmMwIDI2LjUtMjEuNSA0OC00OCA0OGwtMTkyIDBjLTI2LjUgMC00OC0yMS41LTQ4LTQ4bDAtMjg4YzAtMjYuNSAyMS41LTQ4IDQ4LTQ4ek00OCAxMjhsODAgMCAwIDY0LTY0IDAgMCAyNTYgMTkyIDAgMC0zMiA2NCAwIDAgNDhjMCAyNi41LTIxLjUgNDgtNDggNDhMNDggNTEyYy0yNi41IDAtNDgtMjEuNS00OC00OEwwIDE3NmMwLTI2LjUgMjEuNS00OCA0OC00OHoiLz48L3N2Zz4=);
        background-repeat: no-repeat;
        background-size: 14px 14px;
        background-position: 0;
        display: inline-block;
        width: 14px;
        height: 14px;
        cursor: pointer;
    }
    </style><body><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>First Level Model</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" checked><label for="sk-estimator-id-5" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>FirstLevelModel</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://nilearn.github.io/dev/modules/generated/nilearn.glm.first_level.FirstLevelModel.html">?<span>Documentation for FirstLevelModel</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted" data-param-prefix="">
            <div class="estimator-table">
                <details>
                    <summary>Parameters</summary>
                    <table class="parameters-table">
                      <tbody>
                    
            <tr class="user-set">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('t_r',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">t_r&nbsp;</td>
                <td class="value">7.0</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('slice_time_ref',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">slice_time_ref&nbsp;</td>
                <td class="value">0.0</td>
            </tr>
    

            <tr class="user-set">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('hrf_model',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">hrf_model&nbsp;</td>
                <td class="value">&#x27;spm&#x27;</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('drift_model',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">drift_model&nbsp;</td>
                <td class="value">&#x27;cosine&#x27;</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('high_pass',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">high_pass&nbsp;</td>
                <td class="value">0.01</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('drift_order',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">drift_order&nbsp;</td>
                <td class="value">1</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('fir_delays',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">fir_delays&nbsp;</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('min_onset',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">min_onset&nbsp;</td>
                <td class="value">-24</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('mask_img',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">mask_img&nbsp;</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('target_affine',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">target_affine&nbsp;</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('target_shape',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">target_shape&nbsp;</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('smoothing_fwhm',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">smoothing_fwhm&nbsp;</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('memory',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">memory&nbsp;</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('memory_level',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">memory_level&nbsp;</td>
                <td class="value">1</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('standardize',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">standardize&nbsp;</td>
                <td class="value">False</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('signal_scaling',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">signal_scaling&nbsp;</td>
                <td class="value">0</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('noise_model',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">noise_model&nbsp;</td>
                <td class="value">&#x27;ar1&#x27;</td>
            </tr>
    

            <tr class="user-set">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('verbose',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">verbose&nbsp;</td>
                <td class="value">1</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('n_jobs',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">n_jobs&nbsp;</td>
                <td class="value">1</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('minimize_memory',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">minimize_memory&nbsp;</td>
                <td class="value">True</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('subject_label',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">subject_label&nbsp;</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('random_state',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">random_state&nbsp;</td>
                <td class="value">None</td>
            </tr>
    
                      </tbody>
                    </table>
                </details>
            </div>
        </div></div></div></div></div><script>function copyToClipboard(text, element) {
        // Get the parameter prefix from the closest toggleable content
        const toggleableContent = element.closest('.sk-toggleable__content');
        const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
        const fullParamName = paramPrefix ? `${paramPrefix}${text}` : text;

        const originalStyle = element.style;
        const computedStyle = window.getComputedStyle(element);
        const originalWidth = computedStyle.width;
        const originalHTML = element.innerHTML.replace('Copied!', '');

        navigator.clipboard.writeText(fullParamName)
            .then(() => {
                element.style.width = originalWidth;
                element.style.color = 'green';
                element.innerHTML = "Copied!";

                setTimeout(() => {
                    element.innerHTML = originalHTML;
                    element.style = originalStyle;
                }, 2000);
            })
            .catch(err => {
                console.error('Failed to copy:', err);
                element.style.color = 'red';
                element.innerHTML = "Failed!";
                setTimeout(() => {
                    element.innerHTML = originalHTML;
                    element.style = originalStyle;
                }, 2000);
            });
        return false;
    }

    document.querySelectorAll('.fa-regular.fa-copy').forEach(function(element) {
        const toggleableContent = element.closest('.sk-toggleable__content');
        const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
        const paramName = element.parentElement.nextElementSibling.textContent.trim();
        const fullParamName = paramPrefix ? `${paramPrefix}${paramName}` : paramName;

        element.setAttribute('title', fullParamName);
    });
    </script></body>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 121-123

One can inspect the design matrix (rows represent time, and
columns contain the predictors).

.. GENERATED FROM PYTHON SOURCE LINES 123-125

.. code-block:: Python

    design_matrix = fmri_glm.design_matrices_[0]








.. GENERATED FROM PYTHON SOURCE LINES 126-128

Formally, we have taken the first design matrix, because the model is
implictily meant to for multiple runs.

.. GENERATED FROM PYTHON SOURCE LINES 128-134

.. code-block:: Python

    from nilearn.plotting import plot_design_matrix

    plot_design_matrix(design_matrix)

    show()




.. image-sg:: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_003.png
   :alt: plot single subject single run
   :srcset: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 135-137

Save the design matrix image to disk
first create a directory where you want to write the images

.. GENERATED FROM PYTHON SOURCE LINES 137-145

.. code-block:: Python

    from pathlib import Path

    output_dir = Path.cwd() / "results" / "plot_single_subject_single_run"
    output_dir.mkdir(exist_ok=True, parents=True)
    print(f"Output will be saved to: {output_dir}")

    plot_design_matrix(design_matrix, output_file=output_dir / "design_matrix.png")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Output will be saved to: /home/runner/work/nilearn/nilearn/examples/00_tutorials/results/plot_single_subject_single_run




.. GENERATED FROM PYTHON SOURCE LINES 146-149

The first column contains the expected response profile of regions which are
sensitive to the auditory stimulation.
Let's plot this first column

.. GENERATED FROM PYTHON SOURCE LINES 149-158

.. code-block:: Python

    import matplotlib.pyplot as plt

    plt.plot(design_matrix["listening"])
    plt.xlabel("scan")
    plt.title("Expected Auditory Response")

    show()





.. image-sg:: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_004.png
   :alt: Expected Auditory Response
   :srcset: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_004.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 159-176

Detecting voxels with significant effects
-----------------------------------------

To access the estimated coefficients (Betas of the :term:`GLM` model),
we created :term:`contrast` with a single '1' in each of the columns:
The role of the :term:`contrast` is to select some columns of the model
--and potentially weight them-- to study the associated statistics.
So in a nutshell, a :term:`contrast`
is a weighted combination of the estimated effects.
Here we can define canonical contrasts that just consider
the effect of the stimulation in isolation.

.. note::

      Here the baseline is implicit, so passing a value of 1
      for the first column will give contrast for: ``listening > rest``


.. GENERATED FROM PYTHON SOURCE LINES 176-183

.. code-block:: Python


    import numpy as np

    n_regressors = design_matrix.shape[1]
    activation = np.zeros(n_regressors)
    activation[0] = 1








.. GENERATED FROM PYTHON SOURCE LINES 184-186

Let's look at it: plot the coefficients of the :term:`contrast`,
indexed by the names of the columns of the design matrix.

.. GENERATED FROM PYTHON SOURCE LINES 186-191

.. code-block:: Python


    from nilearn.plotting import plot_contrast_matrix

    plot_contrast_matrix(contrast_def=activation, design_matrix=design_matrix)




.. image-sg:: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_005.png
   :alt: plot single subject single run
   :srcset: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_005.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <Axes: label='conditions'>



.. GENERATED FROM PYTHON SOURCE LINES 192-195

Below, we compute the :term:`'estimated effect'<Parameter Estimate>`.
It is in :term:`BOLD` signal unit, but has no statistical guarantees,
because it does not take into account the associated variance.

.. GENERATED FROM PYTHON SOURCE LINES 195-198

.. code-block:: Python


    eff_map = fmri_glm.compute_contrast(activation, output_type="effect_size")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [FirstLevelModel.compute_contrast] Computing image from signals




.. GENERATED FROM PYTHON SOURCE LINES 199-203

In order to get statistical significance, we form a t-statistic, and
directly convert it into z-scale. The z-scale means that the values
are scaled to match a standard Gaussian distribution (mean=0,
variance=1), across voxels, if there were no effects in the data.

.. GENERATED FROM PYTHON SOURCE LINES 203-207

.. code-block:: Python


    z_map = fmri_glm.compute_contrast(activation, output_type="z_score")






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [FirstLevelModel.compute_contrast] Computing image from signals




.. GENERATED FROM PYTHON SOURCE LINES 208-216

Plot thresholded z scores map
-----------------------------

We display it on top of the average functional image of the series
(could be the anatomical image of the subject).
We use arbitrarily a threshold of 3.0 in z-scale.
We'll see later how to use corrected thresholds.
We will show 3 axial views, with display_mode='z' and cut_coords=3.

.. GENERATED FROM PYTHON SOURCE LINES 216-231

.. code-block:: Python

    plotting_config = {
        "bg_img": mean_img,
        "display_mode": "z",
        "cut_coords": 3,
        "black_bg": True,
    }
    plot_stat_map(
        z_map,
        threshold=3,
        title="listening > rest (|Z|>3)",
        figure=plt.figure(figsize=(10, 4)),
        **plotting_config,
    )
    show()




.. image-sg:: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_006.png
   :alt: plot single subject single run
   :srcset: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_006.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 232-239

.. note::

  Notice how the visualizations above shows both 'activated' voxels
  with Z > 3,
  as well as 'deactivated' voxels with Z < -3.
  In the rest of this example we will show only the activate voxels
  by using one-sided tests.

.. GENERATED FROM PYTHON SOURCE LINES 241-252

Statistical significance testing
--------------------------------

One should worry about the statistical validity of the procedure:
here we used an arbitrary
threshold of 3.0 but the threshold should provide some guarantees on
the risk of false detections (aka type-1 errors in statistics).
One suggestion is to control the false positive rate
(:term:`fpr<FPR correction>`, denoted by alpha)
at a certain level, e.g. 0.001: this means that there is 0.1% chance
of declaring an inactive :term:`voxel`, active.

.. GENERATED FROM PYTHON SOURCE LINES 252-274

.. code-block:: Python


    from nilearn.glm import threshold_stats_img

    clean_map, threshold = threshold_stats_img(
        z_map,
        alpha=0.001,
        height_control="fpr",
        two_sided=False,  # using a one-sided test
    )
    # Let's use a sequential colormap as we will only display positive values.
    plotting_config["cmap"] = "inferno"
    plot_stat_map(
        clean_map,
        threshold=threshold,
        title=(
            f"listening > rest (Uncorrected p<0.001; threshold: {threshold:.3f})"
        ),
        figure=plt.figure(figsize=(10, 4)),
        **plotting_config,
    )
    show()




.. image-sg:: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_007.png
   :alt: plot single subject single run
   :srcset: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_007.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 275-280

The problem is that with this you expect 0.001 * n_voxels to show up
while they're not active --- tens to hundreds of voxels. A more
conservative solution is to control the family wise error rate,
i.e. the probability of making only one false detection, say at
5%. For that we use the so-called Bonferroni correction.

.. GENERATED FROM PYTHON SOURCE LINES 280-296

.. code-block:: Python


    clean_map, threshold = threshold_stats_img(
        z_map, alpha=0.05, height_control="bonferroni", two_sided=False
    )
    plot_stat_map(
        clean_map,
        threshold=threshold,
        title=(
            "listening > rest (p<0.05 Bonferroni-corrected, "
            f"threshold: {threshold:.3f})"
        ),
        figure=plt.figure(figsize=(10, 4)),
        **plotting_config,
    )
    show()




.. image-sg:: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_008.png
   :alt: plot single subject single run
   :srcset: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_008.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 297-301

This is quite conservative indeed!  A popular alternative is to
control the expected proportion of
false discoveries among detections. This is called the False
discovery rate.

.. GENERATED FROM PYTHON SOURCE LINES 301-316

.. code-block:: Python


    clean_map, threshold = threshold_stats_img(
        z_map, alpha=0.05, height_control="fdr", two_sided=False
    )
    plot_stat_map(
        clean_map,
        threshold=threshold,
        title=(
            f"listening > rest (p<0.05 FDR-corrected; threshold: {threshold:.3f})"
        ),
        figure=plt.figure(figsize=(10, 4)),
        **plotting_config,
    )
    show()




.. image-sg:: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_009.png
   :alt: plot single subject single run
   :srcset: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_009.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 317-322

Finally people like to discard isolated voxels (aka "small
clusters") from these images. It is possible to generate a
thresholded map with small clusters removed by providing a
cluster_threshold argument. Here clusters smaller than 10 voxels
will be discarded.

.. GENERATED FROM PYTHON SOURCE LINES 322-344

.. code-block:: Python


    clean_map, threshold = threshold_stats_img(
        z_map,
        alpha=0.05,
        height_control="fdr",
        cluster_threshold=10,
        two_sided=False,
    )
    plot_stat_map(
        clean_map,
        threshold=threshold,
        title=(
            "listening > rest "
            f"(p<0.05 FDR-corrected; threshold: {threshold:.3f}; "
            "clusters > 10 voxels)"
        ),
        figure=plt.figure(figsize=(10, 4)),
        **plotting_config,
    )
    show()





.. image-sg:: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_010.png
   :alt: plot single subject single run
   :srcset: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_010.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 345-346

We can save the effect and zscore maps to the disk.

.. GENERATED FROM PYTHON SOURCE LINES 346-349

.. code-block:: Python

    z_map.to_filename(output_dir / "listening_gt_rest_z_map.nii.gz")
    eff_map.to_filename(output_dir / "listening_gt_rest_eff_map.nii.gz")








.. GENERATED FROM PYTHON SOURCE LINES 350-361

We can furthermore extract and report the found positions in a table.

.. seealso::

    This function does not report any named anatomical location
    for the clusters.
    To get the names of the location of the clusters
    according to one or several atlases,
    we recommend using
    the `atlasreader package <https://github.com/miykael/atlasreader>`_.


.. GENERATED FROM PYTHON SOURCE LINES 361-368

.. code-block:: Python

    from nilearn.reporting import get_clusters_table

    table = get_clusters_table(
        z_map, stat_threshold=threshold, cluster_threshold=20
    )
    table






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>Cluster ID</th>
          <th>X</th>
          <th>Y</th>
          <th>Z</th>
          <th>Peak Stat</th>
          <th>Cluster Size (mm3)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>1</td>
          <td>-60.0</td>
          <td>-6.0</td>
          <td>42.0</td>
          <td>9.341729</td>
          <td>3888</td>
        </tr>
        <tr>
          <th>1</th>
          <td>1a</td>
          <td>-51.0</td>
          <td>-12.0</td>
          <td>39.0</td>
          <td>7.952826</td>
          <td></td>
        </tr>
        <tr>
          <th>2</th>
          <td>1b</td>
          <td>-63.0</td>
          <td>0.0</td>
          <td>42.0</td>
          <td>7.595170</td>
          <td></td>
        </tr>
        <tr>
          <th>3</th>
          <td>1c</td>
          <td>-42.0</td>
          <td>-12.0</td>
          <td>39.0</td>
          <td>7.034967</td>
          <td></td>
        </tr>
        <tr>
          <th>4</th>
          <td>2</td>
          <td>60.0</td>
          <td>0.0</td>
          <td>36.0</td>
          <td>8.738699</td>
          <td>1620</td>
        </tr>
        <tr>
          <th>5</th>
          <td>2a</td>
          <td>45.0</td>
          <td>-12.0</td>
          <td>42.0</td>
          <td>6.850138</td>
          <td></td>
        </tr>
        <tr>
          <th>6</th>
          <td>2b</td>
          <td>69.0</td>
          <td>6.0</td>
          <td>30.0</td>
          <td>4.062676</td>
          <td></td>
        </tr>
        <tr>
          <th>7</th>
          <td>3</td>
          <td>66.0</td>
          <td>15.0</td>
          <td>27.0</td>
          <td>7.947193</td>
          <td>837</td>
        </tr>
        <tr>
          <th>8</th>
          <td>3a</td>
          <td>51.0</td>
          <td>3.0</td>
          <td>30.0</td>
          <td>6.676518</td>
          <td></td>
        </tr>
        <tr>
          <th>9</th>
          <td>4</td>
          <td>36.0</td>
          <td>-3.0</td>
          <td>15.0</td>
          <td>7.945328</td>
          <td>1161</td>
        </tr>
        <tr>
          <th>10</th>
          <td>4a</td>
          <td>39.0</td>
          <td>-12.0</td>
          <td>12.0</td>
          <td>5.511866</td>
          <td></td>
        </tr>
        <tr>
          <th>11</th>
          <td>5</td>
          <td>51.0</td>
          <td>30.0</td>
          <td>27.0</td>
          <td>6.825038</td>
          <td>675</td>
        </tr>
        <tr>
          <th>12</th>
          <td>5a</td>
          <td>48.0</td>
          <td>21.0</td>
          <td>27.0</td>
          <td>6.763636</td>
          <td></td>
        </tr>
        <tr>
          <th>13</th>
          <td>5b</td>
          <td>57.0</td>
          <td>39.0</td>
          <td>27.0</td>
          <td>5.631803</td>
          <td></td>
        </tr>
        <tr>
          <th>14</th>
          <td>6</td>
          <td>45.0</td>
          <td>-18.0</td>
          <td>57.0</td>
          <td>5.901255</td>
          <td>972</td>
        </tr>
        <tr>
          <th>15</th>
          <td>6a</td>
          <td>39.0</td>
          <td>-15.0</td>
          <td>63.0</td>
          <td>5.213951</td>
          <td></td>
        </tr>
        <tr>
          <th>16</th>
          <td>6b</td>
          <td>45.0</td>
          <td>-21.0</td>
          <td>63.0</td>
          <td>4.108046</td>
          <td></td>
        </tr>
        <tr>
          <th>17</th>
          <td>6c</td>
          <td>36.0</td>
          <td>-9.0</td>
          <td>66.0</td>
          <td>4.090935</td>
          <td></td>
        </tr>
        <tr>
          <th>18</th>
          <td>7</td>
          <td>-15.0</td>
          <td>-60.0</td>
          <td>66.0</td>
          <td>5.005065</td>
          <td>864</td>
        </tr>
        <tr>
          <th>19</th>
          <td>7a</td>
          <td>-15.0</td>
          <td>-60.0</td>
          <td>57.0</td>
          <td>4.546246</td>
          <td></td>
        </tr>
        <tr>
          <th>20</th>
          <td>7b</td>
          <td>-3.0</td>
          <td>-60.0</td>
          <td>57.0</td>
          <td>4.463430</td>
          <td></td>
        </tr>
        <tr>
          <th>21</th>
          <td>8</td>
          <td>-12.0</td>
          <td>-69.0</td>
          <td>51.0</td>
          <td>4.269133</td>
          <td>540</td>
        </tr>
        <tr>
          <th>22</th>
          <td>8a</td>
          <td>-18.0</td>
          <td>-63.0</td>
          <td>48.0</td>
          <td>4.081260</td>
          <td></td>
        </tr>
        <tr>
          <th>23</th>
          <td>8b</td>
          <td>-6.0</td>
          <td>-69.0</td>
          <td>51.0</td>
          <td>3.530991</td>
          <td></td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 369-370

This table can be saved for future use.

.. GENERATED FROM PYTHON SOURCE LINES 370-373

.. code-block:: Python


    table.to_csv(output_dir / "table.csv")








.. GENERATED FROM PYTHON SOURCE LINES 374-390

Performing an F-test
--------------------

"listening > rest" is a typical t test: condition versus baseline.
Another popular type of test is an F test in which
one seeks whether a certain combination of conditions
(possibly two-, three- or higher-dimensional)
explains a significant proportion of the signal.
Here one might for instance test which voxels are well
explained by the combination of more active or less active than rest.

.. note::

   As opposed to t-tests, the beta images produced by of F-tests
   only contain positive values.


.. GENERATED FROM PYTHON SOURCE LINES 392-395

Specify the :term:`contrast` and compute the corresponding map.
Actually, the :term:`contrast` specification is done exactly the same way
as for t-contrasts.

.. GENERATED FROM PYTHON SOURCE LINES 395-402

.. code-block:: Python


    z_map = fmri_glm.compute_contrast(
        activation,
        output_type="z_score",
        stat_type="F",  # set stat_type to 'F' to perform an F test
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [FirstLevelModel.compute_contrast] Computing image from signals




.. GENERATED FROM PYTHON SOURCE LINES 403-405

Note that the statistic has been converted to a z-variable,
which makes it easier to represent it.

.. GENERATED FROM PYTHON SOURCE LINES 405-421

.. code-block:: Python


    clean_map, threshold = threshold_stats_img(
        z_map,
        alpha=0.05,
        height_control="fdr",
        cluster_threshold=10,
        two_sided=False,
    )
    plot_stat_map(
        clean_map,
        threshold=threshold,
        title="Effects of interest (fdr=0.05), clusters > 10 voxels",
        figure=plt.figure(figsize=(10, 4)),
        **plotting_config,
    )
    show()



.. image-sg:: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_011.png
   :alt: plot single subject single run
   :srcset: /auto_examples/00_tutorials/images/sphx_glr_plot_single_subject_single_run_011.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 27.341 seconds)

**Estimated memory usage:**  455 MB


.. _sphx_glr_download_auto_examples_00_tutorials_plot_single_subject_single_run.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/nilearn/nilearn/main?urlpath=lab/tree/notebooks/auto_examples/00_tutorials/plot_single_subject_single_run.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_single_subject_single_run.ipynb <plot_single_subject_single_run.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_single_subject_single_run.py <plot_single_subject_single_run.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_single_subject_single_run.zip <plot_single_subject_single_run.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
