
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/01_plotting/plot_overlay.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_01_plotting_plot_overlay.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_01_plotting_plot_overlay.py:


Visualizing a probabilistic atlas: the default mode in the MSDL atlas
=====================================================================

Visualizing a :term:`probabilistic atlas` requires visualizing the different
maps that compose it.

Here we represent the nodes constituting the default mode network in the
`MSDL atlas
<https://team.inria.fr/parietal/research/spatial_patterns/spatial-patterns-in-resting-state/>`_.

The tools that we need to leverage are:

* :func:`~nilearn.image.index_img` to retrieve the various maps composing
  the atlas

* Adding overlays on an existing brain display, to plot each of these maps

Alternatively, :func:`~nilearn.plotting.plot_prob_atlas` allows
to plot the maps in one step that
with less control over the plot (see below)

.. GENERATED FROM PYTHON SOURCE LINES 26-28

Fetching :term:`Probabilistic atlas` - MSDL atlas
-------------------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 28-33

.. code-block:: Python

    from nilearn import datasets

    atlas_data = datasets.fetch_atlas_msdl()
    atlas_filename = atlas_data.maps





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [fetch_atlas_msdl] Dataset created in /home/runner/nilearn_data/msdl_atlas
    [fetch_atlas_msdl] Downloading data from 
    https://team.inria.fr/parietal/files/2015/01/MSDL_rois.zip ...
    [fetch_atlas_msdl]  ...done. (1 seconds, 0 min)

    [fetch_atlas_msdl] Extracting data from 
    /home/runner/nilearn_data/msdl_atlas/dedd5c670ed1fd457a722109d3c7f958/MSDL_rois.
    zip...
    [fetch_atlas_msdl] .. done.





.. GENERATED FROM PYTHON SOURCE LINES 34-36

Visualizing a probabilistic atlas with plot_stat_map and add_overlay object
---------------------------------------------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 36-59

.. code-block:: Python

    from nilearn import image, plotting

    # First plot the map for the PCC: index 4 in the atlas
    display = plotting.plot_stat_map(
        image.index_img(atlas_filename, 4),
        colorbar=False,
        title="DMN nodes in MSDL atlas",
        cmap="inferno",
    )

    # Now add as an overlay the maps for the ACC and the left and right
    # parietal nodes
    cmaps = [
        plotting.cm.black_blue,
        plotting.cm.black_green,
        plotting.cm.black_pink,
    ]
    for index, cmap in zip([5, 6, 3], cmaps, strict=False):
        display.add_overlay(image.index_img(atlas_filename, index), cmap=cmap)

    plotting.show()





.. image-sg:: /auto_examples/01_plotting/images/sphx_glr_plot_overlay_001.png
   :alt: plot overlay
   :srcset: /auto_examples/01_plotting/images/sphx_glr_plot_overlay_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/runner/work/nilearn/nilearn/.tox/doc/lib/python3.10/site-packages/numpy/ma/core.py:2892: UserWarning: Warning: converting a masked element to nan.
      _data = np.array(data, dtype=dtype, copy=copy,




.. GENERATED FROM PYTHON SOURCE LINES 60-70

Visualizing a :term:`probabilistic atlas` with ``plot_prob_atlas``
------------------------------------------------------------------

Alternatively, we can create a new 4D-image by selecting
the 3rd, 4th, 5th and 6th (zero-based) probabilistic map from atlas
via :func:`~nilearn.image.index_img`
and use :func:`~nilearn.plotting.plot_prob_atlas` (added in version 0.2)
to plot the selected nodes in one step.

Unlike :func:`~nilearn.plotting.plot_stat_map` this works with 4D images

.. GENERATED FROM PYTHON SOURCE LINES 70-75

.. code-block:: Python


    dmn_nodes = image.index_img(atlas_filename, [3, 4, 5, 6])
    # Note that dmn_node is now a 4D image
    print(dmn_nodes.shape)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    (40, 48, 35, 4)




.. GENERATED FROM PYTHON SOURCE LINES 76-81

.. code-block:: Python

    display = plotting.plot_prob_atlas(
        dmn_nodes, cut_coords=(0, -55, 29), title="DMN nodes in MSDL atlas"
    )
    plotting.show()




.. image-sg:: /auto_examples/01_plotting/images/sphx_glr_plot_overlay_002.png
   :alt: plot overlay
   :srcset: /auto_examples/01_plotting/images/sphx_glr_plot_overlay_002.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 7.375 seconds)

**Estimated memory usage:**  102 MB


.. _sphx_glr_download_auto_examples_01_plotting_plot_overlay.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/nilearn/nilearn/main?urlpath=lab/tree/notebooks/auto_examples/01_plotting/plot_overlay.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_overlay.ipynb <plot_overlay.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_overlay.py <plot_overlay.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_overlay.zip <plot_overlay.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
