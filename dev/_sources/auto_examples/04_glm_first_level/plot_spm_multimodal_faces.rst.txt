
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/04_glm_first_level/plot_spm_multimodal_faces.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_04_glm_first_level_plot_spm_multimodal_faces.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_04_glm_first_level_plot_spm_multimodal_faces.py:


Single-subject data (two runs) in native space
==============================================

The example shows the analysis of an :term:`SPM` dataset,
with two conditions: viewing a face image or a scrambled face image.

This example takes a lot of time because the input are lists of 3D images
sampled in different positions (encoded by different affine functions).

.. seealso::

    For more information
    see the :ref:`dataset description <spm_multimodal_dataset>`.

.. GENERATED FROM PYTHON SOURCE LINES 18-21

Fetch and inspect the data
--------------------------
Fetch the :term:`SPM` multimodal_faces data.

.. GENERATED FROM PYTHON SOURCE LINES 21-25

.. code-block:: Python

    from nilearn.datasets import fetch_spm_multimodal_fmri

    subject_data = fetch_spm_multimodal_fmri()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [fetch_spm_multimodal_fmri] Dataset created in 
    /home/runner/nilearn_data/spm_multimodal_fmri
    [fetch_spm_multimodal_fmri] Missing 390 functional scans for session 1.
    [fetch_spm_multimodal_fmri] Data absent, downloading...
    [fetch_spm_multimodal_fmri] Downloading data from 
    https://www.fil.ion.ucl.ac.uk/spm/download/data/mmfaces/multimodal_fmri.zip ...
    [fetch_spm_multimodal_fmri] Downloaded 2260992 of 134263085 bytes (1.7%%,   
    59.7s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 5177344 of 134263085 bytes (3.9%%,   
    51.0s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 5865472 of 134263085 bytes (4.4%%,  
    1.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 6479872 of 134263085 bytes (4.8%%,  
    1.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 6971392 of 134263085 bytes (5.2%%,  
    1.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 7421952 of 134263085 bytes (5.5%%,  
    1.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 7774208 of 134263085 bytes (5.8%%,  
    2.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 8134656 of 134263085 bytes (6.1%%,  
    2.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 8536064 of 134263085 bytes (6.4%%,  
    2.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 8986624 of 134263085 bytes (6.7%%,  
    2.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 9494528 of 134263085 bytes (7.1%%,  
    2.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 10051584 of 134263085 bytes (7.5%%,  
    2.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 10698752 of 134263085 bytes (8.0%%,  
    2.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 11337728 of 134263085 bytes (8.4%%,  
    2.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 11862016 of 134263085 bytes (8.8%%,  
    2.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 12410880 of 134263085 bytes (9.2%%,  
    2.7min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 12861440 of 134263085 bytes (9.6%%,  
    2.7min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 13336576 of 134263085 bytes (9.9%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 13770752 of 134263085 bytes (10.3%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 14245888 of 134263085 bytes (10.6%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 14745600 of 134263085 bytes (11.0%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 15179776 of 134263085 bytes (11.3%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 15679488 of 134263085 bytes (11.7%%,  
    3.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 16130048 of 134263085 bytes (12.0%%,  
    3.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 16605184 of 134263085 bytes (12.4%%,  
    3.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 17080320 of 134263085 bytes (12.7%%,  
    3.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 17539072 of 134263085 bytes (13.1%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 18071552 of 134263085 bytes (13.5%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 18604032 of 134263085 bytes (13.9%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 19144704 of 134263085 bytes (14.3%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 19742720 of 134263085 bytes (14.7%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 20185088 of 134263085 bytes (15.0%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 20578304 of 134263085 bytes (15.3%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 20996096 of 134263085 bytes (15.6%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 21471232 of 134263085 bytes (16.0%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 21979136 of 134263085 bytes (16.4%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 22544384 of 134263085 bytes (16.8%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 23060480 of 134263085 bytes (17.2%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 23511040 of 134263085 bytes (17.5%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 23961600 of 134263085 bytes (17.8%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 24453120 of 134263085 bytes (18.2%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 24952832 of 134263085 bytes (18.6%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 25419776 of 134263085 bytes (18.9%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 25944064 of 134263085 bytes (19.3%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 26492928 of 134263085 bytes (19.7%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 27025408 of 134263085 bytes (20.1%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 27582464 of 134263085 bytes (20.5%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 28090368 of 134263085 bytes (20.9%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 28581888 of 134263085 bytes (21.3%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 29048832 of 134263085 bytes (21.6%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 29556736 of 134263085 bytes (22.0%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 30105600 of 134263085 bytes (22.4%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 30720000 of 134263085 bytes (22.9%%,  
    3.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 31375360 of 134263085 bytes (23.4%%,  
    3.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 32096256 of 134263085 bytes (23.9%%,  
    3.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 32735232 of 134263085 bytes (24.4%%,  
    3.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 33243136 of 134263085 bytes (24.8%%,  
    3.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 33783808 of 134263085 bytes (25.2%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 34299904 of 134263085 bytes (25.5%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 34791424 of 134263085 bytes (25.9%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 35356672 of 134263085 bytes (26.3%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 35930112 of 134263085 bytes (26.8%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 36519936 of 134263085 bytes (27.2%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 37109760 of 134263085 bytes (27.6%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 37634048 of 134263085 bytes (28.0%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 38223872 of 134263085 bytes (28.5%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 38666240 of 134263085 bytes (28.8%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 38985728 of 134263085 bytes (29.0%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 39313408 of 134263085 bytes (29.3%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 39682048 of 134263085 bytes (29.6%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 40099840 of 134263085 bytes (29.9%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 40558592 of 134263085 bytes (30.2%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 40927232 of 134263085 bytes (30.5%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 41246720 of 134263085 bytes (30.7%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 41607168 of 134263085 bytes (31.0%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 41918464 of 134263085 bytes (31.2%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 42229760 of 134263085 bytes (31.5%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 42524672 of 134263085 bytes (31.7%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 42860544 of 134263085 bytes (31.9%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 43253760 of 134263085 bytes (32.2%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 43630592 of 134263085 bytes (32.5%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 44032000 of 134263085 bytes (32.8%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 44466176 of 134263085 bytes (33.1%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 44924928 of 134263085 bytes (33.5%%,  
    2.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 45408256 of 134263085 bytes (33.8%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 45850624 of 134263085 bytes (34.1%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 46333952 of 134263085 bytes (34.5%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 46858240 of 134263085 bytes (34.9%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 47398912 of 134263085 bytes (35.3%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 47955968 of 134263085 bytes (35.7%%,  
    2.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 48562176 of 134263085 bytes (36.2%%,  
    2.7min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 49225728 of 134263085 bytes (36.7%%,  
    2.7min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 49995776 of 134263085 bytes (37.2%%,  
    2.7min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 50790400 of 134263085 bytes (37.8%%,  
    2.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 51363840 of 134263085 bytes (38.3%%,  
    2.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 51896320 of 134263085 bytes (38.7%%,  
    2.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 52428800 of 134263085 bytes (39.0%%,  
    2.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 52813824 of 134263085 bytes (39.3%%,  
    2.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 53108736 of 134263085 bytes (39.6%%,  
    2.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 53436416 of 134263085 bytes (39.8%%,  
    2.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 53796864 of 134263085 bytes (40.1%%,  
    2.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 54190080 of 134263085 bytes (40.4%%,  
    2.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 54624256 of 134263085 bytes (40.7%%,  
    2.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 55115776 of 134263085 bytes (41.1%%,  
    2.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 55558144 of 134263085 bytes (41.4%%,  
    2.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 56016896 of 134263085 bytes (41.7%%,  
    2.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 56508416 of 134263085 bytes (42.1%%,  
    2.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 56958976 of 134263085 bytes (42.4%%,  
    2.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 57393152 of 134263085 bytes (42.7%%,  
    2.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 57819136 of 134263085 bytes (43.1%%,  
    2.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 58277888 of 134263085 bytes (43.4%%,  
    2.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 58777600 of 134263085 bytes (43.8%%,  
    2.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 59252736 of 134263085 bytes (44.1%%,  
    2.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 59760640 of 134263085 bytes (44.5%%,  
    2.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 60309504 of 134263085 bytes (44.9%%,  
    2.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 60866560 of 134263085 bytes (45.3%%,  
    2.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 61382656 of 134263085 bytes (45.7%%,  
    2.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 61898752 of 134263085 bytes (46.1%%,  
    2.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 62283776 of 134263085 bytes (46.4%%,  
    2.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 62611456 of 134263085 bytes (46.6%%,  
    2.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 62980096 of 134263085 bytes (46.9%%,  
    2.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 63389696 of 134263085 bytes (47.2%%,  
    2.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 63840256 of 134263085 bytes (47.5%%,  
    2.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 64356352 of 134263085 bytes (47.9%%,  
    2.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 64913408 of 134263085 bytes (48.3%%,  
    2.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 65347584 of 134263085 bytes (48.7%%,  
    2.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 65740800 of 134263085 bytes (49.0%%,  
    2.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 66117632 of 134263085 bytes (49.2%%,  
    2.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 66494464 of 134263085 bytes (49.5%%,  
    2.2min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 66904064 of 134263085 bytes (49.8%%,  
    2.2min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 67321856 of 134263085 bytes (50.1%%,  
    2.2min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 67805184 of 134263085 bytes (50.5%%,  
    2.2min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 68337664 of 134263085 bytes (50.9%%,  
    2.2min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 68919296 of 134263085 bytes (51.3%%,  
    2.2min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 69558272 of 134263085 bytes (51.8%%,  
    2.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 70156288 of 134263085 bytes (52.3%%,  
    2.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 70688768 of 134263085 bytes (52.6%%,  
    2.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 71090176 of 134263085 bytes (52.9%%,  
    2.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 71524352 of 134263085 bytes (53.3%%,  
    2.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 71999488 of 134263085 bytes (53.6%%,  
    2.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 72515584 of 134263085 bytes (54.0%%,  
    2.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 73039872 of 134263085 bytes (54.4%%,  
    2.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 73539584 of 134263085 bytes (54.8%%,  
    2.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 74104832 of 134263085 bytes (55.2%%,  
    2.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 74711040 of 134263085 bytes (55.6%%,  
    2.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 75309056 of 134263085 bytes (56.1%%,  
    2.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 75939840 of 134263085 bytes (56.6%%,  
    1.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 76627968 of 134263085 bytes (57.1%%,  
    1.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 77250560 of 134263085 bytes (57.5%%,  
    1.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 77807616 of 134263085 bytes (58.0%%,  
    1.9min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 78192640 of 134263085 bytes (58.2%%,  
    1.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 78618624 of 134263085 bytes (58.6%%,  
    1.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 79069184 of 134263085 bytes (58.9%%,  
    1.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 79560704 of 134263085 bytes (59.3%%,  
    1.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 80109568 of 134263085 bytes (59.7%%,  
    1.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 80707584 of 134263085 bytes (60.1%%,  
    1.8min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 81362944 of 134263085 bytes (60.6%%,  
    1.7min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 81969152 of 134263085 bytes (61.1%%,  
    1.7min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 82526208 of 134263085 bytes (61.5%%,  
    1.7min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 83091456 of 134263085 bytes (61.9%%,  
    1.7min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 83582976 of 134263085 bytes (62.3%%,  
    1.7min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 84074496 of 134263085 bytes (62.6%%,  
    1.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 84639744 of 134263085 bytes (63.0%%,  
    1.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 85139456 of 134263085 bytes (63.4%%,  
    1.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 85630976 of 134263085 bytes (63.8%%,  
    1.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 86040576 of 134263085 bytes (64.1%%,  
    1.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 86433792 of 134263085 bytes (64.4%%,  
    1.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 86753280 of 134263085 bytes (64.6%%,  
    1.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 87080960 of 134263085 bytes (64.9%%,  
    1.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 87441408 of 134263085 bytes (65.1%%,  
    1.6min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 87826432 of 134263085 bytes (65.4%%,  
    1.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 88260608 of 134263085 bytes (65.7%%,  
    1.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 88743936 of 134263085 bytes (66.1%%,  
    1.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 89161728 of 134263085 bytes (66.4%%,  
    1.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 89653248 of 134263085 bytes (66.8%%,  
    1.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 90103808 of 134263085 bytes (67.1%%,  
    1.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 90439680 of 134263085 bytes (67.4%%,  
    1.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 90750976 of 134263085 bytes (67.6%%,  
    1.5min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 91070464 of 134263085 bytes (67.8%%,  
    1.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 91422720 of 134263085 bytes (68.1%%,  
    1.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 91807744 of 134263085 bytes (68.4%%,  
    1.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 92225536 of 134263085 bytes (68.7%%,  
    1.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 92700672 of 134263085 bytes (69.0%%,  
    1.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 93216768 of 134263085 bytes (69.4%%,  
    1.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 93847552 of 134263085 bytes (69.9%%,  
    1.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 94707712 of 134263085 bytes (70.5%%,  
    1.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 95518720 of 134263085 bytes (71.1%%,  
    1.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 96174080 of 134263085 bytes (71.6%%,  
    1.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 96575488 of 134263085 bytes (71.9%%,  
    1.3min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 96993280 of 134263085 bytes (72.2%%,  
    1.2min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 97452032 of 134263085 bytes (72.6%%,  
    1.2min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 97935360 of 134263085 bytes (72.9%%,  
    1.2min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 98459648 of 134263085 bytes (73.3%%,  
    1.2min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 99016704 of 134263085 bytes (73.7%%,  
    1.2min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 99508224 of 134263085 bytes (74.1%%,  
    1.2min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 100065280 of 134263085 bytes (74.5%%,  
    1.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 100524032 of 134263085 bytes (74.9%%,  
    1.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 100990976 of 134263085 bytes (75.2%%,  
    1.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 101433344 of 134263085 bytes (75.5%%,  
    1.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 101916672 of 134263085 bytes (75.9%%,  
    1.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 102408192 of 134263085 bytes (76.3%%,  
    1.1min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 102916096 of 134263085 bytes (76.7%%,  
    1.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 103448576 of 134263085 bytes (77.0%%,  
    1.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 104046592 of 134263085 bytes (77.5%%,  
    1.0min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 104538112 of 134263085 bytes (77.9%%,   
    59.7s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 104833024 of 134263085 bytes (78.1%%,   
    59.2s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 105127936 of 134263085 bytes (78.3%%,   
    58.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 105472000 of 134263085 bytes (78.6%%,   
    58.2s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 105857024 of 134263085 bytes (78.8%%,   
    57.4s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 106283008 of 134263085 bytes (79.2%%,   
    56.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 106749952 of 134263085 bytes (79.5%%,   
    55.7s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 107266048 of 134263085 bytes (79.9%%,   
    54.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 107765760 of 134263085 bytes (80.3%%,   
    53.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 108347392 of 134263085 bytes (80.7%%,   
    52.4s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 108929024 of 134263085 bytes (81.1%%,   
    51.2s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 109502464 of 134263085 bytes (81.6%%,   
    50.0s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 109871104 of 134263085 bytes (81.8%%,   
    49.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 110264320 of 134263085 bytes (82.1%%,   
    48.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 110682112 of 134263085 bytes (82.4%%,   
    47.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 111173632 of 134263085 bytes (82.8%%,   
    46.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 111673344 of 134263085 bytes (83.2%%,   
    45.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 112263168 of 134263085 bytes (83.6%%,   
    44.5s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 112869376 of 134263085 bytes (84.1%%,   
    43.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 113524736 of 134263085 bytes (84.6%%,   
    41.9s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 114196480 of 134263085 bytes (85.1%%,   
    40.5s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 114843648 of 134263085 bytes (85.5%%,   
    39.1s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 115277824 of 134263085 bytes (85.9%%,   
    38.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 115752960 of 134263085 bytes (86.2%%,   
    37.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 116252672 of 134263085 bytes (86.6%%,   
    36.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 116801536 of 134263085 bytes (87.0%%,   
    35.2s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 117391360 of 134263085 bytes (87.4%%,   
    34.0s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 118030336 of 134263085 bytes (87.9%%,   
    32.7s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 118726656 of 134263085 bytes (88.4%%,   
    31.2s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 119652352 of 134263085 bytes (89.1%%,   
    29.2s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 120758272 of 134263085 bytes (89.9%%,   
    26.9s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 121839616 of 134263085 bytes (90.7%%,   
    24.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 122732544 of 134263085 bytes (91.4%%,   
    22.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 123650048 of 134263085 bytes (92.1%%,   
    20.9s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 124379136 of 134263085 bytes (92.6%%,   
    19.4s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 125075456 of 134263085 bytes (93.2%%,   
    18.0s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 125706240 of 134263085 bytes (93.6%%,   
    16.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 126394368 of 134263085 bytes (94.1%%,   
    15.4s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 127074304 of 134263085 bytes (94.6%%,   
    14.1s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 127819776 of 134263085 bytes (95.2%%,   
    12.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 128417792 of 134263085 bytes (95.6%%,   
    11.4s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 129114112 of 134263085 bytes (96.2%%,   
    10.0s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 129851392 of 134263085 bytes (96.7%%,    
    8.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 130621440 of 134263085 bytes (97.3%%,    
    7.1s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 131375104 of 134263085 bytes (97.8%%,    
    5.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 132079616 of 134263085 bytes (98.4%%,    
    4.2s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 132726784 of 134263085 bytes (98.9%%,    
    3.0s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 133332992 of 134263085 bytes (99.3%%,    
    1.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 133783552 of 134263085 bytes (99.6%%,    
    0.9s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 134242304 of 134263085 bytes (100.0%%,   
    0.0s remaining)
    [fetch_spm_multimodal_fmri]  ...done. (261 seconds, 4 min)

    [fetch_spm_multimodal_fmri] Extracting data from 
    /home/runner/nilearn_data/spm_multimodal_fmri/sub001/multimodal_fmri.zip...
    [fetch_spm_multimodal_fmri] .. done.

    [fetch_spm_multimodal_fmri] Downloading data from 
    https://www.fil.ion.ucl.ac.uk/spm/download/data/mmfaces/multimodal_smri.zip ...
    [fetch_spm_multimodal_fmri] Downloaded 802816 of 6852766 bytes (11.7%%,    8.1s 
    remaining)
    [fetch_spm_multimodal_fmri] Downloaded 1622016 of 6852766 bytes (23.7%%,    6.9s
    remaining)
    [fetch_spm_multimodal_fmri] Downloaded 2056192 of 6852766 bytes (30.0%%,    7.3s
    remaining)
    [fetch_spm_multimodal_fmri] Downloaded 2375680 of 6852766 bytes (34.7%%,    7.9s
    remaining)
    [fetch_spm_multimodal_fmri] Downloaded 2670592 of 6852766 bytes (39.0%%,    8.1s
    remaining)
    [fetch_spm_multimodal_fmri] Downloaded 2981888 of 6852766 bytes (43.5%%,    8.0s
    remaining)
    [fetch_spm_multimodal_fmri] Downloaded 3342336 of 6852766 bytes (48.8%%,    7.6s
    remaining)
    [fetch_spm_multimodal_fmri] Downloaded 3743744 of 6852766 bytes (54.6%%,    6.8s
    remaining)
    [fetch_spm_multimodal_fmri] Downloaded 4186112 of 6852766 bytes (61.1%%,    5.9s
    remaining)
    [fetch_spm_multimodal_fmri] Downloaded 4694016 of 6852766 bytes (68.5%%,    4.7s
    remaining)
    [fetch_spm_multimodal_fmri] Downloaded 5259264 of 6852766 bytes (76.7%%,    3.4s
    remaining)
    [fetch_spm_multimodal_fmri] Downloaded 5586944 of 6852766 bytes (81.5%%,    2.8s
    remaining)
    [fetch_spm_multimodal_fmri] Downloaded 5914624 of 6852766 bytes (86.3%%,    2.1s
    remaining)
    [fetch_spm_multimodal_fmri] Downloaded 6266880 of 6852766 bytes (91.5%%,    1.3s
    remaining)
    [fetch_spm_multimodal_fmri] Downloaded 6651904 of 6852766 bytes (97.1%%,    0.5s
    remaining)
    [fetch_spm_multimodal_fmri]  ...done. (17 seconds, 0 min)

    [fetch_spm_multimodal_fmri] Extracting data from 
    /home/runner/nilearn_data/spm_multimodal_fmri/sub001/multimodal_smri.zip...
    [fetch_spm_multimodal_fmri] .. done.





.. GENERATED FROM PYTHON SOURCE LINES 26-27

Let's inspect one of the event files before using them.

.. GENERATED FROM PYTHON SOURCE LINES 27-34

.. code-block:: Python

    import pandas as pd

    events = [subject_data.events1, subject_data.events2]

    events_dataframe = pd.read_csv(events[0], sep="\t")
    events_dataframe["trial_type"].value_counts()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    trial_type
    scrambled    86
    faces        64
    Name: count, dtype: int64



.. GENERATED FROM PYTHON SOURCE LINES 35-37

We can confirm there are only 2 conditions in the dataset.


.. GENERATED FROM PYTHON SOURCE LINES 37-43

.. code-block:: Python

    from nilearn.plotting import plot_event, show

    plot_event(events)

    show()




.. image-sg:: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_001.png
   :alt: plot spm multimodal faces
   :srcset: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 44-46

Resample the images:
this is achieved by the ``concat_imgs`` function of Nilearn.

.. GENERATED FROM PYTHON SOURCE LINES 46-61

.. code-block:: Python

    import warnings

    from nilearn.image import concat_imgs, mean_img, resample_img

    # Avoid getting too many warnings due to resampling
    with warnings.catch_warnings():
        warnings.simplefilter("ignore")
        fmri_img = [
            concat_imgs(subject_data.func1, auto_resample=True),
            concat_imgs(subject_data.func2, auto_resample=True),
        ]
    affine, shape = fmri_img[0].affine, fmri_img[0].shape
    print("Resampling the second image (this takes time)...")
    fmri_img[1] = resample_img(fmri_img[1], affine, shape[:3])





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Resampling the second image (this takes time)...




.. GENERATED FROM PYTHON SOURCE LINES 62-63

Let's create mean image for display purposes.

.. GENERATED FROM PYTHON SOURCE LINES 63-65

.. code-block:: Python

    mean_image = mean_img(fmri_img)








.. GENERATED FROM PYTHON SOURCE LINES 66-70

Fit the model
-------------
Fit the :term:`GLM` for the 2 runs
by specifying a FirstLevelModel and then fitting it.

.. GENERATED FROM PYTHON SOURCE LINES 70-94

.. code-block:: Python


    # Sample at the beginning of each acquisition.
    slice_time_ref = 0.0
    # We use a discrete cosine transform to model signal drifts.
    drift_model = "cosine"
    # The cutoff for the drift model is 0.01 Hz.
    high_pass = 0.01
    # The hemodynamic response function
    hrf_model = "spm + derivative"

    from nilearn.glm.first_level import FirstLevelModel

    print("Fitting a GLM")
    fmri_glm = FirstLevelModel(
        smoothing_fwhm=None,
        t_r=subject_data.t_r,
        hrf_model=hrf_model,
        drift_model=drift_model,
        high_pass=high_pass,
    )


    fmri_glm = fmri_glm.fit(fmri_img, events=events)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Fitting a GLM




.. GENERATED FROM PYTHON SOURCE LINES 95-99

View the results
----------------
Now we can compute contrast-related statistical maps (in z-scale),
and plot them.

.. GENERATED FROM PYTHON SOURCE LINES 99-103

.. code-block:: Python

    from nilearn.plotting import plot_stat_map

    print("Computing contrasts")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Computing contrasts




.. GENERATED FROM PYTHON SOURCE LINES 104-109

We actually want more interesting contrasts.
The simplest contrast just makes the difference
between the two main conditions.
We define the two opposite versions to run one-tailed t-tests.


.. GENERATED FROM PYTHON SOURCE LINES 109-112

.. code-block:: Python


    contrasts = ["faces - scrambled", "scrambled - faces"]








.. GENERATED FROM PYTHON SOURCE LINES 113-119

Let's store common parameters for all plots.

We plot the contrasts values overlaid on the mean fMRI image
and we will use the z-score values as transparency,
with any voxel with | Z-score | > 3 being fully opaque
and any voxel with 0 < | Z-score | < 1.96 being partly transparent.

.. GENERATED FROM PYTHON SOURCE LINES 119-142

.. code-block:: Python

    plot_param = {
        "vmin": 0,
        "display_mode": "z",
        "cut_coords": 3,
        "black_bg": True,
        "bg_img": mean_image,
        "cmap": "inferno",
        "transparency_range": [0, 3],
    }

    # Iterate on contrasts to compute and plot them.
    for contrast_id in contrasts:
        print(f"\tcontrast id: {contrast_id}")

        results = fmri_glm.compute_contrast(contrast_id, output_type="all")

        plot_stat_map(
            results["stat"],
            title=contrast_id,
            transparency=results["z_score"],
            **plot_param,
        )




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_002.png
         :alt: plot spm multimodal faces
         :srcset: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_002.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_003.png
         :alt: plot spm multimodal faces
         :srcset: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_003.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

            contrast id: faces - scrambled
    /home/runner/work/nilearn/nilearn/examples/04_glm_first_level/plot_spm_multimodal_faces.py:133: RuntimeWarning: The same contrast will be used for all 2 runs. If the design matrices are not the same for all runs, (for example with different column names or column order across runs) you should pass contrast as an expression using the name of the conditions as they appear in the design matrices.
      results = fmri_glm.compute_contrast(contrast_id, output_type="all")
            contrast id: scrambled - faces
    /home/runner/work/nilearn/nilearn/examples/04_glm_first_level/plot_spm_multimodal_faces.py:133: RuntimeWarning: The same contrast will be used for all 2 runs. If the design matrices are not the same for all runs, (for example with different column names or column order across runs) you should pass contrast as an expression using the name of the conditions as they appear in the design matrices.
      results = fmri_glm.compute_contrast(contrast_id, output_type="all")




.. GENERATED FROM PYTHON SOURCE LINES 143-146

We also define the effects of interest contrast,
a 2-dimensional contrasts spanning the two conditions.


.. GENERATED FROM PYTHON SOURCE LINES 146-161

.. code-block:: Python

    import numpy as np

    contrasts = np.eye(2)

    results = fmri_glm.compute_contrast(contrasts, output_type="all")

    plot_stat_map(
        results["stat"],
        title="effects of interest",
        transparency=results["z_score"],
        **plot_param,
    )

    show()




.. image-sg:: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_004.png
   :alt: plot spm multimodal faces
   :srcset: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/runner/work/nilearn/nilearn/examples/04_glm_first_level/plot_spm_multimodal_faces.py:150: RuntimeWarning: The same contrast will be used for all 2 runs. If the design matrices are not the same for all runs, (for example with different column names or column order across runs) you should pass contrast as an expression using the name of the conditions as they appear in the design matrices.
      results = fmri_glm.compute_contrast(contrasts, output_type="all")
    /home/runner/work/nilearn/nilearn/examples/04_glm_first_level/plot_spm_multimodal_faces.py:150: UserWarning: F contrasts should have 20 columns, but it has only 2. The rest of the contrast was padded with zeros.
      results = fmri_glm.compute_contrast(contrasts, output_type="all")
    /home/runner/work/nilearn/nilearn/examples/04_glm_first_level/plot_spm_multimodal_faces.py:150: UserWarning: Running approximate fixed effects on F statistics.
      results = fmri_glm.compute_contrast(contrasts, output_type="all")




.. GENERATED FROM PYTHON SOURCE LINES 162-171

Based on the resulting maps we observe
that the analysis results in wide activity
for the 'effects of interest' contrast,
showing the implications of large portions of the visual cortex
in the conditions.
By contrast,
the differential effect between "faces" and "scrambled" involves sparser,
more anterior and lateral regions.
It also displays some responses in the frontal lobe.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (6 minutes 15.340 seconds)

**Estimated memory usage:**  967 MB


.. _sphx_glr_download_auto_examples_04_glm_first_level_plot_spm_multimodal_faces.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/nilearn/nilearn/main?urlpath=lab/tree/notebooks/auto_examples/04_glm_first_level/plot_spm_multimodal_faces.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_spm_multimodal_faces.ipynb <plot_spm_multimodal_faces.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_spm_multimodal_faces.py <plot_spm_multimodal_faces.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_spm_multimodal_faces.zip <plot_spm_multimodal_faces.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
