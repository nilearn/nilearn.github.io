
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/04_glm_first_level/plot_spm_multimodal_faces.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_04_glm_first_level_plot_spm_multimodal_faces.py>`
        to download the full example code or to run this example in your browser via Binder.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_04_glm_first_level_plot_spm_multimodal_faces.py:


Single-subject data (two runs) in native space
==============================================

The example shows the analysis of an :term:`SPM` dataset,
with two conditions: viewing a face image or a scrambled face image.

This example takes a lot of time because the input are lists of 3D images
sampled in different positions (encoded by different affine functions).

.. seealso::

    For more information
    see the :ref:`dataset description <spm_multimodal_dataset>`.

.. GENERATED FROM PYTHON SOURCE LINES 18-21

Fetch and inspect the data
--------------------------
Fetch the :term:`SPM` multimodal_faces data.

.. GENERATED FROM PYTHON SOURCE LINES 21-25

.. code-block:: Python

    from nilearn.datasets import fetch_spm_multimodal_fmri

    subject_data = fetch_spm_multimodal_fmri()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [fetch_spm_multimodal_fmri] Dataset created in 
    /home/runner/nilearn_data/spm_multimodal_fmri
    [fetch_spm_multimodal_fmri] Missing 390 functional scans for session 1.
    [fetch_spm_multimodal_fmri] Data absent, downloading...
    [fetch_spm_multimodal_fmri] Downloading data from 
    https://www.fil.ion.ucl.ac.uk/spm/download/data/mmfaces/multimodal_fmri.zip ...
    [fetch_spm_multimodal_fmri] Downloaded 1679360 of 134263085 bytes (1.3%%,  
    1.4min remaining)
    [fetch_spm_multimodal_fmri] Downloaded 6144000 of 134263085 bytes (4.6%%,   
    43.9s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 9461760 of 134263085 bytes (7.0%%,   
    41.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 12500992 of 134263085 bytes (9.3%%,   
    40.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 14876672 of 134263085 bytes (11.1%%,   
    41.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 17358848 of 134263085 bytes (12.9%%,   
    41.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 19513344 of 134263085 bytes (14.5%%,   
    42.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 21585920 of 134263085 bytes (16.1%%,   
    42.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 23969792 of 134263085 bytes (17.9%%,   
    42.5s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 25878528 of 134263085 bytes (19.3%%,   
    42.9s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 27721728 of 134263085 bytes (20.6%%,   
    43.2s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 29450240 of 134263085 bytes (21.9%%,   
    43.7s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 31195136 of 134263085 bytes (23.2%%,   
    43.9s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 32858112 of 134263085 bytes (24.5%%,   
    44.1s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 34521088 of 134263085 bytes (25.7%%,   
    44.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 36036608 of 134263085 bytes (26.8%%,   
    44.5s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 37339136 of 134263085 bytes (27.8%%,   
    45.0s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 38633472 of 134263085 bytes (28.8%%,   
    45.4s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 40001536 of 134263085 bytes (29.8%%,   
    45.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 41336832 of 134263085 bytes (30.8%%,   
    45.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 42745856 of 134263085 bytes (31.8%%,   
    45.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 44154880 of 134263085 bytes (32.9%%,   
    45.7s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 45522944 of 134263085 bytes (33.9%%,   
    45.7s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 46702592 of 134263085 bytes (34.8%%,   
    45.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 47980544 of 134263085 bytes (35.7%%,   
    45.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 48939008 of 134263085 bytes (36.5%%,   
    46.2s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 50028544 of 134263085 bytes (37.3%%,   
    46.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 51159040 of 134263085 bytes (38.1%%,   
    46.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 52125696 of 134263085 bytes (38.8%%,   
    46.5s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 53059584 of 134263085 bytes (39.5%%,   
    46.7s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 54067200 of 134263085 bytes (40.3%%,   
    46.7s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 55173120 of 134263085 bytes (41.1%%,   
    46.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 56320000 of 134263085 bytes (41.9%%,   
    46.4s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 57425920 of 134263085 bytes (42.8%%,   
    46.2s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 58556416 of 134263085 bytes (43.6%%,   
    46.0s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 59596800 of 134263085 bytes (44.4%%,   
    45.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 60538880 of 134263085 bytes (45.1%%,   
    45.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 61521920 of 134263085 bytes (45.8%%,   
    45.7s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 62382080 of 134263085 bytes (46.5%%,   
    45.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 63283200 of 134263085 bytes (47.1%%,   
    45.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 64053248 of 134263085 bytes (47.7%%,   
    45.7s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 64880640 of 134263085 bytes (48.3%%,   
    45.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 65757184 of 134263085 bytes (49.0%%,   
    45.5s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 66617344 of 134263085 bytes (49.6%%,   
    45.4s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 67411968 of 134263085 bytes (50.2%%,   
    45.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 68263936 of 134263085 bytes (50.8%%,   
    45.2s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 69206016 of 134263085 bytes (51.5%%,   
    44.9s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 70139904 of 134263085 bytes (52.2%%,   
    44.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 71032832 of 134263085 bytes (52.9%%,   
    44.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 72007680 of 134263085 bytes (53.6%%,   
    43.9s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 73007104 of 134263085 bytes (54.4%%,   
    43.5s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 74063872 of 134263085 bytes (55.2%%,   
    42.9s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 75366400 of 134263085 bytes (56.1%%,   
    42.1s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 76931072 of 134263085 bytes (57.3%%,   
    40.9s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 78913536 of 134263085 bytes (58.8%%,   
    39.2s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 81510400 of 134263085 bytes (60.7%%,   
    36.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 84762624 of 134263085 bytes (63.1%%,   
    33.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 87810048 of 134263085 bytes (65.4%%,   
    31.1s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 91086848 of 134263085 bytes (67.8%%,   
    28.4s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 94437376 of 134263085 bytes (70.3%%,   
    25.7s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 97394688 of 134263085 bytes (72.5%%,   
    23.4s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 99377152 of 134263085 bytes (74.0%%,   
    22.1s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 100851712 of 134263085 bytes (75.1%%,   
    21.2s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 102514688 of 134263085 bytes (76.4%%,   
    20.1s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 104267776 of 134263085 bytes (77.7%%,   
    19.0s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 105873408 of 134263085 bytes (78.9%%,   
    18.0s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 107274240 of 134263085 bytes (79.9%%,   
    17.1s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 108871680 of 134263085 bytes (81.1%%,   
    16.1s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 110460928 of 134263085 bytes (82.3%%,   
    15.1s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 112246784 of 134263085 bytes (83.6%%,   
    13.9s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 114008064 of 134263085 bytes (84.9%%,   
    12.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 115679232 of 134263085 bytes (86.2%%,   
    11.7s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 117465088 of 134263085 bytes (87.5%%,   
    10.6s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 119291904 of 134263085 bytes (88.8%%,    
    9.4s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 121094144 of 134263085 bytes (90.2%%,    
    8.3s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 123207680 of 134263085 bytes (91.8%%,    
    6.9s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 125591552 of 134263085 bytes (93.5%%,    
    5.4s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 128180224 of 134263085 bytes (95.5%%,    
    3.8s remaining)
    [fetch_spm_multimodal_fmri] Downloaded 131514368 of 134263085 bytes (98.0%%,    
    1.7s remaining)
    [fetch_spm_multimodal_fmri]  ...done. (83 seconds, 1 min)

    [fetch_spm_multimodal_fmri] Extracting data from 
    /home/runner/nilearn_data/spm_multimodal_fmri/sub001/multimodal_fmri.zip...
    [fetch_spm_multimodal_fmri] .. done.

    [fetch_spm_multimodal_fmri] Downloading data from 
    https://www.fil.ion.ucl.ac.uk/spm/download/data/mmfaces/multimodal_smri.zip ...
    [fetch_spm_multimodal_fmri] Downloaded 1490944 of 6852766 bytes (21.8%%,    3.7s
    remaining)
    [fetch_spm_multimodal_fmri]  ...done. (3 seconds, 0 min)

    [fetch_spm_multimodal_fmri] Extracting data from 
    /home/runner/nilearn_data/spm_multimodal_fmri/sub001/multimodal_smri.zip...
    [fetch_spm_multimodal_fmri] .. done.





.. GENERATED FROM PYTHON SOURCE LINES 26-27

Let's inspect one of the event files before using them.

.. GENERATED FROM PYTHON SOURCE LINES 27-34

.. code-block:: Python

    import pandas as pd

    events = [subject_data.events1, subject_data.events2]

    events_dataframe = pd.read_csv(events[0], sep="\t")
    events_dataframe["trial_type"].value_counts()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    trial_type
    scrambled    86
    faces        64
    Name: count, dtype: int64



.. GENERATED FROM PYTHON SOURCE LINES 35-37

We can confirm there are only 2 conditions in the dataset.


.. GENERATED FROM PYTHON SOURCE LINES 37-43

.. code-block:: Python

    from nilearn.plotting import plot_event, show

    plot_event(events)

    show()




.. image-sg:: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_001.png
   :alt: plot spm multimodal faces
   :srcset: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/runner/work/nilearn/nilearn/examples/04_glm_first_level/plot_spm_multimodal_faces.py:41: UserWarning:

    You are using the 'agg' matplotlib backend that is non-interactive.
    No figure will be plotted when calling matplotlib.pyplot.show() or nilearn.plotting.show().
    You can fix this by installing a different backend: for example via
            pip install PyQt6





.. GENERATED FROM PYTHON SOURCE LINES 44-46

Resample the images:
this is achieved by the ``concat_imgs`` function of Nilearn.

.. GENERATED FROM PYTHON SOURCE LINES 46-61

.. code-block:: Python

    import warnings

    from nilearn.image import concat_imgs, mean_img, resample_img

    # Avoid getting too many warnings due to resampling
    with warnings.catch_warnings():
        warnings.simplefilter("ignore")
        fmri_img = [
            concat_imgs(subject_data.func1, auto_resample=True),
            concat_imgs(subject_data.func2, auto_resample=True),
        ]
    affine, shape = fmri_img[0].affine, fmri_img[0].shape
    print("Resampling the second image (this takes time)...")
    fmri_img[1] = resample_img(fmri_img[1], affine, shape[:3])





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Resampling the second image (this takes time)...




.. GENERATED FROM PYTHON SOURCE LINES 62-63

Let's create mean image for display purposes.

.. GENERATED FROM PYTHON SOURCE LINES 63-65

.. code-block:: Python

    mean_image = mean_img(fmri_img)








.. GENERATED FROM PYTHON SOURCE LINES 66-70

Fit the model
-------------
Fit the :term:`GLM` for the 2 runs
by specifying a FirstLevelModel and then fitting it.

.. GENERATED FROM PYTHON SOURCE LINES 70-95

.. code-block:: Python


    # Sample at the beginning of each acquisition.
    slice_time_ref = 0.0
    # We use a discrete cosine transform to model signal drifts.
    drift_model = "cosine"
    # The cutoff for the drift model is 0.01 Hz.
    high_pass = 0.01
    # The hemodynamic response function
    hrf_model = "spm + derivative"

    from nilearn.glm.first_level import FirstLevelModel

    print("Fitting a GLM")
    fmri_glm = FirstLevelModel(
        smoothing_fwhm=None,
        t_r=subject_data.t_r,
        hrf_model=hrf_model,
        drift_model=drift_model,
        high_pass=high_pass,
        verbose=1,
    )


    fmri_glm = fmri_glm.fit(fmri_img, events=events)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Fitting a GLM
    [FirstLevelModel.fit] Loading data from <nibabel.nifti1.Nifti1Image object at 
    0x7f588142f4f0>
    [FirstLevelModel.fit] Computing mask
    [FirstLevelModel.fit] Resampling mask
    [FirstLevelModel.fit] Finished fit
    [FirstLevelModel.fit] Computing run 1 out of 2 runs (go take a coffee, a big 
    one).
    [FirstLevelModel.fit] Performing mask computation.
    [FirstLevelModel.fit] Loading data from <nibabel.nifti1.Nifti1Image object at 
    0x7f588142f4f0>
    [FirstLevelModel.fit] Extracting region signals
    [FirstLevelModel.fit] Cleaning extracted signals
    [FirstLevelModel.fit] Masking took 1 seconds.
    [FirstLevelModel.fit] Performing GLM computation.
    [FirstLevelModel.fit] GLM took 1 seconds.
    [FirstLevelModel.fit] Computing run 2 out of 2 runs (2 seconds remaining).
    [FirstLevelModel.fit] Performing mask computation.
    [FirstLevelModel.fit] Loading data from <nibabel.nifti1.Nifti1Image object at 
    0x7f58522726b0>
    [FirstLevelModel.fit] Extracting region signals
    [FirstLevelModel.fit] Cleaning extracted signals
    [FirstLevelModel.fit] Masking took 1 seconds.
    [FirstLevelModel.fit] Performing GLM computation.
    [FirstLevelModel.fit] GLM took 1 seconds.
    [FirstLevelModel.fit] Computation of 2 runs done in 4 seconds.




.. GENERATED FROM PYTHON SOURCE LINES 96-100

View the results
----------------
Now we can compute contrast-related statistical maps (in z-scale),
and plot them.

.. GENERATED FROM PYTHON SOURCE LINES 100-104

.. code-block:: Python

    from nilearn.plotting import plot_stat_map

    print("Computing contrasts")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Computing contrasts




.. GENERATED FROM PYTHON SOURCE LINES 105-110

We actually want more interesting contrasts.
The simplest contrast just makes the difference
between the two main conditions.
We define the two opposite versions to run one-tailed t-tests.


.. GENERATED FROM PYTHON SOURCE LINES 110-113

.. code-block:: Python


    contrasts = ["faces - scrambled", "scrambled - faces"]








.. GENERATED FROM PYTHON SOURCE LINES 114-120

Let's store common parameters for all plots.

We plot the contrasts values overlaid on the mean fMRI image
and we will use the z-score values as transparency,
with any voxel with | Z-score | > 3 being fully opaque
and any voxel with 0 < | Z-score | < 1.96 being partly transparent.

.. GENERATED FROM PYTHON SOURCE LINES 120-143

.. code-block:: Python

    plot_param = {
        "vmin": 0,
        "display_mode": "z",
        "cut_coords": 3,
        "black_bg": True,
        "bg_img": mean_image,
        "cmap": "inferno",
        "transparency_range": [0, 3],
    }

    # Iterate on contrasts to compute and plot them.
    for contrast_id in contrasts:
        print(f"\tcontrast id: {contrast_id}")

        results = fmri_glm.compute_contrast(contrast_id, output_type="all")

        plot_stat_map(
            results["stat"],
            title=contrast_id,
            transparency=results["z_score"],
            **plot_param,
        )




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_002.png
         :alt: plot spm multimodal faces
         :srcset: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_002.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_003.png
         :alt: plot spm multimodal faces
         :srcset: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_003.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

            contrast id: faces - scrambled
    /home/runner/work/nilearn/nilearn/examples/04_glm_first_level/plot_spm_multimodal_faces.py:134: RuntimeWarning:

    The same contrast will be used for all 2 runs. If the design matrices are not the same for all runs, (for example with different column names or column order across runs) you should pass contrast as an expression using the name of the conditions as they appear in the design matrices.

    [FirstLevelModel.compute_contrast] Computing image from signals
    [FirstLevelModel.compute_contrast] Computing image from signals
    [FirstLevelModel.compute_contrast] Computing image from signals
    [FirstLevelModel.compute_contrast] Computing image from signals
    [FirstLevelModel.compute_contrast] Computing image from signals
            contrast id: scrambled - faces
    /home/runner/work/nilearn/nilearn/examples/04_glm_first_level/plot_spm_multimodal_faces.py:134: RuntimeWarning:

    The same contrast will be used for all 2 runs. If the design matrices are not the same for all runs, (for example with different column names or column order across runs) you should pass contrast as an expression using the name of the conditions as they appear in the design matrices.

    [FirstLevelModel.compute_contrast] Computing image from signals
    [FirstLevelModel.compute_contrast] Computing image from signals
    [FirstLevelModel.compute_contrast] Computing image from signals
    [FirstLevelModel.compute_contrast] Computing image from signals
    [FirstLevelModel.compute_contrast] Computing image from signals




.. GENERATED FROM PYTHON SOURCE LINES 144-147

We also define the effects of interest contrast,
a 2-dimensional contrasts spanning the two conditions.


.. GENERATED FROM PYTHON SOURCE LINES 147-162

.. code-block:: Python

    import numpy as np

    contrasts = np.eye(2)

    results = fmri_glm.compute_contrast(contrasts, output_type="all")

    plot_stat_map(
        results["stat"],
        title="effects of interest",
        transparency=results["z_score"],
        **plot_param,
    )

    show()




.. image-sg:: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_004.png
   :alt: plot spm multimodal faces
   :srcset: /auto_examples/04_glm_first_level/images/sphx_glr_plot_spm_multimodal_faces_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/runner/work/nilearn/nilearn/examples/04_glm_first_level/plot_spm_multimodal_faces.py:151: RuntimeWarning:

    The same contrast will be used for all 2 runs. If the design matrices are not the same for all runs, (for example with different column names or column order across runs) you should pass contrast as an expression using the name of the conditions as they appear in the design matrices.

    /home/runner/work/nilearn/nilearn/examples/04_glm_first_level/plot_spm_multimodal_faces.py:151: UserWarning:

    F contrasts should have 20 columns, but it has only 2. The rest of the contrast was padded with zeros.

    /home/runner/work/nilearn/nilearn/examples/04_glm_first_level/plot_spm_multimodal_faces.py:151: UserWarning:

    Running approximate fixed effects on F statistics.

    [FirstLevelModel.compute_contrast] Computing image from signals
    [FirstLevelModel.compute_contrast] Computing image from signals
    [FirstLevelModel.compute_contrast] Computing image from signals
    [FirstLevelModel.compute_contrast] Computing image from signals
    [FirstLevelModel.compute_contrast] Computing image from signals
    /home/runner/work/nilearn/nilearn/examples/04_glm_first_level/plot_spm_multimodal_faces.py:160: UserWarning:

    You are using the 'agg' matplotlib backend that is non-interactive.
    No figure will be plotted when calling matplotlib.pyplot.show() or nilearn.plotting.show().
    You can fix this by installing a different backend: for example via
            pip install PyQt6





.. GENERATED FROM PYTHON SOURCE LINES 163-172

Based on the resulting maps we observe
that the analysis results in wide activity
for the 'effects of interest' contrast,
showing the implications of large portions of the visual cortex
in the conditions.
By contrast,
the differential effect between "faces" and "scrambled" involves sparser,
more anterior and lateral regions.
It also displays some responses in the frontal lobe.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (2 minutes 25.844 seconds)

**Estimated memory usage:**  1034 MB


.. _sphx_glr_download_auto_examples_04_glm_first_level_plot_spm_multimodal_faces.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/nilearn/nilearn/main?urlpath=lab/tree/notebooks/auto_examples/04_glm_first_level/plot_spm_multimodal_faces.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_spm_multimodal_faces.ipynb <plot_spm_multimodal_faces.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_spm_multimodal_faces.py <plot_spm_multimodal_faces.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_spm_multimodal_faces.zip <plot_spm_multimodal_faces.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
