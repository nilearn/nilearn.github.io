
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

<meta property="og:title" content="5.3. Second level models" />
  
<meta property="og:type" content="website" />
  
<meta property="og:url" content="https://nilearn.github.io/glm/second_level_model.html" />
  
<meta property="og:site_name" content="Nilearn" />
  
<meta property="og:description" content="Page summary: Second level models in Nilearn are used to perform group-level analyses on fMRI data. Once individual subjects have been processed in a common space (e.g. MNI, Talairach, or subject a..." />
  
<meta property="og:image" content="https://nilearn.github.io/_static/nilearn-logo.png" />
  
<meta property="og:image:alt" content="Nilearn" />
  
    <title>Nilearn: Statistical Analysis for NeuroImaging in Python &#8212; Machine learning for NeuroImaging</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Manipulation brain volumes with nilearn" href="../manipulating_images/index.html" />
    <link rel="prev" title="5.2. First level models" href="first_level_model.html" />
<meta content="True" name="HandheldFriendly">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta name="keywords" content="nilearn, neuroimaging, python, neuroscience, machinelearning">


<script type="text/javascript">
function updateTopMenuPosition(height, width) {
    if($(window).scrollTop() > height && $(window).outerWidth() > 1024) {
        //begin to scroll
        $('.related-wrapper').css("z-index", 1000);
        $('.related-wrapper').css("position", "sticky");
        $('.related-wrapper').css("top", 0);
        $('.related-wrapper').css("width", width)
    } else {
        //lock it back into place
        $('.related-wrapper').css("position", "relative");
        $('.related-wrapper').css("top", 0)
    }
}

$(function() {
    var banner_height = $('#logo-banner').outerHeight();
    var banner_width = $('#logo-banner').outerWidth();
    var width = $('.related-wrapper').css("height", $('.related').outerHeight());

    updateTopMenuPosition(banner_height, width);

    $(window).scroll(function(event) {
        updateTopMenuPosition(banner_height, width)
    });

    $(window).resize(function(event) {
        var banner_width = $('#logo-banner').outerWidth();
        var menu_height = $('.related').outerHeight();
        $('.related').css("width", banner_width);
        $('.related-wrapper').css("height", menu_height);
        updateTopMenuPosition(banner_height, width)
    })
});
</script>
<script type="text/javascript">
function updateSideBarPosition(top, offset, sections) {
    var pos = $(window).scrollTop();
    // Lock the table of content to a fixed position once we scroll enough
    var topShift = 2 * offset;
    if(pos > top + topShift + 1) {
        // begin to scroll with sticky menu bar
        var topShift = -topShift + 1;
        if ($(window).outerWidth() < 1024) {
            // compensate top menu that disappears
            topShift -= offset + 1
        }
        $('.sphinxsidebarwrapper').css("position", "fixed");
        $('.sphinxsidebarwrapper').css("top", topShift)
    }
    else {
        //lock it back into place
        $('.sphinxsidebarwrapper').css("position", "relative");
        $('.sphinxsidebarwrapper').css("top",0)
    }

    // Highlight the current section
    i = 0;
    current_section = 0;
    $('a.internal').removeClass('active');
    for(i in sections) {
        if(sections[i] > pos) {
            break
        }
        if($('a.internal[href$="' + i + '"]').is(':visible')){
            current_section = i
        }
    }
    $('a.internal[href$="' + current_section + '"]').addClass('active');
    $('a.internal[href$="' + current_section + '"]').parent().addClass('active')
}

$(function () {
    // Lock the table of content to a fixed position once we scroll enough
    var tocOffset = $('.related-wrapper').outerHeight();
    var marginTop = parseFloat($('.sphinxsidebarwrapper').css('margin-top').replace(/auto/, 0));
    var top = $('.sphinxsidebarwrapper').offset().top - marginTop;
    sections = {};
    url = document.URL.replace(/#.*$/, "");

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50
    });

    updateSideBarPosition(top, tocOffset, sections);

    $(window).scroll(function(event) {
        updateSideBarPosition(top, tocOffset, sections)
    });

    $(window).resize(function(event) {
        tocOffset = $('.related-wrapper').outerHeight();
        updateSideBarPosition(top, tocOffset, sections)
    });
});
</script>


<script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-41920728-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

  </head><body>
<div id="logo-banner">
  <div class="logo">
    <a href="../index.html">
      <img src="../_static/nilearn-logo.png" alt="Nilearn logo"  border="0" />
    </a>
  </div>
  <!-- A tag cloud to make it easy for people to find what they are
                         looking for -->
 <div class="tags">
  <ul>
    <li>
      <big><a href="../auto_examples/decoding/plot_haxby_anova_svm.html">SVM</a></big>
    </li>
    <li>
      <small><a href="../connectivity/parcellating.html">Ward
          clustering</a></small>
    </li>
    <li>
      <a href="../decoding/searchlight.html">Searchlight</a>
    </li>
    <li>
      <big><a href="../connectivity/resting_state_networks.html">ICA</a></big>
    </li>
    <li>
      <a href="../manipulating_images/data_preparation.html">Nifti IO</a>
    </li>
    <li>
      <a href="../modules/reference.html#module-nilearn.datasets">Datasets</a>
    </li>
  </ul>
 </div>

  <div class="banner">
    <h1>Nilearn:</h1>
    <h2>Statistics for NeuroImaging in Python</h2>
  </div>
  <div class="search_form">
    <div class="gcse-search" id="cse" style="width: 100%;"></div>
    <script>
      (function() {
        var cx = '017289614950330089114:elrt9qoutrq';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
  </div>
</div>



<div class=related-wrapper>
    
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="../manipulating_images/index.html" title="6. Manipulation brain volumes with nilearn"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="first_level_model.html" title="5.2. First level models"
             accesskey="P">previous</a> |</li>
<li><a href="../index.html">Nilearn Home</a> |&nbsp;</li>
<li><a href="../user_guide.html">User Guide</a> |&nbsp;</li>
<li><a href="../auto_examples/index.html">Examples</a> |&nbsp;</li>
<li><a href="../modules/reference.html">Reference</a> |&nbsp;</li>
<li id="navbar-about"><a href="../authors.html">About</a>|&nbsp;</li>
<li><a href="../glossary.html">Glossary</a>|&nbsp;</li>
<li><a href="../bibliography.html">Bibliography</a>|&nbsp;</li>
<li id="navbar-ecosystem"><a href="http://www.nipy.org/">Nipy ecosystem</a></li>

          <li class="nav-item nav-item-1"><a href="../user_guide.html" >User guide: table of contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U"><span class="section-number">5. </span>Analyzing fMRI using GLMs</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Nilearn: Statistical Analysis for NeuroImaging in Python</a></li> 
      </ul>
    </div>
</div>

<div class="devel-alert-banner">
This is documentation for the <em>unstable development version</em> of Nilearn,
the current stable version is available <a href="https://nilearn.github.io/stable/index.html">here</a>.
</div>

  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="second-level-models">
<span id="second-level-model"></span><h1><span class="section-number">5.3. </span>Second level models<a class="headerlink" href="#second-level-models" title="Permalink to this heading">¶</a></h1>
<aside class="topic">
<p class="topic-title"><strong>Page summary</strong></p>
<p>Second level models in Nilearn are used to perform group-level analyses on fMRI data. Once individual
subjects have been processed in a common space (e.g. MNI, Talairach, or subject average), the data can
be grouped and statistical tests  performed to make broader inferences on fMRI activity. Some common
second level models are one-sample (unpaired or paired) and two-sample t-tests.</p>
</aside>
<nav class="contents local" id="contents">
<p class="topic-title"><strong>Contents</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#fitting-a-second-level-model" id="id1">Fitting a second level model</a></p></li>
<li><p><a class="reference internal" href="#thresholding-statistical-maps" id="id2">Thresholding statistical maps</a></p></li>
<li><p><a class="reference internal" href="#multiple-comparisons-correction" id="id3">Multiple comparisons correction</a></p></li>
<li><p><a class="reference internal" href="#voxel-based-morphometry" id="id4">Voxel based morphometry</a></p></li>
</ul>
</nav>
<section id="fitting-a-second-level-model">
<h2><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">5.3.1. </span>Fitting a second level model</a><a class="headerlink" href="#fitting-a-second-level-model" title="Permalink to this heading">¶</a></h2>
<p>As with first level models, a design matrix needs to be defined before fitting a second level model.
Again, similar to first level models, Nilearn provides a function
<a class="reference internal" href="../modules/generated/nilearn.glm.second_level.make_second_level_design_matrix.html#nilearn.glm.second_level.make_second_level_design_matrix" title="nilearn.glm.second_level.make_second_level_design_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">nilearn.glm.second_level.make_second_level_design_matrix</span></code></a> for this purpose. Once
the design matrix has been setup, it can be visualized using the same function as before,
<a class="reference internal" href="../modules/generated/nilearn.plotting.plot_design_matrix.html#nilearn.plotting.plot_design_matrix" title="nilearn.plotting.plot_design_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">nilearn.plotting.plot_design_matrix</span></code></a>.</p>
<p>To fit the second level model, the tools to use are within the class
<a class="reference internal" href="../modules/generated/nilearn.glm.second_level.SecondLevelModel.html#nilearn.glm.second_level.SecondLevelModel" title="nilearn.glm.second_level.SecondLevelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">nilearn.glm.second_level.SecondLevelModel</span></code></a>. Specifically, the function that
fits the model is <a class="reference internal" href="../modules/generated/nilearn.glm.second_level.SecondLevelModel.html#nilearn.glm.second_level.SecondLevelModel.fit" title="nilearn.glm.second_level.SecondLevelModel.fit"><code class="xref py py-func docutils literal notranslate"><span class="pre">nilearn.glm.second_level.SecondLevelModel.fit</span></code></a>.</p>
<dl class="simple">
<dt>Some examples to get you going with second level models are provided below::</dt><dd><ul class="simple">
<li><p>General design matrix setup: <a class="reference internal" href="../auto_examples/05_glm_second_level/plot_second_level_design_matrix.html#sphx-glr-auto-examples-05-glm-second-level-plot-second-level-design-matrix-py"><span class="std std-ref">Example of second level design matrix</span></a></p></li>
<li><p>One-sample testing: <a class="reference internal" href="../auto_examples/05_glm_second_level/plot_second_level_one_sample_test.html#sphx-glr-auto-examples-05-glm-second-level-plot-second-level-one-sample-test-py"><span class="std std-ref">Second-level fMRI model: one sample test</span></a></p></li>
<li><p>Two-sample testing, unpaired and paired: <a class="reference internal" href="../auto_examples/05_glm_second_level/plot_second_level_two_sample_test.html#sphx-glr-auto-examples-05-glm-second-level-plot-second-level-two-sample-test-py"><span class="std std-ref">Second-level fMRI model: two-sample test, unpaired and paired</span></a></p></li>
<li><p>Complex contrast: <a class="reference internal" href="../auto_examples/05_glm_second_level/plot_second_level_association_test.html#sphx-glr-auto-examples-05-glm-second-level-plot-second-level-association-test-py"><span class="std std-ref">Example of generic design in second-level models</span></a></p></li>
</ul>
</dd>
</dl>
</section>
<section id="thresholding-statistical-maps">
<h2><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">5.3.2. </span>Thresholding statistical maps</a><a class="headerlink" href="#thresholding-statistical-maps" title="Permalink to this heading">¶</a></h2>
<p>Nilearn’s statistical plotting functions provide simple thresholding functionality. For instance, functions
like <a class="reference internal" href="../modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map" title="nilearn.plotting.plot_stat_map"><code class="xref py py-func docutils literal notranslate"><span class="pre">nilearn.plotting.plot_stat_map</span></code></a> or <a class="reference internal" href="../modules/generated/nilearn.plotting.plot_glass_brain.html#nilearn.plotting.plot_glass_brain" title="nilearn.plotting.plot_glass_brain"><code class="xref py py-func docutils literal notranslate"><span class="pre">nilearn.plotting.plot_glass_brain</span></code></a> have an argument
called <cite>threshold</cite> that, when set, will only show voxels with a value that is over the threshold provided.</p>
<p>Thresholding examples are available here: <a class="reference internal" href="../auto_examples/05_glm_second_level/plot_second_level_one_sample_test.html#sphx-glr-auto-examples-05-glm-second-level-plot-second-level-one-sample-test-py"><span class="std std-ref">Second-level fMRI model: one sample test</span></a>
and <a class="reference internal" href="../auto_examples/05_glm_second_level/plot_thresholding.html#sphx-glr-auto-examples-05-glm-second-level-plot-thresholding-py"><span class="std std-ref">Statistical testing of a second-level analysis</span></a>.</p>
</section>
<section id="multiple-comparisons-correction">
<h2><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">5.3.3. </span>Multiple comparisons correction</a><a class="headerlink" href="#multiple-comparisons-correction" title="Permalink to this heading">¶</a></h2>
<p>As discussed in the <a class="reference internal" href="glm_intro.html#multiple-comparisons"><span class="std std-ref">Multiple Comparisons</span></a> section of the introduction, the issue of multiple comparisons is
important to address with statistical analysis of fMRI data. Nilearn provides parametric and non-parametric tools
to address this issue.</p>
<p>Refer to the example <a class="reference internal" href="../auto_examples/05_glm_second_level/plot_thresholding.html#sphx-glr-auto-examples-05-glm-second-level-plot-thresholding-py"><span class="std std-ref">Statistical testing of a second-level analysis</span></a> for a guide
to applying FPR, FDR and FWER corrections. These corrections are applied using the <a class="reference internal" href="../modules/generated/nilearn.glm.threshold_stats_img.html#nilearn.glm.threshold_stats_img" title="nilearn.glm.threshold_stats_img"><code class="xref py py-func docutils literal notranslate"><span class="pre">nilearn.glm.threshold_stats_img</span></code></a> function.</p>
<p>Within an activated cluster, not all voxels represent true activation. To estimate true positives within a cluster,
Nilearn provides the <a class="reference internal" href="../modules/generated/nilearn.glm.cluster_level_inference.html#nilearn.glm.cluster_level_inference" title="nilearn.glm.cluster_level_inference"><code class="xref py py-func docutils literal notranslate"><span class="pre">nilearn.glm.cluster_level_inference</span></code></a> function. An example with usage information is available
here: <a class="reference internal" href="../auto_examples/05_glm_second_level/plot_proportion_activated_voxels.html#sphx-glr-auto-examples-05-glm-second-level-plot-proportion-activated-voxels-py"><span class="std std-ref">Second-level fMRI model: true positive proportion in clusters</span></a>.</p>
</section>
<section id="voxel-based-morphometry">
<h2><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">5.3.4. </span>Voxel based morphometry</a><a class="headerlink" href="#voxel-based-morphometry" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../modules/generated/nilearn.glm.second_level.SecondLevelModel.html#nilearn.glm.second_level.SecondLevelModel" title="nilearn.glm.second_level.SecondLevelModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">nilearn.glm.second_level.SecondLevelModel</span></code></a> and its associated functions can also be used
to perform voxel based morphometry. An example using the <a class="reference external" href="http://www.oasis-brains.org/">OASIS</a> dataset to
identify the relationship between aging, sex and gray matter density is available here
<a class="reference internal" href="../auto_examples/05_glm_second_level/plot_oasis.html#sphx-glr-auto-examples-05-glm-second-level-plot-oasis-py"><span class="std std-ref">Voxel-Based Morphometry on OASIS dataset</span></a>.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">


<h4> Giving credit </h4>
  <ul class="simple">
    <li><p>Please consider <a href="../authors.html#citing">citing the
                    papers</a>.</p></li>
  </ul>

  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">5.3. Second level models</a><ul>
<li><a class="reference internal" href="#fitting-a-second-level-model">5.3.1. Fitting a second level model</a></li>
<li><a class="reference internal" href="#thresholding-statistical-maps">5.3.2. Thresholding statistical maps</a></li>
<li><a class="reference internal" href="#multiple-comparisons-correction">5.3.3. Multiple comparisons correction</a></li>
<li><a class="reference internal" href="#voxel-based-morphometry">5.3.4. Voxel based morphometry</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="first_level_model.html"
                          title="previous chapter"><span class="section-number">5.2. </span>First level models</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../manipulating_images/index.html"
                          title="next chapter"><span class="section-number">6. </span>Manipulation brain volumes with nilearn</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="footer">
            &copy; The nilearn developers 2010-2022.
          Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 5.0.1.
        <span style="padding-left: 5ex;">
          <a href="../_sources/glm/second_level_model.rst.txt"
        	 rel="nofollow">Show this page source</a>
        </span>
    </div>
  </body>
</html>