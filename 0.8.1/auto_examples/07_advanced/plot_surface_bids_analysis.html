<!doctypehtml><html lang=en><meta charset=utf-8><meta content=width=device-width,initial-scale=1.0 name=viewport><title>Nilearn: Statistical Analysis for NeuroImaging in Python — Machine learning for NeuroImaging</title><link href=../../_static/pygments.css rel=stylesheet><link href=../../_static/nature.css rel=stylesheet><link href=../../_static/copybutton.css rel=stylesheet><link href=../../_static/gallery.css rel=stylesheet><link href=../../_static/gallery-binder.css rel=stylesheet><link href=../../_static/gallery-dataframe.css rel=stylesheet><script data-url_root=../../ id=documentation_options src=../../_static/documentation_options.js></script><script src=../../_static/jquery.js></script><script src=../../_static/underscore.js></script><script src=../../_static/doctools.js></script><script src=../../_static/clipboard.min.js></script><script src=../../_static/copybutton.js></script><link rel="shortcut icon"href=../../_static/favicon.ico><link href=../../search.html rel=search title=Search><link title="9.8.8. NeuroVault cross-study ICA maps."href=plot_ica_neurovault.html rel=next><link title="9.8.6. Massively univariate analysis of a motor task from the Localizer dataset"href=plot_localizer_mass_univariate_methods.html rel=prev><meta content=True name=HandheldFriendly><meta content=width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0 name=viewport><meta content="nilearn, neuroimaging, python, neuroscience, machinelearning"name=keywords><script>function updateTopMenuPosition(height, width) {
    if($(window).scrollTop() > height && $(window).outerWidth() > 1024) {
        //begin to scroll
        $('.related-wrapper').css("z-index", 1000);
        $('.related-wrapper').css("position", "sticky");
        $('.related-wrapper').css("top", 0);
        $('.related-wrapper').css("width", width)
    } else {
        //lock it back into place
        $('.related-wrapper').css("position", "relative");
        $('.related-wrapper').css("top", 0)
    }
}

$(function() {
    var banner_height = $('#logo-banner').outerHeight();
    var banner_width = $('#logo-banner').outerWidth();
    var width = $('.related-wrapper').css("height", $('.related').outerHeight());

    updateTopMenuPosition(banner_height, width);

    $(window).scroll(function(event) {
        updateTopMenuPosition(banner_height, width)
    });

    $(window).resize(function(event) {
        var banner_width = $('#logo-banner').outerWidth();
        var menu_height = $('.related').outerHeight();
        $('.related').css("width", banner_width);
        $('.related-wrapper').css("height", menu_height);
        updateTopMenuPosition(banner_height, width)
    })
});</script><script>function updateSideBarPosition(top, offset, sections) {
    var pos = $(window).scrollTop();
    // Lock the table of content to a fixed position once we scroll enough
    var topShift = 2 * offset;
    if(pos > top + topShift + 1) {
        // begin to scroll with sticky menu bar
        var topShift = -topShift + 1;
        if ($(window).outerWidth() < 1024) {
            // compensate top menu that disappears
            topShift -= offset + 1
        }
        $('.sphinxsidebarwrapper').css("position", "fixed");
        $('.sphinxsidebarwrapper').css("top", topShift)
    }
    else {
        //lock it back into place
        $('.sphinxsidebarwrapper').css("position", "relative");
        $('.sphinxsidebarwrapper').css("top",0)
    }

    // Highlight the current section
    i = 0;
    current_section = 0;
    $('a.internal').removeClass('active');
    for(i in sections) {
        if(sections[i] > pos) {
            break
        }
        if($('a.internal[href$="' + i + '"]').is(':visible')){
            current_section = i
        }
    }
    $('a.internal[href$="' + current_section + '"]').addClass('active');
    $('a.internal[href$="' + current_section + '"]').parent().addClass('active')
}

$(function () {
    // Lock the table of content to a fixed position once we scroll enough
    var tocOffset = $('.related-wrapper').outerHeight();
    var marginTop = parseFloat($('.sphinxsidebarwrapper').css('margin-top').replace(/auto/, 0));
    var top = $('.sphinxsidebarwrapper').offset().top - marginTop;
    sections = {};
    url = document.URL.replace(/#.*$/, "");

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50
    });

    updateSideBarPosition(top, tocOffset, sections);

    $(window).scroll(function(event) {
        updateSideBarPosition(top, tocOffset, sections)
    });

    $(window).resize(function(event) {
        tocOffset = $('.related-wrapper').outerHeight();
        updateSideBarPosition(top, tocOffset, sections)
    });
});</script><script>var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-41920728-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();</script><body><div id=logo-banner><div class=logo><a href=../../index.html> <img alt="Nilearn logo"border=0 src=../../_static/nilearn-logo.png> </a></div><div class=tags><ul><li><big><a href=../decoding/plot_haxby_anova_svm.html>SVM</a></big></li><li><small><a href=../../connectivity/parcellating.html>Ward clustering</a></small></li><li><a href=../../decoding/searchlight.html>Searchlight</a></li><li><big><a href=../../connectivity/resting_state_networks.html>ICA</a></big></li><li><a href=../../manipulating_images/data_preparation.html>Nifti IO</a></li><li><a href=../../modules/reference.html#module-nilearn.datasets>Datasets</a></li></ul></div><div class=banner><h1>Nilearn:</h1><h2>Statistics for NeuroImaging in Python</h2></div><div class=search_form><div class=gcse-search id=cse style=width:100%></div><script>(function() {
        var cx = '017289614950330089114:elrt9qoutrq';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();</script></div></div><div class=related-wrapper><div aria-label="related navigation"class=related role=navigation><h3>Navigation</h3><ul><li class=right style=margin-right:10px><a title="Python Module Index"href=../../py-modindex.html>modules</a></li><li class=right><a title="9.8.8. NeuroVault cross-study ICA maps."accesskey=N href=plot_ica_neurovault.html>next</a> |</li><li class=right><a title="9.8.6. Massively univariate analysis of a motor task from the Localizer dataset"accesskey=P href=plot_localizer_mass_univariate_methods.html>previous</a> |</li><li><a href=../../index.html>Nilearn Home</a> | </li><li><a href=../../user_guide.html>User Guide</a> | </li><li><a href=../index.html>Examples</a> | </li><li><a href=../../modules/reference.html>Reference</a> | </li><li id=navbar-about><a href=../../authors.html>About</a>| </li><li><a href=../../glossary.html>Glossary</a>| </li><li><a href=../../bibliography.html>Bibliography</a>| </li><li id=navbar-ecosystem><a href=http://www.nipy.org/>Nipy ecosystem</a></li><li class="nav-item nav-item-1"><a href=../../user_guide.html>User guide: table of contents</a> »</li><li class="nav-item nav-item-2"><a accesskey=U href=../index.html><span class=section-number>9. </span>Nilearn usage examples</a> »</li><li class="nav-item nav-item-this"><a href>Nilearn: Statistical Analysis for NeuroImaging in Python</a></li></ul></div></div><div class=document><div class=documentwrapper><div class=bodywrapper><div class=body role=main><div class="sphx-glr-download-link-note admonition note"><p class=admonition-title>Note</p><p>Click <a class="reference internal"href=#sphx-glr-download-auto-examples-07-advanced-plot-surface-bids-analysis-py><span class="std std-ref">here</span></a> to download the full example code or to run this example in your browser via Binder</p></div><div class="sphx-glr-example-title section"id=surface-based-dataset-first-and-second-level-analysis-of-a-dataset><span id=sphx-glr-auto-examples-07-advanced-plot-surface-bids-analysis-py></span><h1><span class=section-number>9.8.7. </span>Surface-based dataset first and second level analysis of a dataset<a title="Permalink to this headline"class=headerlink href=#surface-based-dataset-first-and-second-level-analysis-of-a-dataset>¶</a></h1><p>Full step-by-step example of fitting a <a class="reference internal"href=../../glossary.html#term-GLM><span class="xref std std-term">GLM</span></a> (first and second level analysis) in a 10-subjects dataset and visualizing the results.</p><p>More specifically:</p><ol class="arabic simple"><li><p>Download an <a class="reference internal"href=../../glossary.html#term-fMRI><span class="xref std std-term">fMRI</span></a> <a class="reference internal"href=../../glossary.html#term-BIDS><span class="xref std std-term">BIDS</span></a> dataset with two language conditions to contrast.</p></li><li><p>Project the data to a standard mesh, fsaverage5, aka the Freesurfer template mesh downsampled to about 10k nodes per hemisphere.</p></li><li><p>Run the first level model objects.</p></li><li><p>Fit a second level model on the fitted first level models.</p></li></ol><p>Notice that in this case the preprocessed <a class="reference internal"href=../../glossary.html#term-BOLD><span class="xref std std-term">bold</span></a> images were already normalized to the same <a class="reference internal"href=../../glossary.html#term-MNI><span class="xref std std-term">MNI</span></a> space.</p><p>To run this example, you must launch IPython via <code class="docutils literal notranslate"><span class=pre>ipython</span>
<span class=pre>--matplotlib</span></code> in a terminal, or use the Jupyter notebook.</p><div class="contents local topic"id=contents><p class=topic-title><strong>Contents</strong></p><ul class=simple><li><p><a class="reference internal"href=#fetch-example-bids-dataset id=id1>Fetch example BIDS dataset</a></p></li><li><p><a class="reference internal"href=#obtain-automatically-firstlevelmodel-objects-and-fit-arguments id=id2>Obtain automatically FirstLevelModel objects and fit arguments</a></p></li><li><p><a class="reference internal"href=#group-study id=id3>Group study</a></p></li></ul></div><div class=section id=fetch-example-bids-dataset><h2><a class=toc-backref href=#id1><span class=section-number>9.8.7.1. </span>Fetch example BIDS dataset</a><a title="Permalink to this headline"class=headerlink href=#fetch-example-bids-dataset>¶</a></h2><p>We download a simplified <a class="reference internal"href=../../glossary.html#term-BIDS><span class="xref std std-term">BIDS</span></a> dataset made available for illustrative purposes. It contains only the necessary information to run a statistical analysis using Nilearn. The raw data subject folders only contain bold.json and events.tsv files, while the derivatives folder includes the preprocessed files preproc.nii and the confounds.tsv files.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn.datasets</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.datasets.fetch_language_localizer_demo_dataset.html#nilearn.datasets.fetch_language_localizer_demo_dataset title=nilearn.datasets.fetch_language_localizer_demo_dataset><span class=n>fetch_language_localizer_demo_dataset</span></a>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>data_dir</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>_</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.datasets.fetch_language_localizer_demo_dataset.html#nilearn.datasets.fetch_language_localizer_demo_dataset title=nilearn.datasets.fetch_language_localizer_demo_dataset><span class=n>fetch_language_localizer_demo_dataset</span></a><span class=p>()</span>
</pre></div></div><p>Here is the location of the dataset on disk.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=nb>print</span><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>data_dir</span></a><span class=p>)</span>
</pre></div></div><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>/home/nicolas/nilearn_data/fMRI-language-localizer-demo-dataset
</pre></div></div></div><div class=section id=obtain-automatically-firstlevelmodel-objects-and-fit-arguments><h2><a class=toc-backref href=#id2><span class=section-number>9.8.7.2. </span>Obtain automatically FirstLevelModel objects and fit arguments</a><a title="Permalink to this headline"class=headerlink href=#obtain-automatically-firstlevelmodel-objects-and-fit-arguments>¶</a></h2><p>From the dataset directory we automatically obtain the FirstLevelModel objects with their subject_id filled from the <a class="reference internal"href=../../glossary.html#term-BIDS><span class="xref std std-term">BIDS</span></a> dataset. Moreover, we obtain for each model a dictionary with run_imgs, events and confounder regressors since in this case a confounds.tsv file is available in the <a class="reference internal"href=../../glossary.html#term-BIDS><span class="xref std std-term">BIDS</span></a> dataset. To get the first level models we only have to specify the dataset directory and the task_label as specified in the file names.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn.glm.first_level</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.glm.first_level.first_level_from_bids.html#nilearn.glm.first_level.first_level_from_bids title=nilearn.glm.first_level.first_level_from_bids><span class=n>first_level_from_bids</span></a>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>task_label</span></a> <span class=o>=</span> <span class=s1>'languagelocalizer'</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>_</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>models_run_imgs</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>models_events</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>models_confounds</span></a> <span class=o>=</span> \
    <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.glm.first_level.first_level_from_bids.html#nilearn.glm.first_level.first_level_from_bids title=nilearn.glm.first_level.first_level_from_bids><span class=n>first_level_from_bids</span></a><span class=p>(</span>
        <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>data_dir</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>task_label</span></a><span class=p>,</span>
        <span class=n>img_filters</span><span class=o>=</span><span class=p>[(</span><span class=s1>'desc'</span><span class=p>,</span> <span class=s1>'preproc'</span><span class=p>)])</span>
</pre></div></div><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>/home/nicolas/GitRepos/nilearn-fork/nilearn/glm/first_level/first_level.py:945: UserWarning: SliceTimingRef not found in file /home/nicolas/nilearn_data/fMRI-language-localizer-demo-dataset/derivatives/sub-01/func/sub-01_task-languagelocalizer_desc-preproc_bold.json. It will be assumed that the slice timing reference is 0.0 percent of the repetition time. If it is not the case it will need to be set manually in the generated list of models
  warn('SliceTimingRef not found in file %s. It will be assumed'
</pre></div></div><p>We also need to get the TR information. For that we use the json sidecar file of the dataset’s functional images.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>import</span> <span class=nn>os</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>json_file</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"href=https://docs.python.org/3.8/library/os.path.html#os.path.join title=os.path.join><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>data_dir</span></a><span class=p>,</span> <span class=s1>'derivatives'</span><span class=p>,</span> <span class=s1>'sub-01'</span><span class=p>,</span> <span class=s1>'func'</span><span class=p>,</span>
                         <span class=s1>'sub-01_task-languagelocalizer_desc-preproc_bold.json'</span><span class=p>)</span>
<span class=kn>import</span> <span class=nn>json</span>
<span class=k>with</span> <span class=nb>open</span><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>json_file</span></a><span class=p>,</span> <span class=s1>'r'</span><span class=p>)</span> <span class=k>as</span> <a class="sphx-glr-backref-module-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/io.html#io.TextIOWrapper title=io.TextIOWrapper><span class=n>f</span></a><span class=p>:</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#float title=builtins.float><span class=n>t_r</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-json sphx-glr-backref-type-py-function"href=https://docs.python.org/3.8/library/json.html#json.load title=json.load><span class=n>json</span><span class=o>.</span><span class=n>load</span></a><span class=p>(</span><a class="sphx-glr-backref-module-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/io.html#io.TextIOWrapper title=io.TextIOWrapper><span class=n>f</span></a><span class=p>)[</span><span class=s1>'RepetitionTime'</span><span class=p>]</span>
</pre></div></div><p>Project fMRI data to the surface: First get fsaverage5.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn.datasets</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.datasets.fetch_surf_fsaverage.html#nilearn.datasets.fetch_surf_fsaverage title=nilearn.datasets.fetch_surf_fsaverage><span class=n>fetch_surf_fsaverage</span></a>
<a class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"href=https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch title=sklearn.utils.Bunch><span class=n>fsaverage</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.datasets.fetch_surf_fsaverage.html#nilearn.datasets.fetch_surf_fsaverage title=nilearn.datasets.fetch_surf_fsaverage><span class=n>fetch_surf_fsaverage</span></a><span class=p>(</span><span class=n>mesh</span><span class=o>=</span><span class=s1>'fsaverage5'</span><span class=p>)</span>
</pre></div></div><p>The projection function simply takes the fMRI data and the mesh. Note that those correspond spatially, as they are both in MNI space.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=kn>from</span> <span class=nn>nilearn</span> <span class=kn>import</span> <span class=n>surface</span>
<span class=kn>from</span> <span class=nn>nilearn.glm.first_level</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.glm.first_level.make_first_level_design_matrix.html#nilearn.glm.first_level.make_first_level_design_matrix title=nilearn.glm.first_level.make_first_level_design_matrix><span class=n>make_first_level_design_matrix</span></a>
<span class=kn>from</span> <span class=nn>nilearn.glm.first_level</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.glm.first_level.run_glm.html#nilearn.glm.first_level.run_glm title=nilearn.glm.first_level.run_glm><span class=n>run_glm</span></a>
<span class=kn>from</span> <span class=nn>nilearn.glm.contrasts</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-glm sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.glm.compute_contrast.html#nilearn.glm.compute_contrast title=nilearn.glm.compute_contrast><span class=n>compute_contrast</span></a>
</pre></div></div><p>Empty lists in which we are going to store activation values.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>z_scores_right</span></a> <span class=o>=</span> <span class=p>[]</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>z_scores_left</span></a> <span class=o>=</span> <span class=p>[]</span>
<span class=k>for</span> <span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>fmri_img</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>confound</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>events</span></a><span class=p>)</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span>
        <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>models_run_imgs</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>models_confounds</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>models_events</span></a><span class=p>):</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>texture</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-surface sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.surface.vol_to_surf.html#nilearn.surface.vol_to_surf title=nilearn.surface.vol_to_surf><span class=n>surface</span><span class=o>.</span><span class=n>vol_to_surf</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>fmri_img</span></a><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>fsaverage</span><span class=o>.</span><span class=n>pial_right</span></a><span class=p>)</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>n_scans</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#tuple title=builtins.tuple><span class=n>texture</span><span class=o>.</span><span class=n>shape</span></a><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>frame_times</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#float title=builtins.float><span class=n>t_r</span></a> <span class=o>*</span> <span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange title=numpy.arange><span class=n>np</span><span class=o>.</span><span class=n>arange</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>n_scans</span></a><span class=p>)</span> <span class=o>+</span> <span class=o>.</span><span class=mi>5</span><span class=p>)</span>

    <span class=c1># Create the design matrix</span>
    <span class=c1>#</span>
    <span class=c1># We specify an hrf model containing Glover model and its time derivative.</span>
    <span class=c1># The drift model is implicitly a cosine basis with period cutoff 128s.</span>
    <a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>design_matrix</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.glm.first_level.make_first_level_design_matrix.html#nilearn.glm.first_level.make_first_level_design_matrix title=nilearn.glm.first_level.make_first_level_design_matrix><span class=n>make_first_level_design_matrix</span></a><span class=p>(</span>
        <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>frame_times</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>events</span></a><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>events</span></a><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>hrf_model</span><span class=o>=</span><span class=s1>'glover + derivative'</span><span class=p>,</span>
        <span class=n>add_regs</span><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>confound</span></a><span class=p>[</span><span class=mi>0</span><span class=p>])</span>

    <span class=c1># Contrast specification</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>contrast_values</span></a> <span class=o>=</span> <span class=p>(</span><a class="sphx-glr-backref-module-pandas-core-indexes-base sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Index.html#pandas.Index title=pandas.core.indexes.base.Index><span class=n>design_matrix</span><span class=o>.</span><span class=n>columns</span></a> <span class=o>==</span> <span class=s1>'language'</span><span class=p>)</span> <span class=o>*</span> <span class=mf>1.0</span> <span class=o>-</span>\
                      <span class=p>(</span><a class="sphx-glr-backref-module-pandas-core-indexes-base sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Index.html#pandas.Index title=pandas.core.indexes.base.Index><span class=n>design_matrix</span><span class=o>.</span><span class=n>columns</span></a> <span class=o>==</span> <span class=s1>'string'</span><span class=p>)</span>

    <span class=c1># Setup and fit GLM.</span>
    <span class=c1># Note that the output consists in 2 variables: `labels` and `fit`</span>
    <span class=c1># `labels` tags voxels according to noise autocorrelation.</span>
    <span class=c1># `estimates` contains the parameter estimates.</span>
    <span class=c1># We input them for contrast computation.</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>labels</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>estimates</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.glm.first_level.run_glm.html#nilearn.glm.first_level.run_glm title=nilearn.glm.first_level.run_glm><span class=n>run_glm</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>texture</span><span class=o>.</span><span class=n>T</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-property"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.values.html#pandas.DataFrame.values title=pandas.DataFrame.values><span class=n>design_matrix</span><span class=o>.</span><span class=n>values</span></a><span class=p>)</span>
    <a class="sphx-glr-backref-module-nilearn-glm sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.glm.Contrast.html#nilearn.glm.Contrast title=nilearn.glm.Contrast><span class=n>contrast</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-glm sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.glm.compute_contrast.html#nilearn.glm.compute_contrast title=nilearn.glm.compute_contrast><span class=n>compute_contrast</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>labels</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>estimates</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>contrast_values</span></a><span class=p>,</span>
                                <span class=n>contrast_type</span><span class=o>=</span><span class=s1>'t'</span><span class=p>)</span>
    <span class=c1># We present the Z-transform of the t map.</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>z_score</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-glm sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.glm.Contrast.html#nilearn.glm.Contrast.z_score title=nilearn.glm.Contrast.z_score><span class=n>contrast</span><span class=o>.</span><span class=n>z_score</span></a><span class=p>()</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>z_scores_right</span></a><span class=o>.</span><span class=n>append</span><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>z_score</span></a><span class=p>)</span>

    <span class=c1># Do the left hemipshere exactly in the same way.</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>texture</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-surface sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.surface.vol_to_surf.html#nilearn.surface.vol_to_surf title=nilearn.surface.vol_to_surf><span class=n>surface</span><span class=o>.</span><span class=n>vol_to_surf</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>fmri_img</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>fsaverage</span><span class=o>.</span><span class=n>pial_left</span></a><span class=p>)</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>labels</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>estimates</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.glm.first_level.run_glm.html#nilearn.glm.first_level.run_glm title=nilearn.glm.first_level.run_glm><span class=n>run_glm</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>texture</span><span class=o>.</span><span class=n>T</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-property"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.values.html#pandas.DataFrame.values title=pandas.DataFrame.values><span class=n>design_matrix</span><span class=o>.</span><span class=n>values</span></a><span class=p>)</span>
    <a class="sphx-glr-backref-module-nilearn-glm sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.glm.Contrast.html#nilearn.glm.Contrast title=nilearn.glm.Contrast><span class=n>contrast</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-glm sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.glm.compute_contrast.html#nilearn.glm.compute_contrast title=nilearn.glm.compute_contrast><span class=n>compute_contrast</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>labels</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>estimates</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>contrast_values</span></a><span class=p>,</span>
                                <span class=n>contrast_type</span><span class=o>=</span><span class=s1>'t'</span><span class=p>)</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>z_scores_left</span></a><span class=o>.</span><span class=n>append</span><span class=p>(</span><a class="sphx-glr-backref-module-nilearn-glm sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.glm.Contrast.html#nilearn.glm.Contrast.z_score title=nilearn.glm.Contrast.z_score><span class=n>contrast</span><span class=o>.</span><span class=n>z_score</span></a><span class=p>())</span>
</pre></div></div><p>Individual activation maps have been accumulated in the z_score_left and az_scores_right lists respectively. We can now use them in a group study (one-sample study).</p></div><div class=section id=group-study><h2><a class=toc-backref href=#id3><span class=section-number>9.8.7.3. </span>Group study</a><a title="Permalink to this headline"class=headerlink href=#group-study>¶</a></h2><p>Prepare figure for concurrent plot of individual maps compute population-level maps for left and right hemisphere We directly do that on the value arrays.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-scipy-stats sphx-glr-backref-type-py-function"href=http://scipy.github.io/devdocs/reference/generated/scipy.stats.ttest_1samp.html#scipy.stats.ttest_1samp title=scipy.stats.ttest_1samp><span class=n>ttest_1samp</span></a><span class=p>,</span> <span class=n>norm</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>t_left</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>pval_left</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-scipy-stats sphx-glr-backref-type-py-function"href=http://scipy.github.io/devdocs/reference/generated/scipy.stats.ttest_1samp.html#scipy.stats.ttest_1samp title=scipy.stats.ttest_1samp><span class=n>ttest_1samp</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array title=numpy.array><span class=n>np</span><span class=o>.</span><span class=n>array</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>z_scores_left</span></a><span class=p>),</span> <span class=mi>0</span><span class=p>)</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>t_right</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>pval_right</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-scipy-stats sphx-glr-backref-type-py-function"href=http://scipy.github.io/devdocs/reference/generated/scipy.stats.ttest_1samp.html#scipy.stats.ttest_1samp title=scipy.stats.ttest_1samp><span class=n>ttest_1samp</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array title=numpy.array><span class=n>np</span><span class=o>.</span><span class=n>array</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>z_scores_right</span></a><span class=p>),</span> <span class=mi>0</span><span class=p>)</span>
</pre></div></div><p>What we have so far are p-values: we convert them to z-values for plotting.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>z_val_left</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-scipy-stats sphx-glr-backref-type-py-method"href=http://scipy.github.io/devdocs/reference/generated/scipy.stats.rv_continuous.isf.html#scipy.stats.rv_continuous.isf title=scipy.stats.rv_continuous.isf><span class=n>norm</span><span class=o>.</span><span class=n>isf</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>pval_left</span></a><span class=p>)</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>z_val_right</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-scipy-stats sphx-glr-backref-type-py-method"href=http://scipy.github.io/devdocs/reference/generated/scipy.stats.rv_continuous.isf.html#scipy.stats.rv_continuous.isf title=scipy.stats.rv_continuous.isf><span class=n>norm</span><span class=o>.</span><span class=n>isf</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>pval_right</span></a><span class=p>)</span>
</pre></div></div><p>Plot the resulting maps, at first on the left hemipshere.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn</span> <span class=kn>import</span> <span class=n>plotting</span>
<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_surf_stat_map.html#nilearn.plotting.plot_surf_stat_map title=nilearn.plotting.plot_surf_stat_map><span class=n>plotting</span><span class=o>.</span><span class=n>plot_surf_stat_map</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>fsaverage</span><span class=o>.</span><span class=n>infl_left</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>z_val_left</span></a><span class=p>,</span> <span class=n>hemi</span><span class=o>=</span><span class=s1>'left'</span><span class=p>,</span>
    <span class=n>title</span><span class=o>=</span><span class=s2>"language-string, left hemisphere"</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>threshold</span><span class=o>=</span><span class=mf>3.</span><span class=p>,</span> <span class=n>bg_map</span><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>fsaverage</span><span class=o>.</span><span class=n>sulc_left</span></a><span class=p>)</span>
</pre></div></div><img alt="language-string, left hemisphere"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_surface_bids_analysis_001.png><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>&LTFigure size 470x400 with 2 Axes>
</pre></div></div><p>Next, on the right hemisphere.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_surf_stat_map.html#nilearn.plotting.plot_surf_stat_map title=nilearn.plotting.plot_surf_stat_map><span class=n>plotting</span><span class=o>.</span><span class=n>plot_surf_stat_map</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>fsaverage</span><span class=o>.</span><span class=n>infl_right</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>z_val_left</span></a><span class=p>,</span> <span class=n>hemi</span><span class=o>=</span><span class=s1>'right'</span><span class=p>,</span>
    <span class=n>title</span><span class=o>=</span><span class=s2>"language-string, right hemisphere"</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>threshold</span><span class=o>=</span><span class=mf>3.</span><span class=p>,</span> <span class=n>bg_map</span><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>fsaverage</span><span class=o>.</span><span class=n>sulc_right</span></a><span class=p>)</span>

<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.show.html#nilearn.plotting.show title=nilearn.plotting.show><span class=n>plotting</span><span class=o>.</span><span class=n>show</span></a><span class=p>()</span>
</pre></div></div><img alt="language-string, right hemisphere"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_surface_bids_analysis_002.png><p class=sphx-glr-timing><strong>Total running time of the script:</strong> ( 2 minutes 7.338 seconds)</p><div class="sphx-glr-footer class sphx-glr-footer-example docutils container"id=sphx-glr-download-auto-examples-07-advanced-plot-surface-bids-analysis-py><div class="binder-badge docutils container"><a class="reference external image-reference"href=https://mybinder.org/v2/gh/nilearn/nilearn.github.io/main?filepath=examples/auto_examples/07_advanced/plot_surface_bids_analysis.ipynb><img alt="Launch binder"src=../../_images/binder_badge_logo6.svg width=150px></a></div><div class="sphx-glr-download sphx-glr-download-python docutils container"><p><a class="reference download internal"download href=../../_downloads/8e127caad0b44a1f573bdc738726019c/plot_surface_bids_analysis.py><code class="xref download docutils literal notranslate"><span class=pre>Download</span> <span class=pre>Python</span> <span class=pre>source</span> <span class=pre>code:</span> <span class=pre>plot_surface_bids_analysis.py</span></code></a></p></div><div class="sphx-glr-download sphx-glr-download-jupyter docutils container"><p><a class="reference download internal"download href=../../_downloads/8380b05284afb40d67222e0ee1b773fa/plot_surface_bids_analysis.ipynb><code class="xref download docutils literal notranslate"><span class=pre>Download</span> <span class=pre>Jupyter</span> <span class=pre>notebook:</span> <span class=pre>plot_surface_bids_analysis.ipynb</span></code></a></p></div></div><p class=sphx-glr-signature><a class="reference external"href=https://sphinx-gallery.github.io>Gallery generated by Sphinx-Gallery</a></p></div></div><div class=clearer></div></div></div></div><div aria-label="main navigation"class=sphinxsidebar role=navigation><div class=sphinxsidebarwrapper><h4>Giving credit</h4><ul class=simple><li><p>Please consider <a href=../../authors.html#citing>citing the papers</a>.</p></li></ul><h3><a href=../../index.html>Table of Contents</a></h3><ul><li><a class="reference internal"href=#>9.8.7. Surface-based dataset first and second level analysis of a dataset</a><ul><li><a class="reference internal"href=#fetch-example-bids-dataset>9.8.7.1. Fetch example BIDS dataset</a></li><li><a class="reference internal"href=#obtain-automatically-firstlevelmodel-objects-and-fit-arguments>9.8.7.2. Obtain automatically FirstLevelModel objects and fit arguments</a></li><li><a class="reference internal"href=#group-study>9.8.7.3. Group study</a></li></ul></li></ul><h4>Previous topic</h4><p class=topless><a title="previous chapter"href=plot_localizer_mass_univariate_methods.html><span class=section-number>9.8.6. </span>Massively univariate analysis of a motor task from the Localizer dataset</a></p><h4>Next topic</h4><p class=topless><a title="next chapter"href=plot_ica_neurovault.html><span class=section-number>9.8.8. </span>NeuroVault cross-study ICA maps.</a></p><div id=searchbox role=search style=display:none><h3 id=searchlabel>Quick search</h3><div class=searchformwrapper><form action=../../search.html class=search><input aria-labelledby=searchlabel name=q><input type=submit value=Go></form></div></div><script>$('#searchbox').show(0);</script></div></div><div class=clearer></div></div><div class=footer>© The nilearn developers 2010-2021. Created using <a href=http://sphinx.pocoo.org/>Sphinx</a> 4.0.2. <span style=padding-left:5ex> <a href=../../_sources/auto_examples/07_advanced/plot_surface_bids_analysis.rst.txt rel=nofollow>Show this page source</a> </span></div></body></html>