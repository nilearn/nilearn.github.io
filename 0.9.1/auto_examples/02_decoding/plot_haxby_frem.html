<!doctypehtml><html lang=en><meta charset=utf-8><meta content=width=device-width,initial-scale=1.0 name=viewport><meta content="9.3.3. Decoding with FREM: face vs house object recognition"property=og:title><meta content=website property=og:type><meta content=https://nilearn.github.io/auto_examples/02_decoding/plot_haxby_frem.html property=og:url><meta content=Nilearn property=og:site_name><meta content="This example uses fast ensembling of regularized models (FREM) to decode a face vs house discrimination task from Haxby 2001 study. FREM uses an implicit spatial regularization through fast cluster..."property=og:description><meta content=https://nilearn.github.io/_static/nilearn-logo.png property=og:image><meta content=Nilearn property=og:image:alt><title>Nilearn: Statistical Analysis for NeuroImaging in Python — Machine learning for NeuroImaging</title><link href=../../_static/pygments.css rel=stylesheet><link href=../../_static/nature.css rel=stylesheet><link href=../../_static/copybutton.css rel=stylesheet><link href=../../_static/sg_gallery.css rel=stylesheet><link href=../../_static/sg_gallery-binder.css rel=stylesheet><link href=../../_static/sg_gallery-dataframe.css rel=stylesheet><link href=../../_static/sg_gallery-rendered-html.css rel=stylesheet><script data-url_root=../../ id=documentation_options src=../../_static/documentation_options.js></script><script src=../../_static/jquery.js></script><script src=../../_static/underscore.js></script><script src=../../_static/doctools.js></script><script src=../../_static/clipboard.min.js></script><script src=../../_static/copybutton.js></script><link rel="shortcut icon"href=../../_static/favicon.ico><link href=../../search.html rel=search title=Search><link title="9.3.4. Voxel-Based Morphometry on Oasis dataset with Space-Net prior"href=plot_oasis_vbm_space_net.html rel=next><link title="9.3.2. FREM on Jimura et al “mixed gambles” dataset."href=plot_mixed_gambles_frem.html rel=prev><meta content=True name=HandheldFriendly><meta content=width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0 name=viewport><meta content="nilearn, neuroimaging, python, neuroscience, machinelearning"name=keywords><script>function updateTopMenuPosition(height, width) {
    if($(window).scrollTop() > height && $(window).outerWidth() > 1024) {
        //begin to scroll
        $('.related-wrapper').css("z-index", 1000);
        $('.related-wrapper').css("position", "sticky");
        $('.related-wrapper').css("top", 0);
        $('.related-wrapper').css("width", width)
    } else {
        //lock it back into place
        $('.related-wrapper').css("position", "relative");
        $('.related-wrapper').css("top", 0)
    }
}

$(function() {
    var banner_height = $('#logo-banner').outerHeight();
    var banner_width = $('#logo-banner').outerWidth();
    var width = $('.related-wrapper').css("height", $('.related').outerHeight());

    updateTopMenuPosition(banner_height, width);

    $(window).scroll(function(event) {
        updateTopMenuPosition(banner_height, width)
    });

    $(window).resize(function(event) {
        var banner_width = $('#logo-banner').outerWidth();
        var menu_height = $('.related').outerHeight();
        $('.related').css("width", banner_width);
        $('.related-wrapper').css("height", menu_height);
        updateTopMenuPosition(banner_height, width)
    })
});</script><script>function updateSideBarPosition(top, offset, sections) {
    var pos = $(window).scrollTop();
    // Lock the table of content to a fixed position once we scroll enough
    var topShift = 2 * offset;
    if(pos > top + topShift + 1) {
        // begin to scroll with sticky menu bar
        var topShift = -topShift + 1;
        if ($(window).outerWidth() < 1024) {
            // compensate top menu that disappears
            topShift -= offset + 1
        }
        $('.sphinxsidebarwrapper').css("position", "fixed");
        $('.sphinxsidebarwrapper').css("top", topShift)
    }
    else {
        //lock it back into place
        $('.sphinxsidebarwrapper').css("position", "relative");
        $('.sphinxsidebarwrapper').css("top",0)
    }

    // Highlight the current section
    i = 0;
    current_section = 0;
    $('a.internal').removeClass('active');
    for(i in sections) {
        if(sections[i] > pos) {
            break
        }
        if($('a.internal[href$="' + i + '"]').is(':visible')){
            current_section = i
        }
    }
    $('a.internal[href$="' + current_section + '"]').addClass('active');
    $('a.internal[href$="' + current_section + '"]').parent().addClass('active')
}

$(function () {
    // Lock the table of content to a fixed position once we scroll enough
    var tocOffset = $('.related-wrapper').outerHeight();
    var marginTop = parseFloat($('.sphinxsidebarwrapper').css('margin-top').replace(/auto/, 0));
    var top = $('.sphinxsidebarwrapper').offset().top - marginTop;
    sections = {};
    url = document.URL.replace(/#.*$/, "");

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50
    });

    updateSideBarPosition(top, tocOffset, sections);

    $(window).scroll(function(event) {
        updateSideBarPosition(top, tocOffset, sections)
    });

    $(window).resize(function(event) {
        tocOffset = $('.related-wrapper').outerHeight();
        updateSideBarPosition(top, tocOffset, sections)
    });
});</script><script>var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-41920728-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();</script><body><div id=logo-banner><div class=logo><a href=../../index.html> <img alt="Nilearn logo"border=0 src=../../_static/nilearn-logo.png> </a></div><div class=tags><ul><li><big><a href=../decoding/plot_haxby_anova_svm.html>SVM</a></big></li><li><small><a href=../../connectivity/parcellating.html>Ward clustering</a></small></li><li><a href=../../decoding/searchlight.html>Searchlight</a></li><li><big><a href=../../connectivity/resting_state_networks.html>ICA</a></big></li><li><a href=../../manipulating_images/data_preparation.html>Nifti IO</a></li><li><a href=../../modules/reference.html#module-nilearn.datasets>Datasets</a></li></ul></div><div class=banner><h1>Nilearn:</h1><h2>Statistics for NeuroImaging in Python</h2></div><div class=search_form><div class=gcse-search id=cse style=width:100%></div><script>(function() {
        var cx = '017289614950330089114:elrt9qoutrq';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();</script></div></div><div class=related-wrapper><div aria-label="related navigation"class=related role=navigation><h3>Navigation</h3><ul><li class=right style=margin-right:10px><a title="Python Module Index"href=../../py-modindex.html>modules</a></li><li class=right><a title="9.3.4. Voxel-Based Morphometry on Oasis dataset with Space-Net prior"accesskey=N href=plot_oasis_vbm_space_net.html>next</a> |</li><li class=right><a title="9.3.2. FREM on Jimura et al “mixed gambles” dataset."accesskey=P href=plot_mixed_gambles_frem.html>previous</a> |</li><li><a href=../../index.html>Nilearn Home</a> | </li><li><a href=../../user_guide.html>User Guide</a> | </li><li><a href=../index.html>Examples</a> | </li><li><a href=../../modules/reference.html>Reference</a> | </li><li id=navbar-about><a href=../../authors.html>About</a>| </li><li><a href=../../glossary.html>Glossary</a>| </li><li><a href=../../bibliography.html>Bibliography</a>| </li><li id=navbar-ecosystem><a href=http://www.nipy.org/>Nipy ecosystem</a></li><li class="nav-item nav-item-1"><a href=../../user_guide.html>User guide: table of contents</a> »</li><li class="nav-item nav-item-2"><a accesskey=U href=../index.html><span class=section-number>9. </span>Nilearn usage examples</a> »</li><li class="nav-item nav-item-this"><a href>Nilearn: Statistical Analysis for NeuroImaging in Python</a></li></ul></div></div><div class=stable-banner>This is the <em>stable</em> documentation for the latest release of Nilearn, the current development version is available <a href=https://nilearn.github.io/dev/index.html>here</a>.</div><div class=document><div class=documentwrapper><div class=bodywrapper><div class=body role=main><div class="sphx-glr-download-link-note admonition note"><p class=admonition-title>Note</p><p>Click <a class="reference internal"href=#sphx-glr-download-auto-examples-02-decoding-plot-haxby-frem-py><span class="std std-ref">here</span></a> to download the full example code or to run this example in your browser via Binder</p></div><div class="sphx-glr-example-title section"id=decoding-with-frem-face-vs-house-object-recognition><span id=sphx-glr-auto-examples-02-decoding-plot-haxby-frem-py></span><h1><span class=section-number>9.3.3. </span>Decoding with FREM: face vs house object recognition<a title="Permalink to this headline"class=headerlink href=#decoding-with-frem-face-vs-house-object-recognition>¶</a></h1><p>This example uses fast ensembling of regularized models (FREM) to decode a face vs house discrimination task from Haxby 2001 study. FREM uses an implicit spatial regularization through fast clustering and aggregates a high number of estimators trained on various splits of the training set, thus returning a very robust decoder at a lower computational cost than other spatially regularized methods.</p><p>To have more details, see: <a class="reference internal"href=../../decoding/frem.html#frem><span class="std std-ref">FREM: fast ensembling of regularized models for robust decoding</span></a>.</p><div class=section id=load-the-haxby-dataset><h2><span class=section-number>9.3.3.1. </span>Load the Haxby dataset<a title="Permalink to this headline"class=headerlink href=#load-the-haxby-dataset>¶</a></h2><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn.datasets</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.datasets.fetch_haxby.html#nilearn.datasets.fetch_haxby title=nilearn.datasets.fetch_haxby><span class=n>fetch_haxby</span></a>
<a class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"href=https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch title=sklearn.utils.Bunch><span class=n>data_files</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.datasets.fetch_haxby.html#nilearn.datasets.fetch_haxby title=nilearn.datasets.fetch_haxby><span class=n>fetch_haxby</span></a><span class=p>()</span>

<span class=c1># Load behavioral data</span>
<span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
<a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>behavioral</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-function"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html#pandas.read_csv title=pandas.read_csv><span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>data_files</span><span class=o>.</span><span class=n>session_target</span></a><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>sep</span><span class=o>=</span><span class=s2>" "</span><span class=p>)</span>

<span class=c1># Restrict to face and house conditions</span>
<a class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series title=pandas.core.series.Series><span class=n>conditions</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>behavioral</span></a><span class=p>[</span><span class=s1>'labels'</span><span class=p>]</span>
<a class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series title=pandas.core.series.Series><span class=n>condition_mask</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-method"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.isin.html#pandas.Series.isin title=pandas.Series.isin><span class=n>conditions</span><span class=o>.</span><span class=n>isin</span></a><span class=p>([</span><span class=s1>'face'</span><span class=p>,</span> <span class=s1>'house'</span><span class=p>])</span>

<span class=c1># Split data into train and test samples, using the chunks</span>
<a class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series title=pandas.core.series.Series><span class=n>condition_mask_train</span></a> <span class=o>=</span> <span class=p>(</span><a class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series title=pandas.core.series.Series><span class=n>condition_mask</span></a><span class=p>)</span> <span class=o>&</span> <span class=p>(</span><a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>behavioral</span></a><span class=p>[</span><span class=s1>'chunks'</span><span class=p>]</span> <span class=o><=</span> <span class=mi>6</span><span class=p>)</span>
<a class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series title=pandas.core.series.Series><span class=n>condition_mask_test</span></a> <span class=o>=</span> <span class=p>(</span><a class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series title=pandas.core.series.Series><span class=n>condition_mask</span></a><span class=p>)</span> <span class=o>&</span> <span class=p>(</span><a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>behavioral</span></a><span class=p>[</span><span class=s1>'chunks'</span><span class=p>]</span> <span class=o>></span> <span class=mi>6</span><span class=p>)</span>

<span class=c1># Apply this sample mask to X (fMRI data) and y (behavioral labels)</span>
<span class=c1># Because the data is in one single large 4D image, we need to use</span>
<span class=c1># index_img to do the split easily</span>
<span class=kn>from</span> <span class=nn>nilearn.image</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.index_img.html#nilearn.image.index_img title=nilearn.image.index_img><span class=n>index_img</span></a>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>func_filenames</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>data_files</span><span class=o>.</span><span class=n>func</span></a><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>X_train</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.index_img.html#nilearn.image.index_img title=nilearn.image.index_img><span class=n>index_img</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>func_filenames</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series title=pandas.core.series.Series><span class=n>condition_mask_train</span></a><span class=p>)</span>
<a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>X_test</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.index_img.html#nilearn.image.index_img title=nilearn.image.index_img><span class=n>index_img</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>func_filenames</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series title=pandas.core.series.Series><span class=n>condition_mask_test</span></a><span class=p>)</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>y_train</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series title=pandas.core.series.Series><span class=n>conditions</span></a><span class=p>[</span><a class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series title=pandas.core.series.Series><span class=n>condition_mask_train</span></a><span class=p>]</span><span class=o>.</span><span class=n>values</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>y_test</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series title=pandas.core.series.Series><span class=n>conditions</span></a><span class=p>[</span><a class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series title=pandas.core.series.Series><span class=n>condition_mask_test</span></a><span class=p>]</span><span class=o>.</span><span class=n>values</span>


<span class=c1># Compute the mean epi to be used for the background of the plotting</span>
<span class=kn>from</span> <span class=nn>nilearn.image</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.mean_img.html#nilearn.image.mean_img title=nilearn.image.mean_img><span class=n>mean_img</span></a>
<a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>background_img</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.mean_img.html#nilearn.image.mean_img title=nilearn.image.mean_img><span class=n>mean_img</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>func_filenames</span></a><span class=p>)</span>
</pre></div></div></div><div class=section id=fit-frem><h2><span class=section-number>9.3.3.2. </span>Fit FREM<a title="Permalink to this headline"class=headerlink href=#fit-frem>¶</a></h2><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn.decoding</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-decoding sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.decoding.FREMClassifier.html#nilearn.decoding.FREMClassifier title=nilearn.decoding.FREMClassifier><span class=n>FREMClassifier</span></a>
<a class="sphx-glr-backref-module-nilearn-decoding sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.decoding.FREMClassifier.html#nilearn.decoding.FREMClassifier title=nilearn.decoding.FREMClassifier><span class=n>decoder</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-decoding sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.decoding.FREMClassifier.html#nilearn.decoding.FREMClassifier title=nilearn.decoding.FREMClassifier><span class=n>FREMClassifier</span></a><span class=p>(</span><span class=n>cv</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
<span class=c1># Fit model on train data and predict on test data</span>
<a class="sphx-glr-backref-module-nilearn-decoding sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.decoding.FREMClassifier.html#nilearn.decoding.FREMClassifier.fit title=nilearn.decoding.FREMClassifier.fit><span class=n>decoder</span><span class=o>.</span><span class=n>fit</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>X_train</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>y_train</span></a><span class=p>)</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>y_pred</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-decoding sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.decoding.FREMClassifier.html#nilearn.decoding.FREMClassifier.predict title=nilearn.decoding.FREMClassifier.predict><span class=n>decoder</span><span class=o>.</span><span class=n>predict</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>X_test</span></a><span class=p>)</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>accuracy</span></a> <span class=o>=</span> <span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>y_pred</span></a> <span class=o>==</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>y_test</span></a><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>*</span> <span class=mf>100.</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>"FREM classification accuracy : </span><span class=si>%g%%</span><span class=s2>"</span> <span class=o>%</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>accuracy</span></a><span class=p>)</span>
</pre></div></div><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>/home/nicolas/GitRepos/nilearn-fork/nilearn/_utils/param_validation.py:197: UserWarning:

Brain mask is bigger than the volume of a standard human brain. This object is probably not tuned to be used on such data.

/home/nicolas/GitRepos/scikit-learn-fork/sklearn/feature_selection/_univariate_selection.py:112: UserWarning:

Features [10420] are constant.

/home/nicolas/GitRepos/scikit-learn-fork/sklearn/feature_selection/_univariate_selection.py:113: RuntimeWarning:

invalid value encountered in true_divide

FREM classification accuracy : 64.4444%
</pre></div></div></div><div class=section id=visualization-of-frem-weights><h2><span class=section-number>9.3.3.3. </span>Visualization of FREM weights<a title="Permalink to this headline"class=headerlink href=#visualization-of-frem-weights>¶</a></h2><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn</span> <span class=kn>import</span> <span class=n>plotting</span>
<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map title=nilearn.plotting.plot_stat_map><span class=n>plotting</span><span class=o>.</span><span class=n>plot_stat_map</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>decoder</span><span class=o>.</span><span class=n>coef_img_</span></a><span class=p>[</span><span class=s2>"face"</span><span class=p>],</span> <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>background_img</span></a><span class=p>,</span>
                       <span class=n>title</span><span class=o>=</span><span class=s2>"FREM: accuracy </span><span class=si>%g%%</span><span class=s2>, 'face coefs'"</span> <span class=o>%</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>accuracy</span></a><span class=p>,</span>
                       <span class=n>cut_coords</span><span class=o>=</span><span class=p>(</span><span class=o>-</span><span class=mi>52</span><span class=p>,</span> <span class=o>-</span><span class=mi>5</span><span class=p>),</span> <span class=n>display_mode</span><span class=o>=</span><span class=s2>"yz"</span><span class=p>)</span>
<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.show.html#nilearn.plotting.show title=nilearn.plotting.show><span class=n>plotting</span><span class=o>.</span><span class=n>show</span></a><span class=p>()</span>
</pre></div></div><img alt="plot haxby frem"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_haxby_frem_001.png srcset=../../_images/sphx_glr_plot_haxby_frem_001.png><p>FREM ensembling procedure yields an important improvement of decoding accuracy on this simple example compared to fitting only one model per fold and the clustering mechanism keeps its computational cost reasonable even on heavier examples. Here we ensembled several instances of l2-SVC, but FREMClassifier also works with ridge or logistic. FREMRegressor object is also available to solve regression problems.</p><p class=sphx-glr-timing><strong>Total running time of the script:</strong> ( 1 minutes 44.908 seconds)</p><p><strong>Estimated memory usage:</strong> 1372 MB</p><div class="sphx-glr-footer class sphx-glr-footer-example docutils container"id=sphx-glr-download-auto-examples-02-decoding-plot-haxby-frem-py><div class="binder-badge docutils container"><a class="reference external image-reference"href=https://mybinder.org/v2/gh/nilearn/nilearn.github.io/main?filepath=examples/auto_examples/02_decoding/plot_haxby_frem.ipynb><img alt="Launch binder"src=../../_images/binder_badge_logo1.svg width=150px></a></div><div class="sphx-glr-download sphx-glr-download-python docutils container"><p><a class="reference download internal"download href=../../_downloads/657e41c76ef71bc1ef42b9a30cc2883e/plot_haxby_frem.py><code class="xref download docutils literal notranslate"><span class=pre>Download</span> <span class=pre>Python</span> <span class=pre>source</span> <span class=pre>code:</span> <span class=pre>plot_haxby_frem.py</span></code></a></p></div><div class="sphx-glr-download sphx-glr-download-jupyter docutils container"><p><a class="reference download internal"download href=../../_downloads/fccef32eff02137e275b4a443f20b234/plot_haxby_frem.ipynb><code class="xref download docutils literal notranslate"><span class=pre>Download</span> <span class=pre>Jupyter</span> <span class=pre>notebook:</span> <span class=pre>plot_haxby_frem.ipynb</span></code></a></p></div></div><p class=sphx-glr-signature><a class="reference external"href=https://sphinx-gallery.github.io>Gallery generated by Sphinx-Gallery</a></p></div></div><div class=clearer></div></div></div></div><div aria-label="main navigation"class=sphinxsidebar role=navigation><div class=sphinxsidebarwrapper><h4>Giving credit</h4><ul class=simple><li><p>Please consider <a href=../../authors.html#citing>citing the papers</a>.</p></li></ul><h3><a href=../../index.html>Table of Contents</a></h3><ul><li><a class="reference internal"href=#>9.3.3. Decoding with FREM: face vs house object recognition</a><ul><li><a class="reference internal"href=#load-the-haxby-dataset>9.3.3.1. Load the Haxby dataset</a></li><li><a class="reference internal"href=#fit-frem>9.3.3.2. Fit FREM</a></li><li><a class="reference internal"href=#visualization-of-frem-weights>9.3.3.3. Visualization of FREM weights</a></li></ul></li></ul><h4>Previous topic</h4><p class=topless><a title="previous chapter"href=plot_mixed_gambles_frem.html><span class=section-number>9.3.2. </span>FREM on Jimura et al “mixed gambles” dataset.</a></p><h4>Next topic</h4><p class=topless><a title="next chapter"href=plot_oasis_vbm_space_net.html><span class=section-number>9.3.4. </span>Voxel-Based Morphometry on Oasis dataset with Space-Net prior</a></p><div id=searchbox role=search style=display:none><h3 id=searchlabel>Quick search</h3><div class=searchformwrapper><form action=../../search.html class=search><input aria-labelledby=searchlabel name=q><input type=submit value=Go></form></div></div><script>$('#searchbox').show(0);</script></div></div><div class=clearer></div></div><div class=footer>© The nilearn developers 2010-2022. Created using <a href=http://sphinx.pocoo.org/>Sphinx</a> 4.0.2. <span style=padding-left:5ex> <a href=../../_sources/auto_examples/02_decoding/plot_haxby_frem.rst.txt rel=nofollow>Show this page source</a> </span></div></body></html>