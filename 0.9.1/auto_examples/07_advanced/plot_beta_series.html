<!doctypehtml><html lang=en><meta charset=utf-8><meta content=width=device-width,initial-scale=1.0 name=viewport><meta content="9.8.11. Beta-Series Modeling for Task-Based Functional Connectivity and Decoding"property=og:title><meta content=website property=og:type><meta content=https://nilearn.github.io/auto_examples/07_advanced/plot_beta_series.html property=og:url><meta content=Nilearn property=og:site_name><meta content="This example shows how to run beta series GLM models, which are a common modeling approach for a variety of analyses of task-based fMRI data with an event-related task design, including functional ..."property=og:description><meta content=https://nilearn.github.io/_static/nilearn-logo.png property=og:image><meta content=Nilearn property=og:image:alt><title>Nilearn: Statistical Analysis for NeuroImaging in Python — Machine learning for NeuroImaging</title><link href=../../_static/pygments.css rel=stylesheet><link href=../../_static/nature.css rel=stylesheet><link href=../../_static/copybutton.css rel=stylesheet><link href=../../_static/sg_gallery.css rel=stylesheet><link href=../../_static/sg_gallery-binder.css rel=stylesheet><link href=../../_static/sg_gallery-dataframe.css rel=stylesheet><link href=../../_static/sg_gallery-rendered-html.css rel=stylesheet><script data-url_root=../../ id=documentation_options src=../../_static/documentation_options.js></script><script src=../../_static/jquery.js></script><script src=../../_static/underscore.js></script><script src=../../_static/doctools.js></script><script src=../../_static/clipboard.min.js></script><script src=../../_static/copybutton.js></script><link rel="shortcut icon"href=../../_static/favicon.ico><link href=../../search.html rel=search title=Search><link title="What’s new"href=../../changes/whats_new.html rel=next><link title="9.8.10. Advanced decoding using scikit learn"href=plot_advanced_decoding_scikit.html rel=prev><meta content=True name=HandheldFriendly><meta content=width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0 name=viewport><meta content="nilearn, neuroimaging, python, neuroscience, machinelearning"name=keywords><script>function updateTopMenuPosition(height, width) {
    if($(window).scrollTop() > height && $(window).outerWidth() > 1024) {
        //begin to scroll
        $('.related-wrapper').css("z-index", 1000);
        $('.related-wrapper').css("position", "sticky");
        $('.related-wrapper').css("top", 0);
        $('.related-wrapper').css("width", width)
    } else {
        //lock it back into place
        $('.related-wrapper').css("position", "relative");
        $('.related-wrapper').css("top", 0)
    }
}

$(function() {
    var banner_height = $('#logo-banner').outerHeight();
    var banner_width = $('#logo-banner').outerWidth();
    var width = $('.related-wrapper').css("height", $('.related').outerHeight());

    updateTopMenuPosition(banner_height, width);

    $(window).scroll(function(event) {
        updateTopMenuPosition(banner_height, width)
    });

    $(window).resize(function(event) {
        var banner_width = $('#logo-banner').outerWidth();
        var menu_height = $('.related').outerHeight();
        $('.related').css("width", banner_width);
        $('.related-wrapper').css("height", menu_height);
        updateTopMenuPosition(banner_height, width)
    })
});</script><script>function updateSideBarPosition(top, offset, sections) {
    var pos = $(window).scrollTop();
    // Lock the table of content to a fixed position once we scroll enough
    var topShift = 2 * offset;
    if(pos > top + topShift + 1) {
        // begin to scroll with sticky menu bar
        var topShift = -topShift + 1;
        if ($(window).outerWidth() < 1024) {
            // compensate top menu that disappears
            topShift -= offset + 1
        }
        $('.sphinxsidebarwrapper').css("position", "fixed");
        $('.sphinxsidebarwrapper').css("top", topShift)
    }
    else {
        //lock it back into place
        $('.sphinxsidebarwrapper').css("position", "relative");
        $('.sphinxsidebarwrapper').css("top",0)
    }

    // Highlight the current section
    i = 0;
    current_section = 0;
    $('a.internal').removeClass('active');
    for(i in sections) {
        if(sections[i] > pos) {
            break
        }
        if($('a.internal[href$="' + i + '"]').is(':visible')){
            current_section = i
        }
    }
    $('a.internal[href$="' + current_section + '"]').addClass('active');
    $('a.internal[href$="' + current_section + '"]').parent().addClass('active')
}

$(function () {
    // Lock the table of content to a fixed position once we scroll enough
    var tocOffset = $('.related-wrapper').outerHeight();
    var marginTop = parseFloat($('.sphinxsidebarwrapper').css('margin-top').replace(/auto/, 0));
    var top = $('.sphinxsidebarwrapper').offset().top - marginTop;
    sections = {};
    url = document.URL.replace(/#.*$/, "");

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50
    });

    updateSideBarPosition(top, tocOffset, sections);

    $(window).scroll(function(event) {
        updateSideBarPosition(top, tocOffset, sections)
    });

    $(window).resize(function(event) {
        tocOffset = $('.related-wrapper').outerHeight();
        updateSideBarPosition(top, tocOffset, sections)
    });
});</script><script>var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-41920728-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();</script><body><div id=logo-banner><div class=logo><a href=../../index.html> <img alt="Nilearn logo"border=0 src=../../_static/nilearn-logo.png> </a></div><div class=tags><ul><li><big><a href=../decoding/plot_haxby_anova_svm.html>SVM</a></big></li><li><small><a href=../../connectivity/parcellating.html>Ward clustering</a></small></li><li><a href=../../decoding/searchlight.html>Searchlight</a></li><li><big><a href=../../connectivity/resting_state_networks.html>ICA</a></big></li><li><a href=../../manipulating_images/data_preparation.html>Nifti IO</a></li><li><a href=../../modules/reference.html#module-nilearn.datasets>Datasets</a></li></ul></div><div class=banner><h1>Nilearn:</h1><h2>Statistics for NeuroImaging in Python</h2></div><div class=search_form><div class=gcse-search id=cse style=width:100%></div><script>(function() {
        var cx = '017289614950330089114:elrt9qoutrq';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();</script></div></div><div class=related-wrapper><div aria-label="related navigation"class=related role=navigation><h3>Navigation</h3><ul><li class=right style=margin-right:10px><a title="Python Module Index"href=../../py-modindex.html>modules</a></li><li class=right><a title="What’s new"accesskey=N href=../../changes/whats_new.html>next</a> |</li><li class=right><a title="9.8.10. Advanced decoding using scikit learn"accesskey=P href=plot_advanced_decoding_scikit.html>previous</a> |</li><li><a href=../../index.html>Nilearn Home</a> | </li><li><a href=../../user_guide.html>User Guide</a> | </li><li><a href=../index.html>Examples</a> | </li><li><a href=../../modules/reference.html>Reference</a> | </li><li id=navbar-about><a href=../../authors.html>About</a>| </li><li><a href=../../glossary.html>Glossary</a>| </li><li><a href=../../bibliography.html>Bibliography</a>| </li><li id=navbar-ecosystem><a href=http://www.nipy.org/>Nipy ecosystem</a></li><li class="nav-item nav-item-1"><a href=../../user_guide.html>User guide: table of contents</a> »</li><li class="nav-item nav-item-2"><a accesskey=U href=../index.html><span class=section-number>9. </span>Nilearn usage examples</a> »</li><li class="nav-item nav-item-this"><a href>Nilearn: Statistical Analysis for NeuroImaging in Python</a></li></ul></div></div><div class=stable-banner>This is the <em>stable</em> documentation for the latest release of Nilearn, the current development version is available <a href=https://nilearn.github.io/dev/index.html>here</a>.</div><div class=document><div class=documentwrapper><div class=bodywrapper><div class=body role=main><div class="sphx-glr-download-link-note admonition note"><p class=admonition-title>Note</p><p>Click <a class="reference internal"href=#sphx-glr-download-auto-examples-07-advanced-plot-beta-series-py><span class="std std-ref">here</span></a> to download the full example code or to run this example in your browser via Binder</p></div><div class="sphx-glr-example-title section"id=beta-series-modeling-for-task-based-functional-connectivity-and-decoding><span id=sphx-glr-auto-examples-07-advanced-plot-beta-series-py></span><h1><span class=section-number>9.8.11. </span>Beta-Series Modeling for Task-Based Functional Connectivity and Decoding<a title="Permalink to this headline"class=headerlink href=#beta-series-modeling-for-task-based-functional-connectivity-and-decoding>¶</a></h1><p>This example shows how to run beta series <a class="reference internal"href=../../glossary.html#term-GLM><span class="xref std std-term">GLM</span></a> models, which are a common modeling approach for a variety of analyses of task-based <a class="reference internal"href=../../glossary.html#term-fMRI><span class="xref std std-term">fMRI</span></a> data with an event-related task design, including <a class="reference internal"href=../../glossary.html#term-functional-connectivity><span class="xref std std-term">functional connectivity</span></a>, <a class="reference internal"href=../../glossary.html#term-Decoding><span class="xref std std-term">decoding</span></a>, and representational similarity analysis.</p><p>Beta series models fit trial-wise conditions, which allow users to create “time series” of these trial-wise maps, which can be substituted for the typical time series used in resting-state functional connectivity analyses. Generally, these models are most useful for event-related task designs, while other modeling approaches, such as psychophysiological interactions (PPIs), tend to perform better in block designs, depending on the type of analysis. See Cisler <em>et al.</em> <a class="footnote-reference brackets"href=#cisler2014comparison id=id1>1</a> for more information about this, in the context of functional connectivity analyses.</p><p>Two of the most well-known beta series modeling methods are Least Squares- All (LSA) <a class="footnote-reference brackets"href=#rissman2004measuring id=id2>2</a> and Least Squares- Separate (LSS) <a class="footnote-reference brackets"href=#mumford2012deconvolving id=id3>3</a><a class="footnote-reference brackets"href=#turner2012spatiotemporal id=id4>4</a>. In LSA, a single <a class="reference internal"href=../../glossary.html#term-GLM><span class="xref std std-term">GLM</span></a> is run, in which each trial of each condition of interest is separated out into its own condition within the design matrix. In LSS, each trial of each condition of interest has its own <a class="reference internal"href=../../glossary.html#term-GLM><span class="xref std std-term">GLM</span></a>, in which the targeted trial receives its own column within the design matrix, but everything else remains the same as the standard model. Trials are then looped across, and many GLMs are fitted, with the parameter estimate map extracted from each GLM to build the LSS beta series.</p><div class=topic><p class=topic-title>Choosing the right model for your analysis</p><p>We have chosen not to reproduce analyses systematically comparing beta series modeling approaches in nilearn’s documentation; however, we do incorporate recommendations from the literature. Rather than taking these recommendations at face value, please refer back to the original publications and any potential updates to the literature, when possible.</p><p>First, as mentioned above, according to Cisler <em>et al.</em> <a class="footnote-reference brackets"href=#cisler2014comparison id=id5>1</a>, beta series models are most appropriate for event-related task designs. For block designs, a PPI model is better suited- at least for functional connectivity analyses.</p><p>According to Abdulrahman and Henson <a class="footnote-reference brackets"href=#abdulrahman2016effect id=id6>5</a>, the decision between LSA and LSS should be based on three factors: inter-trial variability, scan noise, and stimulus onset timing. While Mumford <em>et al.</em> <a class="footnote-reference brackets"href=#mumford2012deconvolving id=id7>3</a> proposes LSS as a tool primarily for fast event-related designs (i.e., ones with short inter-trial intervals), Abdulrahman and Henson <a class="footnote-reference brackets"href=#abdulrahman2016effect id=id8>5</a> finds, in simulations, that LSA performs better than LSS when trial variability is greater than scan noise, even in fast designs.</p></div><div class="admonition note"><p class=admonition-title>Note</p><p>If you are using Nilearn with a version older than <code class="docutils literal notranslate"><span class=pre>0.9.0</span></code>, then you should either upgrade your version or import maskers from the <code class="docutils literal notranslate"><span class=pre>input_data</span></code> module instead of the <code class="docutils literal notranslate"><span class=pre>maskers</span></code> module.</p><p>That is, you should manually replace in the following example all occurrences of:</p><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn.maskers</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-maskers sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.maskers.NiftiMasker.html#nilearn.maskers.NiftiMasker title=nilearn.maskers.NiftiMasker><span class=n>NiftiMasker</span></a>
</pre></div></div><p>with:</p><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn.input_data</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-maskers sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.maskers.NiftiMasker.html#nilearn.maskers.NiftiMasker title=nilearn.maskers.NiftiMasker><span class=n>NiftiMasker</span></a>
</pre></div></div></div><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>

<span class=kn>from</span> <span class=nn>nilearn.glm.first_level</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel title=nilearn.glm.first_level.FirstLevelModel><span class=n>FirstLevelModel</span></a>
<span class=kn>from</span> <span class=nn>nilearn</span> <span class=kn>import</span> <span class=n>image</span><span class=p>,</span> <span class=n>plotting</span>
</pre></div></div><div class=section id=prepare-data-and-analysis-parameters><h2><span class=section-number>9.8.11.1. </span>Prepare data and analysis parameters<a title="Permalink to this headline"class=headerlink href=#prepare-data-and-analysis-parameters>¶</a></h2><p>Download data in <a class="reference internal"href=../../glossary.html#term-BIDS><span class="xref std std-term">BIDS</span></a> format and event information for one subject, and create a standard <a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel title=nilearn.glm.first_level.FirstLevelModel><code class="xref py py-class docutils literal notranslate"><span class=pre>FirstLevelModel</span></code></a>.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn.datasets</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.datasets.fetch_language_localizer_demo_dataset.html#nilearn.datasets.fetch_language_localizer_demo_dataset title=nilearn.datasets.fetch_language_localizer_demo_dataset><span class=n>fetch_language_localizer_demo_dataset</span></a>

<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>data_dir</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>_</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.datasets.fetch_language_localizer_demo_dataset.html#nilearn.datasets.fetch_language_localizer_demo_dataset title=nilearn.datasets.fetch_language_localizer_demo_dataset><span class=n>fetch_language_localizer_demo_dataset</span></a><span class=p>()</span>

<span class=kn>from</span> <span class=nn>nilearn.glm.first_level</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.glm.first_level.first_level_from_bids.html#nilearn.glm.first_level.first_level_from_bids title=nilearn.glm.first_level.first_level_from_bids><span class=n>first_level_from_bids</span></a>

<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>models</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>models_run_imgs</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>events_dfs</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>models_confounds</span></a> <span class=o>=</span> \
    <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.glm.first_level.first_level_from_bids.html#nilearn.glm.first_level.first_level_from_bids title=nilearn.glm.first_level.first_level_from_bids><span class=n>first_level_from_bids</span></a><span class=p>(</span>
        <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>data_dir</span></a><span class=p>,</span>
        <span class=s1>'languagelocalizer'</span><span class=p>,</span>
        <span class=n>img_filters</span><span class=o>=</span><span class=p>[(</span><span class=s1>'desc'</span><span class=p>,</span> <span class=s1>'preproc'</span><span class=p>)],</span>
    <span class=p>)</span>

<span class=c1># Grab the first subject's model, functional file, and events DataFrame</span>
<a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel title=nilearn.glm.first_level.FirstLevelModel><span class=n>standard_glm</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>models</span></a><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>fmri_file</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>models_run_imgs</span></a><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
<a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>events_df</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>events_dfs</span></a><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>

<span class=c1># We will use first_level_from_bids's parameters for the other models</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>glm_parameters</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.get_params title=nilearn.glm.first_level.FirstLevelModel.get_params><span class=n>standard_glm</span><span class=o>.</span><span class=n>get_params</span></a><span class=p>()</span>
<span class=c1># We need to override one parameter (signal_scaling) with the value of</span>
<span class=c1># scaling_axis</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>glm_parameters</span></a><span class=p>[</span><span class=s1>'signal_scaling'</span><span class=p>]</span> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-property"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.scaling_axis title=nilearn.glm.first_level.FirstLevelModel.scaling_axis><span class=n>standard_glm</span><span class=o>.</span><span class=n>scaling_axis</span></a>
</pre></div></div><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>/home/nicolas/GitRepos/nilearn-fork/nilearn/glm/first_level/first_level.py:901: UserWarning:

SliceTimingRef not found in file /home/nicolas/nilearn_data/fMRI-language-localizer-demo-dataset/derivatives/sub-01/func/sub-01_task-languagelocalizer_desc-preproc_bold.json. It will be assumed that the slice timing reference is 0.0 percent of the repetition time. If it is not the case it will need to be set manually in the generated list of models
</pre></div></div></div><div class=section id=define-the-standard-model><h2><span class=section-number>9.8.11.2. </span>Define the standard model<a title="Permalink to this headline"class=headerlink href=#define-the-standard-model>¶</a></h2><p>Here, we create a basic <a class="reference internal"href=../../glossary.html#term-GLM><span class="xref std std-term">GLM</span></a> for this run, which we can use to highlight differences between the standard modeling approach and beta series models. We will just use the one created by <a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.first_level_from_bids.html#nilearn.glm.first_level.first_level_from_bids title=nilearn.glm.first_level.first_level_from_bids><code class="xref py py-func docutils literal notranslate"><span class=pre>first_level_from_bids</span></code></a>.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.fit title=nilearn.glm.first_level.FirstLevelModel.fit><span class=n>standard_glm</span><span class=o>.</span><span class=n>fit</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>fmri_file</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>events_df</span></a><span class=p>)</span>

<span class=c1># The standard design matrix has one column for each condition, along with</span>
<span class=c1># columns for the confound regressors and drifts</span>
<a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure title=matplotlib.figure.Figure><span class=n>fig</span></a><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots title=matplotlib.pyplot.subplots><span class=n>plt</span><span class=o>.</span><span class=n>subplots</span></a><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>
<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_design_matrix.html#nilearn.plotting.plot_design_matrix title=nilearn.plotting.plot_design_matrix><span class=n>plotting</span><span class=o>.</span><span class=n>plot_design_matrix</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>standard_glm</span><span class=o>.</span><span class=n>design_matrices_</span></a><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>)</span>
<a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure.show title=matplotlib.figure.Figure.show><span class=n>fig</span><span class=o>.</span><span class=n>show</span></a><span class=p>()</span>
</pre></div></div><img alt="plot beta series"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_beta_series_001.png srcset=../../_images/sphx_glr_plot_beta_series_001.png></div><div class=section id=define-the-lsa-model><h2><span class=section-number>9.8.11.3. </span>Define the LSA model<a title="Permalink to this headline"class=headerlink href=#define-the-lsa-model>¶</a></h2><p>We will now create a least squares- all (LSA) model. This involves a simple transformation, where each trial of interest receives its own unique trial type. It’s important to ensure that the original trial types can be inferred from the updated trial-wise trial types, in order to collect the resulting beta maps into condition-wise beta series.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=c1># Transform the DataFrame for LSA</span>
<a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>lsa_events_df</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-method"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.copy.html#pandas.DataFrame.copy title=pandas.DataFrame.copy><span class=n>events_df</span><span class=o>.</span><span class=n>copy</span></a><span class=p>()</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>conditions</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>lsa_events_df</span></a><span class=p>[</span><span class=s1>'trial_type'</span><span class=p>]</span><span class=o>.</span><span class=n>unique</span><span class=p>()</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>condition_counter</span></a> <span class=o>=</span> <span class=p>{</span><span class=n>c</span><span class=p>:</span> <span class=mi>0</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>conditions</span></a><span class=p>}</span>
<span class=k>for</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>i_trial</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series title=pandas.core.series.Series><span class=n>trial</span></a> <span class=ow>in</span> <a class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-method"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.iterrows.html#pandas.DataFrame.iterrows title=pandas.DataFrame.iterrows><span class=n>lsa_events_df</span><span class=o>.</span><span class=n>iterrows</span></a><span class=p>():</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_condition</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series title=pandas.core.series.Series><span class=n>trial</span></a><span class=p>[</span><span class=s1>'trial_type'</span><span class=p>]</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>condition_counter</span></a><span class=p>[</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_condition</span></a><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
    <span class=c1># We use a unique delimiter here (``__``) that shouldn't be in the</span>
    <span class=c1># original condition names</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_name</span></a> <span class=o>=</span> <span class=sa>f</span><span class=s1>'</span><span class=si>{</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_condition</span></a><span class=si>}</span><span class=s1>__</span><span class=si>{</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>condition_counter</span></a><span class=p>[</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_condition</span></a><span class=p>]</span><span class=si>:</span><span class=s1>03d</span><span class=si>}</span><span class=s1>'</span>
    <a class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-property"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.loc.html#pandas.DataFrame.loc title=pandas.DataFrame.loc><span class=n>lsa_events_df</span><span class=o>.</span><span class=n>loc</span></a><span class=p>[</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>i_trial</span></a><span class=p>,</span> <span class=s1>'trial_type'</span><span class=p>]</span> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_name</span></a>

<a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel title=nilearn.glm.first_level.FirstLevelModel><span class=n>lsa_glm</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel title=nilearn.glm.first_level.FirstLevelModel><span class=n>FirstLevelModel</span></a><span class=p>(</span><span class=o>**</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>glm_parameters</span></a><span class=p>)</span>
<a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.fit title=nilearn.glm.first_level.FirstLevelModel.fit><span class=n>lsa_glm</span><span class=o>.</span><span class=n>fit</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>fmri_file</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>lsa_events_df</span></a><span class=p>)</span>

<a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure title=matplotlib.figure.Figure><span class=n>fig</span></a><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots title=matplotlib.pyplot.subplots><span class=n>plt</span><span class=o>.</span><span class=n>subplots</span></a><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>
<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_design_matrix.html#nilearn.plotting.plot_design_matrix title=nilearn.plotting.plot_design_matrix><span class=n>plotting</span><span class=o>.</span><span class=n>plot_design_matrix</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>lsa_glm</span><span class=o>.</span><span class=n>design_matrices_</span></a><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>)</span>
<a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure.show title=matplotlib.figure.Figure.show><span class=n>fig</span><span class=o>.</span><span class=n>show</span></a><span class=p>()</span>
</pre></div></div><img alt="plot beta series"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_beta_series_002.png srcset=../../_images/sphx_glr_plot_beta_series_002.png><div class=section id=aggregate-beta-maps-from-the-lsa-model-based-on-condition><h3><span class=section-number>9.8.11.3.1. </span>Aggregate beta maps from the LSA model based on condition<a title="Permalink to this headline"class=headerlink href=#aggregate-beta-maps-from-the-lsa-model-based-on-condition>¶</a></h3><p>Collect the parameter estimate maps</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>lsa_beta_maps</span></a> <span class=o>=</span> <span class=p>{</span><span class=n>cond</span><span class=p>:</span> <span class=p>[]</span> <span class=k>for</span> <span class=n>cond</span> <span class=ow>in</span> <a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>events_df</span></a><span class=p>[</span><span class=s1>'trial_type'</span><span class=p>]</span><span class=o>.</span><span class=n>unique</span><span class=p>()}</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>trialwise_conditions</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>lsa_events_df</span></a><span class=p>[</span><span class=s1>'trial_type'</span><span class=p>]</span><span class=o>.</span><span class=n>unique</span><span class=p>()</span>
<span class=k>for</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>condition</span></a> <span class=ow>in</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>trialwise_conditions</span></a><span class=p>:</span>
    <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>beta_map</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.compute_contrast title=nilearn.glm.first_level.FirstLevelModel.compute_contrast><span class=n>lsa_glm</span><span class=o>.</span><span class=n>compute_contrast</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>condition</span></a><span class=p>,</span> <span class=n>output_type</span><span class=o>=</span><span class=s1>'effect_size'</span><span class=p>)</span>
    <span class=c1># Drop the trial number from the condition name to get the original name</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>condition_name</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>condition</span></a><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>'__'</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>lsa_beta_maps</span></a><span class=p>[</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>condition_name</span></a><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>beta_map</span></a><span class=p>)</span>

<span class=c1># We can concatenate the lists of 3D maps into a single 4D beta series for</span>
<span class=c1># each condition, if we want</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>lsa_beta_maps</span></a> <span class=o>=</span> <span class=p>{</span>
    <span class=n>name</span><span class=p>:</span> <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.concat_imgs.html#nilearn.image.concat_imgs title=nilearn.image.concat_imgs><span class=n>image</span><span class=o>.</span><span class=n>concat_imgs</span></a><span class=p>(</span><span class=n>maps</span><span class=p>)</span> <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>maps</span> <span class=ow>in</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>lsa_beta_maps</span></a><span class=o>.</span><span class=n>items</span><span class=p>()</span>
<span class=p>}</span>
</pre></div></div></div></div><div class=section id=define-the-lss-models><h2><span class=section-number>9.8.11.4. </span>Define the LSS models<a title="Permalink to this headline"class=headerlink href=#define-the-lss-models>¶</a></h2><p>We will now create a separate LSS model for each trial of interest. The transformation is much like the LSA approach, except that we only relabel <em>one</em> trial in the DataFrame. We loop through the trials, create a version of the DataFrame where the targeted trial has a unique trial type, fit the model to that DataFrame, and finally collect the targeted trial’s beta map for the beta series.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=k>def</span> <span class=nf>lss_transformer</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>row_number</span><span class=p>):</span>
    <span class=sd>"""Label one trial for one LSS model.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    df : pandas.DataFrame</span>
<span class=sd>        BIDS-compliant events file information.</span>
<span class=sd>    row_number : int</span>
<span class=sd>        Row number in the DataFrame.</span>
<span class=sd>        This indexes the trial that will be isolated.</span>

<span class=sd>    Returns</span>
<span class=sd>    -------</span>
<span class=sd>    df : pandas.DataFrame</span>
<span class=sd>        Update events information, with the select trial's trial type isolated.</span>
<span class=sd>    trial_name : str</span>
<span class=sd>        Name of the isolated trial's trial type.</span>
<span class=sd>    """</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>

    <span class=c1># Determine which number trial it is *within the condition*</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_condition</span></a> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>row_number</span><span class=p>,</span> <span class=s1>'trial_type'</span><span class=p>]</span>
    <span class=n>trial_type_series</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'trial_type'</span><span class=p>]</span>
    <span class=n>trial_type_series</span> <span class=o>=</span> <span class=n>trial_type_series</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span>
        <span class=n>trial_type_series</span> <span class=o>==</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_condition</span></a>
    <span class=p>]</span>
    <span class=n>trial_type_list</span> <span class=o>=</span> <span class=n>trial_type_series</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
    <span class=n>trial_number</span> <span class=o>=</span> <span class=n>trial_type_list</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>row_number</span><span class=p>)</span>

    <span class=c1># We use a unique delimiter here (``__``) that shouldn't be in the</span>
    <span class=c1># original condition names.</span>
    <span class=c1># Technically, all you need is for the requested trial to have a unique</span>
    <span class=c1># 'trial_type' *within* the dataframe, rather than across models.</span>
    <span class=c1># However, we may want to have meaningful 'trial_type's (e.g., 'Left_001')</span>
    <span class=c1># across models, so that you could track individual trials across models.</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_name</span></a> <span class=o>=</span> <span class=sa>f</span><span class=s1>'</span><span class=si>{</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_condition</span></a><span class=si>}</span><span class=s1>__</span><span class=si>{</span><span class=n>trial_number</span><span class=si>:</span><span class=s1>03d</span><span class=si>}</span><span class=s1>'</span>
    <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>row_number</span><span class=p>,</span> <span class=s1>'trial_type'</span><span class=p>]</span> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_name</span></a>
    <span class=k>return</span> <span class=n>df</span><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_name</span></a>


<span class=c1># Loop through the trials of interest and transform the DataFrame for LSS</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>lss_beta_maps</span></a> <span class=o>=</span> <span class=p>{</span><span class=n>cond</span><span class=p>:</span> <span class=p>[]</span> <span class=k>for</span> <span class=n>cond</span> <span class=ow>in</span> <a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>events_df</span></a><span class=p>[</span><span class=s1>'trial_type'</span><span class=p>]</span><span class=o>.</span><span class=n>unique</span><span class=p>()}</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>lss_design_matrices</span></a> <span class=o>=</span> <span class=p>[]</span>

<span class=k>for</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>i_trial</span></a> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><a class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-property"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.shape.html#pandas.DataFrame.shape title=pandas.DataFrame.shape><span class=n>events_df</span><span class=o>.</span><span class=n>shape</span></a><span class=p>[</span><span class=mi>0</span><span class=p>]):</span>
    <a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>lss_events_df</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_condition</span></a> <span class=o>=</span> <span class=n>lss_transformer</span><span class=p>(</span><a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>events_df</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>i_trial</span></a><span class=p>)</span>

    <span class=c1># Compute and collect beta maps</span>
    <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel title=nilearn.glm.first_level.FirstLevelModel><span class=n>lss_glm</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel title=nilearn.glm.first_level.FirstLevelModel><span class=n>FirstLevelModel</span></a><span class=p>(</span><span class=o>**</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>glm_parameters</span></a><span class=p>)</span>
    <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.fit title=nilearn.glm.first_level.FirstLevelModel.fit><span class=n>lss_glm</span><span class=o>.</span><span class=n>fit</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>fmri_file</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.core.frame.DataFrame><span class=n>lss_events_df</span></a><span class=p>)</span>

    <span class=c1># We will save the design matrices across trials to show them later</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>lss_design_matrices</span></a><span class=o>.</span><span class=n>append</span><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>lss_glm</span><span class=o>.</span><span class=n>design_matrices_</span></a><span class=p>[</span><span class=mi>0</span><span class=p>])</span>

    <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>beta_map</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-glm-first_level sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html#nilearn.glm.first_level.FirstLevelModel.compute_contrast title=nilearn.glm.first_level.FirstLevelModel.compute_contrast><span class=n>lss_glm</span><span class=o>.</span><span class=n>compute_contrast</span></a><span class=p>(</span>
        <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_condition</span></a><span class=p>,</span>
        <span class=n>output_type</span><span class=o>=</span><span class=s1>'effect_size'</span><span class=p>,</span>
    <span class=p>)</span>

    <span class=c1># Drop the trial number from the condition name to get the original name</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>condition_name</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>trial_condition</span></a><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>'__'</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>lss_beta_maps</span></a><span class=p>[</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#str title=builtins.str><span class=n>condition_name</span></a><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>beta_map</span></a><span class=p>)</span>

<span class=c1># We can concatenate the lists of 3D maps into a single 4D beta series for</span>
<span class=c1># each condition, if we want</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>lss_beta_maps</span></a> <span class=o>=</span> <span class=p>{</span>
    <span class=n>name</span><span class=p>:</span> <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.concat_imgs.html#nilearn.image.concat_imgs title=nilearn.image.concat_imgs><span class=n>image</span><span class=o>.</span><span class=n>concat_imgs</span></a><span class=p>(</span><span class=n>maps</span><span class=p>)</span> <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>maps</span> <span class=ow>in</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>lss_beta_maps</span></a><span class=o>.</span><span class=n>items</span><span class=p>()</span>
<span class=p>}</span>
</pre></div></div><div class=section id=show-the-design-matrices-for-the-first-few-trials><h3><span class=section-number>9.8.11.4.1. </span>Show the design matrices for the first few trials<a title="Permalink to this headline"class=headerlink href=#show-the-design-matrices-for-the-first-few-trials>¶</a></h3><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure title=matplotlib.figure.Figure><span class=n>fig</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots title=matplotlib.pyplot.subplots><span class=n>plt</span><span class=o>.</span><span class=n>subplots</span></a><span class=p>(</span><span class=n>ncols</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>
<span class=k>for</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>i_trial</span></a> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>):</span>
    <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_design_matrix.html#nilearn.plotting.plot_design_matrix title=nilearn.plotting.plot_design_matrix><span class=n>plotting</span><span class=o>.</span><span class=n>plot_design_matrix</span></a><span class=p>(</span>
        <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>lss_design_matrices</span></a><span class=p>[</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>i_trial</span></a><span class=p>],</span>
        <span class=n>ax</span><span class=o>=</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=p>[</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>i_trial</span></a><span class=p>],</span>
    <span class=p>)</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=p>[</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>i_trial</span></a><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=sa>f</span><span class=s1>'Trial </span><span class=si>{</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>i_trial</span></a> <span class=o>+</span> <span class=mi>1</span><span class=si>}</span><span class=s1>'</span><span class=p>)</span>

<a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure.show title=matplotlib.figure.Figure.show><span class=n>fig</span><span class=o>.</span><span class=n>show</span></a><span class=p>()</span>
</pre></div></div><img alt="Trial 1, Trial 2, Trial 3"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_beta_series_003.png srcset=../../_images/sphx_glr_plot_beta_series_003.png></div></div><div class=section id=compare-the-three-modeling-approaches><h2><span class=section-number>9.8.11.5. </span>Compare the three modeling approaches<a title="Permalink to this headline"class=headerlink href=#compare-the-three-modeling-approaches>¶</a></h2><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>DM_TITLES</span></a> <span class=o>=</span> <span class=p>[</span><span class=s1>'Standard GLM'</span><span class=p>,</span> <span class=s1>'LSA Model'</span><span class=p>,</span> <span class=s1>'LSS Model (Trial 1)'</span><span class=p>]</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>DESIGN_MATRICES</span></a> <span class=o>=</span> <span class=p>[</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>standard_glm</span><span class=o>.</span><span class=n>design_matrices_</span></a><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>lsa_glm</span><span class=o>.</span><span class=n>design_matrices_</span></a><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>lss_design_matrices</span></a><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
<span class=p>]</span>

<a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure title=matplotlib.figure.Figure><span class=n>fig</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots title=matplotlib.pyplot.subplots><span class=n>plt</span><span class=o>.</span><span class=n>subplots</span></a><span class=p>(</span>
    <span class=n>ncols</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
    <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>10</span><span class=p>),</span>
    <span class=n>gridspec_kw</span><span class=o>=</span><span class=p>{</span><span class=s1>'width_ratios'</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>]},</span>
<span class=p>)</span>

<span class=k>for</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>i_ax</span></a><span class=p>,</span> <span class=n>ax</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=p>):</span>
    <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_design_matrix.html#nilearn.plotting.plot_design_matrix title=nilearn.plotting.plot_design_matrix><span class=n>plotting</span><span class=o>.</span><span class=n>plot_design_matrix</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>DESIGN_MATRICES</span></a><span class=p>[</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>i_ax</span></a><span class=p>],</span> <span class=n>ax</span><span class=o>=</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=p>[</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>i_ax</span></a><span class=p>])</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=p>[</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>i_ax</span></a><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>DM_TITLES</span></a><span class=p>[</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/functions.html#int title=builtins.int><span class=n>i_ax</span></a><span class=p>])</span>

<a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure.show title=matplotlib.figure.Figure.show><span class=n>fig</span><span class=o>.</span><span class=n>show</span></a><span class=p>()</span>
</pre></div></div><img alt="Standard GLM, LSA Model, LSS Model (Trial 1)"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_beta_series_004.png srcset=../../_images/sphx_glr_plot_beta_series_004.png></div><div class=section id=applications-of-beta-series><h2><span class=section-number>9.8.11.6. </span>Applications of beta series<a title="Permalink to this headline"class=headerlink href=#applications-of-beta-series>¶</a></h2><p>Beta series can be used much like resting-state data, though generally with vastly reduced degrees of freedom than a typical resting-state run, given that the number of trials should always be less than the number of volumes in a functional MRI run.</p><p>Two common applications of beta series are to functional connectivity and decoding analyses. For an example of a beta series applied to decoding, see <a class="reference internal"href=../02_decoding/plot_haxby_glm_decoding.html#sphx-glr-auto-examples-02-decoding-plot-haxby-glm-decoding-py><span class="std std-ref">Decoding of a dataset after GLM fit for signal extraction</span></a>. Here, we show how the beta series can be applied to functional connectivity analysis. In the following section, we perform a quick task-based functional connectivity analysis of each of the two task conditions (‘language’ and ‘string’), using the LSS beta series. This section is based on <a class="reference internal"href=../03_connectivity/plot_seed_to_voxel_correlation.html#sphx-glr-auto-examples-03-connectivity-plot-seed-to-voxel-correlation-py><span class="std std-ref">Producing single subject maps of seed-to-voxel correlation</span></a>, which goes into more detail about seed-to-voxel functional connectivity analyses.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>

<span class=kn>from</span> <span class=nn>nilearn.maskers</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-maskers sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.maskers.NiftiSpheresMasker.html#nilearn.maskers.NiftiSpheresMasker title=nilearn.maskers.NiftiSpheresMasker><span class=n>NiftiSpheresMasker</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-nilearn-maskers sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.maskers.NiftiMasker.html#nilearn.maskers.NiftiMasker title=nilearn.maskers.NiftiMasker><span class=n>NiftiMasker</span></a>

<span class=c1># Coordinate taken from Neurosynth's 'language' meta-analysis</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>coords</span></a> <span class=o>=</span> <span class=p>[(</span><span class=o>-</span><span class=mi>54</span><span class=p>,</span> <span class=o>-</span><span class=mi>42</span><span class=p>,</span> <span class=mi>3</span><span class=p>)]</span>

<span class=c1># Initialize maskers for the seed and the rest of the brain</span>
<a class="sphx-glr-backref-module-nilearn-maskers sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.maskers.NiftiSpheresMasker.html#nilearn.maskers.NiftiSpheresMasker title=nilearn.maskers.NiftiSpheresMasker><span class=n>seed_masker</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-maskers sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.maskers.NiftiSpheresMasker.html#nilearn.maskers.NiftiSpheresMasker title=nilearn.maskers.NiftiSpheresMasker><span class=n>NiftiSpheresMasker</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>coords</span></a><span class=p>,</span>
    <span class=n>radius</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
    <span class=n>detrend</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>standardize</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>low_pass</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>high_pass</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>t_r</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>memory</span><span class=o>=</span><span class=s1>'nilearn_cache'</span><span class=p>,</span>
    <span class=n>memory_level</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
    <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<span class=p>)</span>

<a class="sphx-glr-backref-module-nilearn-maskers sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.maskers.NiftiMasker.html#nilearn.maskers.NiftiMasker title=nilearn.maskers.NiftiMasker><span class=n>brain_masker</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-maskers sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.maskers.NiftiMasker.html#nilearn.maskers.NiftiMasker title=nilearn.maskers.NiftiMasker><span class=n>NiftiMasker</span></a><span class=p>(</span>
    <span class=n>smoothing_fwhm</span><span class=o>=</span><span class=mi>6</span><span class=p>,</span>
    <span class=n>detrend</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>standardize</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>low_pass</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>high_pass</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>t_r</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>memory</span><span class=o>=</span><span class=s1>'nilearn_cache'</span><span class=p>,</span>
    <span class=n>memory_level</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
    <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
<span class=p>)</span>

<span class=c1># Perform the seed-to-voxel correlation for the LSS 'language' beta series</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>lang_seed_beta_series</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-maskers sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.maskers.NiftiSpheresMasker.html#nilearn.maskers.NiftiSpheresMasker.fit_transform title=nilearn.maskers.NiftiSpheresMasker.fit_transform><span class=n>seed_masker</span><span class=o>.</span><span class=n>fit_transform</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>lss_beta_maps</span></a><span class=p>[</span><span class=s1>'language'</span><span class=p>])</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>lang_beta_series</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-maskers sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.maskers.NiftiMasker.html#nilearn.maskers.NiftiMasker.fit_transform title=nilearn.maskers.NiftiMasker.fit_transform><span class=n>brain_masker</span><span class=o>.</span><span class=n>fit_transform</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>lss_beta_maps</span></a><span class=p>[</span><span class=s1>'language'</span><span class=p>])</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>lang_corrs</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.dot.html#numpy.dot title=numpy.dot><span class=n>np</span><span class=o>.</span><span class=n>dot</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>lang_beta_series</span><span class=o>.</span><span class=n>T</span></a><span class=p>,</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>lang_seed_beta_series</span></a><span class=p>,</span>
<span class=p>)</span> <span class=o>/</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#tuple title=builtins.tuple><span class=n>lang_seed_beta_series</span><span class=o>.</span><span class=n>shape</span></a><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>language_connectivity_img</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-maskers sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.maskers.NiftiMasker.html#nilearn.maskers.NiftiMasker.inverse_transform title=nilearn.maskers.NiftiMasker.inverse_transform><span class=n>brain_masker</span><span class=o>.</span><span class=n>inverse_transform</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>lang_corrs</span><span class=o>.</span><span class=n>T</span></a><span class=p>)</span>

<span class=c1># Perform the seed-to-voxel correlation for the LSS 'string' beta series</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>string_seed_beta_series</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-maskers sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.maskers.NiftiSpheresMasker.html#nilearn.maskers.NiftiSpheresMasker.fit_transform title=nilearn.maskers.NiftiSpheresMasker.fit_transform><span class=n>seed_masker</span><span class=o>.</span><span class=n>fit_transform</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>lss_beta_maps</span></a><span class=p>[</span><span class=s1>'string'</span><span class=p>])</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>string_beta_series</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-maskers sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.maskers.NiftiMasker.html#nilearn.maskers.NiftiMasker.fit_transform title=nilearn.maskers.NiftiMasker.fit_transform><span class=n>brain_masker</span><span class=o>.</span><span class=n>fit_transform</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#dict title=builtins.dict><span class=n>lss_beta_maps</span></a><span class=p>[</span><span class=s1>'string'</span><span class=p>])</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>string_corrs</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.dot.html#numpy.dot title=numpy.dot><span class=n>np</span><span class=o>.</span><span class=n>dot</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>string_beta_series</span><span class=o>.</span><span class=n>T</span></a><span class=p>,</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>string_seed_beta_series</span></a><span class=p>,</span>
<span class=p>)</span> <span class=o>/</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#tuple title=builtins.tuple><span class=n>string_seed_beta_series</span><span class=o>.</span><span class=n>shape</span></a><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>string_connectivity_img</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-maskers sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.maskers.NiftiMasker.html#nilearn.maskers.NiftiMasker.inverse_transform title=nilearn.maskers.NiftiMasker.inverse_transform><span class=n>brain_masker</span><span class=o>.</span><span class=n>inverse_transform</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>string_corrs</span><span class=o>.</span><span class=n>T</span></a><span class=p>)</span>

<span class=c1># Show both correlation maps</span>
<a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure title=matplotlib.figure.Figure><span class=n>fig</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots title=matplotlib.pyplot.subplots><span class=n>plt</span><span class=o>.</span><span class=n>subplots</span></a><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>8</span><span class=p>),</span> <span class=n>nrows</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>

<a class="sphx-glr-backref-module-nilearn-plotting-displays sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.plotting.displays.OrthoSlicer.html#nilearn.plotting.displays.OrthoSlicer title=nilearn.plotting.displays.OrthoSlicer><span class=n>display</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map title=nilearn.plotting.plot_stat_map><span class=n>plotting</span><span class=o>.</span><span class=n>plot_stat_map</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>language_connectivity_img</span></a><span class=p>,</span>
    <span class=n>threshold</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span>
    <span class=n>vmax</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
    <span class=n>cut_coords</span><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>coords</span></a><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
    <span class=n>title</span><span class=o>=</span><span class=s1>'Language'</span><span class=p>,</span>
    <span class=n>figure</span><span class=o>=</span><a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure title=matplotlib.figure.Figure><span class=n>fig</span></a><span class=p>,</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=o>=</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
<span class=p>)</span>
<a class="sphx-glr-backref-module-nilearn-plotting-displays sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.plotting.displays.OrthoSlicer.html#nilearn.plotting.displays.OrthoSlicer.add_markers title=nilearn.plotting.displays.OrthoSlicer.add_markers><span class=n>display</span><span class=o>.</span><span class=n>add_markers</span></a><span class=p>(</span>
    <span class=n>marker_coords</span><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>coords</span></a><span class=p>,</span>
    <span class=n>marker_color</span><span class=o>=</span><span class=s1>'g'</span><span class=p>,</span>
    <span class=n>marker_size</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span>
<span class=p>)</span>

<a class="sphx-glr-backref-module-nilearn-plotting-displays sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.plotting.displays.OrthoSlicer.html#nilearn.plotting.displays.OrthoSlicer title=nilearn.plotting.displays.OrthoSlicer><span class=n>display</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map title=nilearn.plotting.plot_stat_map><span class=n>plotting</span><span class=o>.</span><span class=n>plot_stat_map</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>string_connectivity_img</span></a><span class=p>,</span>
    <span class=n>threshold</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span>
    <span class=n>vmax</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
    <span class=n>cut_coords</span><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>coords</span></a><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
    <span class=n>title</span><span class=o>=</span><span class=s1>'String'</span><span class=p>,</span>
    <span class=n>figure</span><span class=o>=</span><a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure title=matplotlib.figure.Figure><span class=n>fig</span></a><span class=p>,</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=o>=</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=p>[</span><span class=mi>1</span><span class=p>],</span>
<span class=p>)</span>
<a class="sphx-glr-backref-module-nilearn-plotting-displays sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.plotting.displays.OrthoSlicer.html#nilearn.plotting.displays.OrthoSlicer.add_markers title=nilearn.plotting.displays.OrthoSlicer.add_markers><span class=n>display</span><span class=o>.</span><span class=n>add_markers</span></a><span class=p>(</span>
    <span class=n>marker_coords</span><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.8/library/stdtypes.html#list title=builtins.list><span class=n>coords</span></a><span class=p>,</span>
    <span class=n>marker_color</span><span class=o>=</span><span class=s1>'g'</span><span class=p>,</span>
    <span class=n>marker_size</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span>
<span class=p>)</span>
<a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure.suptitle title=matplotlib.figure.Figure.suptitle><span class=n>fig</span><span class=o>.</span><span class=n>suptitle</span></a><span class=p>(</span><span class=s1>'LSS Beta Series Functional Connectivity'</span><span class=p>)</span>

<a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure.show title=matplotlib.figure.Figure.show><span class=n>fig</span><span class=o>.</span><span class=n>show</span></a><span class=p>()</span>
</pre></div></div><img alt="LSS Beta Series Functional Connectivity"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_beta_series_005.png srcset=../../_images/sphx_glr_plot_beta_series_005.png></div><div class=section id=references><h2><span class=section-number>9.8.11.7. </span>References<a title="Permalink to this headline"class=headerlink href=#references>¶</a></h2><blockquote><div><p><dl class="footnote brackets"><dt class=label id=cisler2014comparison><span class=brackets>1</span><span class=fn-backref>(<a href=#id1>1</a>,<a href=#id5>2</a>)</span></dt><dd><p>Josh M Cisler, Keith Bush, and J Scott Steele. A comparison of statistical methods for detecting context-modulated functional connectivity in fmri. <em>Neuroimage</em>, 84:1042–1052, 2014.</p></dd><dt class=label id=rissman2004measuring><span class=brackets><a class=fn-backref href=#id2>2</a></span></dt><dd><p>Jesse Rissman, Adam Gazzaley, and Mark D’Esposito. Measuring functional connectivity during distinct stages of a cognitive task. <em>Neuroimage</em>, 23(2):752–763, 2004.</p></dd><dt class=label id=mumford2012deconvolving><span class=brackets>3</span><span class=fn-backref>(<a href=#id3>1</a>,<a href=#id7>2</a>)</span></dt><dd><p>Jeanette A Mumford, Benjamin O Turner, F Gregory Ashby, and Russell A Poldrack. Deconvolving bold activation in event-related designs for multivoxel pattern classification analyses. <em>Neuroimage</em>, 59(3):2636–2643, 2012.</p></dd><dt class=label id=turner2012spatiotemporal><span class=brackets><a class=fn-backref href=#id4>4</a></span></dt><dd><p>Benjamin O Turner, Jeanette A Mumford, Russell A Poldrack, and F Gregory Ashby. Spatiotemporal activity estimation for multivoxel pattern analysis with rapid event-related designs. <em>NeuroImage</em>, 62(3):1429–1438, 2012.</p></dd><dt class=label id=abdulrahman2016effect><span class=brackets>5</span><span class=fn-backref>(<a href=#id6>1</a>,<a href=#id8>2</a>)</span></dt><dd><p>Hunar Abdulrahman and Richard N Henson. Effect of trial-to-trial variability on optimal event-related fmri design: implications for beta-series correlation and multi-voxel pattern analysis. <em>NeuroImage</em>, 125:756–766, 2016.</p></dd></dl></div></blockquote><p class=sphx-glr-timing><strong>Total running time of the script:</strong> ( 1 minutes 45.248 seconds)</p><p><strong>Estimated memory usage:</strong> 98 MB</p><div class="sphx-glr-footer class sphx-glr-footer-example docutils container"id=sphx-glr-download-auto-examples-07-advanced-plot-beta-series-py><div class="binder-badge docutils container"><a class="reference external image-reference"href=https://mybinder.org/v2/gh/nilearn/nilearn.github.io/main?filepath=examples/auto_examples/07_advanced/plot_beta_series.ipynb><img alt="Launch binder"src=../../_images/binder_badge_logo6.svg width=150px></a></div><div class="sphx-glr-download sphx-glr-download-python docutils container"><p><a class="reference download internal"download href=../../_downloads/95039b5541e25d342eae928f26ff3aa6/plot_beta_series.py><code class="xref download docutils literal notranslate"><span class=pre>Download</span> <span class=pre>Python</span> <span class=pre>source</span> <span class=pre>code:</span> <span class=pre>plot_beta_series.py</span></code></a></p></div><div class="sphx-glr-download sphx-glr-download-jupyter docutils container"><p><a class="reference download internal"download href=../../_downloads/836d98f3e4e4cdfe35c0fd42fe07a859/plot_beta_series.ipynb><code class="xref download docutils literal notranslate"><span class=pre>Download</span> <span class=pre>Jupyter</span> <span class=pre>notebook:</span> <span class=pre>plot_beta_series.ipynb</span></code></a></p></div></div><p class=sphx-glr-signature><a class="reference external"href=https://sphinx-gallery.github.io>Gallery generated by Sphinx-Gallery</a></p></div></div><div class=clearer></div></div></div></div><div aria-label="main navigation"class=sphinxsidebar role=navigation><div class=sphinxsidebarwrapper><h4>Giving credit</h4><ul class=simple><li><p>Please consider <a href=../../authors.html#citing>citing the papers</a>.</p></li></ul><h3><a href=../../index.html>Table of Contents</a></h3><ul><li><a class="reference internal"href=#>9.8.11. Beta-Series Modeling for Task-Based Functional Connectivity and Decoding</a><ul><li><a class="reference internal"href=#prepare-data-and-analysis-parameters>9.8.11.1. Prepare data and analysis parameters</a></li><li><a class="reference internal"href=#define-the-standard-model>9.8.11.2. Define the standard model</a></li><li><a class="reference internal"href=#define-the-lsa-model>9.8.11.3. Define the LSA model</a><ul><li><a class="reference internal"href=#aggregate-beta-maps-from-the-lsa-model-based-on-condition>9.8.11.3.1. Aggregate beta maps from the LSA model based on condition</a></li></ul></li><li><a class="reference internal"href=#define-the-lss-models>9.8.11.4. Define the LSS models</a><ul><li><a class="reference internal"href=#show-the-design-matrices-for-the-first-few-trials>9.8.11.4.1. Show the design matrices for the first few trials</a></li></ul></li><li><a class="reference internal"href=#compare-the-three-modeling-approaches>9.8.11.5. Compare the three modeling approaches</a></li><li><a class="reference internal"href=#applications-of-beta-series>9.8.11.6. Applications of beta series</a></li><li><a class="reference internal"href=#references>9.8.11.7. References</a></li></ul></li></ul><h4>Previous topic</h4><p class=topless><a title="previous chapter"href=plot_advanced_decoding_scikit.html><span class=section-number>9.8.10. </span>Advanced decoding using scikit learn</a></p><h4>Next topic</h4><p class=topless><a title="next chapter"href=../../changes/whats_new.html>What’s new</a></p><div id=searchbox role=search style=display:none><h3 id=searchlabel>Quick search</h3><div class=searchformwrapper><form action=../../search.html class=search><input aria-labelledby=searchlabel name=q><input type=submit value=Go></form></div></div><script>$('#searchbox').show(0);</script></div></div><div class=clearer></div></div><div class=footer>© The nilearn developers 2010-2022. Created using <a href=http://sphinx.pocoo.org/>Sphinx</a> 4.0.2. <span style=padding-left:5ex> <a href=../../_sources/auto_examples/07_advanced/plot_beta_series.rst.txt rel=nofollow>Show this page source</a> </span></div></body></html>