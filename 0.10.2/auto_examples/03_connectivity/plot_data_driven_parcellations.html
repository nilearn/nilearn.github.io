<!doctypehtml><html class=no-js data-content_root lang=en><meta charset=utf-8><meta content=width=device-width,initial-scale=1 name=viewport><meta content="light dark"name=color-scheme><meta content=width=device-width,initial-scale=1 name=viewport><meta content="Clustering methods to learn a brain parcellation from fMRI"property=og:title><meta content=website property=og:type><meta content=https://nilearn.github.io/auto_examples/03_connectivity/plot_data_driven_parcellations.html property=og:url><meta content=Nilearn property=og:site_name><meta content="We use spatially-constrained Ward-clustering, KMeans, Hierarchical KMeans and Recursive Neighbor Agglomeration (ReNA) to create a set of parcels. In a high dimensional regime, these methods can be ..."property=og:description><meta content=https://nilearn.github.io/_static/nilearn-logo.png property=og:image><meta content=Nilearn property=og:image:alt><meta content="We use spatially-constrained Ward-clustering, KMeans, Hierarchical KMeans and Recursive Neighbor Agglomeration (ReNA) to create a set of parcels. In a high dimensional regime, these methods can be ..."name=description><link href=../../search.html rel=search title=Search><link title="GLM: First level analysis"href=../04_glm_first_level/index.html rel=next><link title="Extract signals on spheres and plot a connectome"href=plot_sphere_based_connectome.html rel=prev><link rel="shortcut icon"href=../../_static/favicon.ico><title>Clustering methods to learn a brain parcellation from fMRI - Nilearn</title><link href=../../_static/pygments.css?v=045299b1 rel=stylesheet><link href=../../_static/styles/furo.css?v=135e06be rel=stylesheet><link href=../../_static/copybutton.css?v=76b2166b rel=stylesheet><link href=../../_static/sg_gallery.css?v=61a4c737 rel=stylesheet><link href=../../_static/sg_gallery-binder.css?v=f4aeca0c rel=stylesheet><link href=../../_static/sg_gallery-dataframe.css?v=2082cf3c rel=stylesheet><link href=../../_static/sg_gallery-rendered-html.css?v=1277b6f3 rel=stylesheet><link href=../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7 rel=stylesheet><link href=../../_static/styles/furo-extensions.css?v=36a5483c rel=stylesheet><link href=../../_static/custom.css?v=486f7390 rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css rel=stylesheet><style>body{--color-code-background:#fff;--color-code-foreground:black;--admonition-font-size:100%;--admonition-title-font-size:100%;--color-announcement-background:#fbb360;--color-announcement-text:#111418;--color-admonition-title--note:#448aff;--color-admonition-title-background--note:#448aff10}@media not print{body[data-theme=dark]{--color-code-background:#232629;--color-code-foreground:#ccc;--color-announcement-background:#935610;--color-announcement-text:#fff}@media (prefers-color-scheme:dark){body:not([data-theme=light]){--color-code-background:#232629;--color-code-foreground:#ccc;--color-announcement-background:#935610;--color-announcement-text:#fff}}}</style><body><script>document.body.dataset.theme = localStorage.getItem("theme") || "auto";</script><svg style=display:none xmlns=http://www.w3.org/2000/svg><symbol viewbox="0 0 24 24"id=svg-toc><title>Contents</title><svg viewbox="0 0 1024 1024"fill=currentColor stroke=currentColor stroke-width=0><path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/></svg></symbol><symbol viewbox="0 0 24 24"id=svg-menu><title>Menu</title><svg viewbox="0 0 24 24"class=feather-menu fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 xmlns=http://www.w3.org/2000/svg><line x1=3 x2=21 y1=12 y2=12></line><line x1=3 x2=21 y1=6 y2=6></line><line x1=3 x2=21 y1=18 y2=18></line></svg></symbol><symbol viewbox="0 0 24 24"id=svg-arrow-right><title>Expand</title><svg viewbox="0 0 24 24"class=feather-chevron-right fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 xmlns=http://www.w3.org/2000/svg><polyline points="9 18 15 12 9 6"></polyline></svg></symbol><symbol viewbox="0 0 24 24"id=svg-sun><title>Light mode</title><svg viewbox="0 0 24 24"class=feather-sun fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=1.5 xmlns=http://www.w3.org/2000/svg><circle cx=12 cy=12 r=5></circle><line x1=12 x2=12 y1=1 y2=3></line><line x1=12 x2=12 y1=21 y2=23></line><line x1=4.22 x2=5.64 y1=4.22 y2=5.64></line><line x1=18.36 x2=19.78 y1=18.36 y2=19.78></line><line x1=1 x2=3 y1=12 y2=12></line><line x1=21 x2=23 y1=12 y2=12></line><line x1=4.22 x2=5.64 y1=19.78 y2=18.36></line><line x1=18.36 x2=19.78 y1=5.64 y2=4.22></line></svg></symbol><symbol viewbox="0 0 24 24"id=svg-moon><title>Dark mode</title><svg viewbox="0 0 24 24"class=icon-tabler-moon fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=1.5 xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0z"fill=none stroke=none /><path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"/></svg></symbol><symbol viewbox="0 0 24 24"id=svg-sun-half><title>Auto light/dark mode</title><svg viewbox="0 0 24 24"class=icon-tabler-shadow fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=1.5 xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0z"fill=none stroke=none /><circle cx=12 cy=12 r=9 /><path d="M13 12h5"/><path d="M13 15h4"/><path d="M13 18h1"/><path d="M13 9h4"/><path d="M13 6h1"/></svg></symbol></svg><input class=sidebar-toggle id=__navigation name=__navigation type=checkbox><input class=sidebar-toggle id=__toc name=__toc type=checkbox><label class="overlay sidebar-overlay"for=__navigation><div class=visually-hidden>Hide navigation sidebar</div></label><label class="overlay toc-overlay"for=__toc><div class=visually-hidden>Hide table of contents sidebar</div></label><div class=page><header class=mobile-header><div class=header-left><label class=nav-overlay-icon for=__navigation><div class=visually-hidden>Toggle site navigation sidebar</div> <i class=icon><svg><use href=#svg-menu></use></svg></i></label></div><div class=header-center><a href=../../index.html><div class=brand>Nilearn</div></a></div><div class=header-right><div class="theme-toggle-container theme-toggle-header"><button class=theme-toggle><div class=visually-hidden>Toggle Light / Dark / Auto color theme</div> <svg class=theme-icon-when-auto><use href=#svg-sun-half></use></svg> <svg class=theme-icon-when-dark><use href=#svg-moon></use></svg> <svg class=theme-icon-when-light><use href=#svg-sun></use></svg></button></div><label class="toc-overlay-icon toc-header-icon"for=__toc><div class=visually-hidden>Toggle table of contents sidebar</div> <i class=icon><svg><use href=#svg-toc></use></svg></i></label></div></header><aside class=sidebar-drawer><div class=sidebar-container><div class=sidebar-sticky><a class=sidebar-brand href=../../index.html> <div class=sidebar-logo-container><img alt=Logo class=sidebar-logo src=../../_static/nilearn-transparent.png></div> <span class=sidebar-brand-text>Nilearn</span> </a><form action=../../search.html class=sidebar-search-container role=search><input aria-label=Search class=sidebar-search name=q placeholder=Search><input name=check_keywords type=hidden value=yes><input name=area type=hidden value=default></form><div id=searchbox></div><div class=sidebar-scroll><div class=sidebar-tree><ul class=current><li class=toctree-l1><a class="reference internal"href=../../quickstart.html>Quickstart</a></li><li class="toctree-l1 current has-children"><a class="reference internal"href=../index.html>Examples</a><input checked class=toctree-checkbox id=toctree-checkbox-1 name=toctree-checkbox-1 role=switch type=checkbox><label for=toctree-checkbox-1><div class=visually-hidden>Toggle navigation of Examples</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul class=current><li class="toctree-l2 has-children"><a class="reference internal"href=../00_tutorials/index.html>Basic tutorials</a><input class=toctree-checkbox id=toctree-checkbox-2 name=toctree-checkbox-2 role=switch type=checkbox><label for=toctree-checkbox-2><div class=visually-hidden>Toggle navigation of Basic tutorials</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../00_tutorials/plot_python_101.html>Basic numerics and plotting with Python</a></li><li class=toctree-l3><a class="reference internal"href=../00_tutorials/plot_nilearn_101.html>Basic nilearn example: manipulating and looking at data</a></li><li class=toctree-l3><a class="reference internal"href=../00_tutorials/plot_3d_and_4d_niimg.html>3D and 4D niimgs: handling and visualizing</a></li><li class=toctree-l3><a class="reference internal"href=../00_tutorials/plot_decoding_tutorial.html>A introduction tutorial to fMRI decoding</a></li><li class=toctree-l3><a class="reference internal"href=../00_tutorials/plot_single_subject_single_run.html>Intro to GLM Analysis: a single-session, single-subject fMRI dataset</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../01_plotting/index.html>Visualization of brain images</a><input class=toctree-checkbox id=toctree-checkbox-3 name=toctree-checkbox-3 role=switch type=checkbox><label for=toctree-checkbox-3><div class=visually-hidden>Toggle navigation of Visualization of brain images</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_demo_glass_brain.html>Glass brain plotting in nilearn</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_visualize_megatrawls_netmats.html>Visualizing Megatrawls Network Matrices from Human Connectome Project</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_prob_atlas.html>Visualizing 4D probabilistic atlas maps</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_atlas.html>Basic Atlas plotting</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_overlay.html>Visualizing a probabilistic atlas: the default mode in the MSDL atlas</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_dim_plotting.html>Controlling the contrast of the background when plotting</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_multiscale_parcellations.html>Visualizing multiscale functional brain parcellations</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_colormaps.html>Matplotlib colormaps in Nilearn</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_visualization.html>NeuroImaging volumes visualization</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_carpet.html>Visualizing global patterns with a carpet plot</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_haxby_masks.html>Plot Haxby masks</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_surface_projection_strategies.html>Technical point: Illustration of the volume to surface sampling schemes</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_demo_plotting.html>Plotting tools in nilearn</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_surf_atlas.html>Loading and plotting of a cortical surface atlas</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_demo_glass_brain_extensive.html>Glass brain plotting in nilearn (all options)</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_demo_more_plotting.html>More plotting tools from nilearn</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_3d_map_to_surface_projection.html>Making a surface plot of a 3D statistical map</a></li><li class=toctree-l3><a class="reference internal"href=../01_plotting/plot_surf_stat_map.html>Seed-based connectivity on the surface</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../02_decoding/index.html>Decoding and predicting from brain images</a><input class=toctree-checkbox id=toctree-checkbox-4 name=toctree-checkbox-4 role=switch type=checkbox><label for=toctree-checkbox-4><div class=visually-hidden>Toggle navigation of Decoding and predicting from brain images</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_haxby_stimuli.html>Show stimuli of Haxby et al. dataset</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_mixed_gambles_frem.html>FREM on Jimura et al “mixed gambles” dataset</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_oasis_vbm_space_net.html>Voxel-Based Morphometry on Oasis dataset with Space-Net prior</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_haxby_searchlight_surface.html>Cortical surface-based searchlight decoding</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_haxby_anova_svm.html>Decoding with ANOVA + SVM: face vs house in the Haxby dataset</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_haxby_frem.html>Decoding with FREM: face vs house vs chair object recognition</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_haxby_multiclass.html>The haxby dataset: different multi-class strategies</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_haxby_searchlight.html>Searchlight analysis of face vs house recognition</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_haxby_glm_decoding.html>Decoding of a dataset after GLM fit for signal extraction</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_haxby_full_analysis.html>ROI-based decoding analysis in Haxby et al. dataset</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_haxby_grid_search.html>Setting a parameter by cross-validation</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_oasis_vbm.html>Voxel-Based Morphometry on Oasis dataset</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_haxby_different_estimators.html>Different classifiers in decoding the Haxby dataset</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_simulated_data.html>Example of pattern recognition on simulated data</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_miyawaki_encoding.html>Encoding models for visual stimuli from Miyawaki et al. 2008</a></li><li class=toctree-l3><a class="reference internal"href=../02_decoding/plot_miyawaki_reconstruction.html>Reconstruction of visual stimuli from Miyawaki et al. 2008</a></li></ul></li><li class="toctree-l2 current has-children"><a class="reference internal"href=index.html>Functional connectivity</a><input checked class=toctree-checkbox id=toctree-checkbox-5 name=toctree-checkbox-5 role=switch type=checkbox><label for=toctree-checkbox-5><div class=visually-hidden>Toggle navigation of Functional connectivity</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul class=current><li class=toctree-l3><a class="reference internal"href=plot_inverse_covariance_connectome.html>Computing a connectome with sparse inverse covariance</a></li><li class=toctree-l3><a class="reference internal"href=plot_probabilistic_atlas_extraction.html>Extracting signals of a probabilistic atlas of functional regions</a></li><li class=toctree-l3><a class="reference internal"href=plot_simulated_connectome.html>Connectivity structure estimation on simulated data</a></li><li class=toctree-l3><a class="reference internal"href=plot_compare_decomposition.html>Deriving spatial maps from group fMRI data using ICA and Dictionary Learning</a></li><li class=toctree-l3><a class="reference internal"href=plot_seed_to_voxel_correlation.html>Producing single subject maps of seed-to-voxel correlation</a></li><li class=toctree-l3><a class="reference internal"href=plot_multi_subject_connectome.html>Group Sparse inverse covariance for multi-subject connectome</a></li><li class=toctree-l3><a class="reference internal"href=plot_extract_regions_dictlearning_maps.html>Regions extraction using dictionary learning and functional connectomes</a></li><li class=toctree-l3><a class="reference internal"href=plot_atlas_comparison.html>Comparing connectomes on different reference atlases</a></li><li class=toctree-l3><a class="reference internal"href=plot_group_level_connectivity.html>Classification of age groups using functional connectivity</a></li><li class=toctree-l3><a class="reference internal"href=plot_signal_extraction.html>Extracting signals from a brain parcellation</a></li><li class=toctree-l3><a class="reference internal"href=plot_sphere_based_connectome.html>Extract signals on spheres and plot a connectome</a></li><li class="toctree-l3 current current-page"><a class="current reference internal"href=#>Clustering methods to learn a brain parcellation from fMRI</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../04_glm_first_level/index.html>GLM: First level analysis</a><input class=toctree-checkbox id=toctree-checkbox-6 name=toctree-checkbox-6 role=switch type=checkbox><label for=toctree-checkbox-6><div class=visually-hidden>Toggle navigation of GLM: First level analysis</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../04_glm_first_level/plot_fixed_effects.html>Example of explicit fixed effects fMRI model fitting</a></li><li class=toctree-l3><a class="reference internal"href=../04_glm_first_level/plot_write_events_file.html>Generate an events.tsv file for the NeuroSpin localizer task</a></li><li class=toctree-l3><a class="reference internal"href=../04_glm_first_level/plot_adhd_dmn.html>Default Mode Network extraction of ADHD dataset</a></li><li class=toctree-l3><a class="reference internal"href=../04_glm_first_level/plot_design_matrix.html>Examples of design matrices</a></li><li class=toctree-l3><a class="reference internal"href=../04_glm_first_level/plot_fir_model.html>Analysis of an fMRI dataset with a Finite Impule Response (FIR) model</a></li><li class=toctree-l3><a class="reference internal"href=../04_glm_first_level/plot_spm_multimodal_faces.html>Single-subject data (two sessions) in native space</a></li><li class=toctree-l3><a class="reference internal"href=../04_glm_first_level/plot_hrf.html>Example of MRI response functions</a></li><li class=toctree-l3><a class="reference internal"href=../04_glm_first_level/plot_fiac_analysis.html>Simple example of two-session fMRI model fitting</a></li><li class=toctree-l3><a class="reference internal"href=../04_glm_first_level/plot_predictions_residuals.html>Predicted time series and residuals</a></li><li class=toctree-l3><a class="reference internal"href=../04_glm_first_level/plot_bids_features.html>First level analysis of a complete BIDS dataset from openneuro</a></li><li class=toctree-l3><a class="reference internal"href=../04_glm_first_level/plot_localizer_surface_analysis.html>Example of surface-based first-level analysis</a></li><li class=toctree-l3><a class="reference internal"href=../04_glm_first_level/plot_first_level_details.html>Understanding parameters of the first-level model</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../05_glm_second_level/index.html>GLM: Second level analysis</a><input class=toctree-checkbox id=toctree-checkbox-7 name=toctree-checkbox-7 role=switch type=checkbox><label for=toctree-checkbox-7><div class=visually-hidden>Toggle navigation of GLM: Second level analysis</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../05_glm_second_level/plot_second_level_design_matrix.html>Example of second level design matrix</a></li><li class=toctree-l3><a class="reference internal"href=../05_glm_second_level/plot_proportion_activated_voxels.html>Second-level fMRI model: true positive proportion in clusters</a></li><li class=toctree-l3><a class="reference internal"href=../05_glm_second_level/plot_thresholding.html>Statistical testing of a second-level analysis</a></li><li class=toctree-l3><a class="reference internal"href=../05_glm_second_level/plot_oasis.html>Voxel-Based Morphometry on OASIS dataset</a></li><li class=toctree-l3><a class="reference internal"href=../05_glm_second_level/plot_second_level_two_sample_test.html>Second-level fMRI model: two-sample test, unpaired and paired</a></li><li class=toctree-l3><a class="reference internal"href=../05_glm_second_level/plot_second_level_one_sample_test.html>Second-level fMRI model: one sample test</a></li><li class=toctree-l3><a class="reference internal"href=../05_glm_second_level/plot_second_level_association_test.html>Example of generic design in second-level models</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../06_manipulating_images/index.html>Manipulating brain image volumes</a><input class=toctree-checkbox id=toctree-checkbox-8 name=toctree-checkbox-8 role=switch type=checkbox><label for=toctree-checkbox-8><div class=visually-hidden>Toggle navigation of Manipulating brain image volumes</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../06_manipulating_images/plot_negate_image.html>Negating an image with math_img</a></li><li class=toctree-l3><a class="reference internal"href=../06_manipulating_images/plot_compare_mean_image.html>Comparing the means of 2 images</a></li><li class=toctree-l3><a class="reference internal"href=../06_manipulating_images/plot_smooth_mean_image.html>Smoothing an image</a></li><li class=toctree-l3><a class="reference internal"href=../06_manipulating_images/plot_extract_regions_labels_image.html>Breaking an atlas of labels in separated regions</a></li><li class=toctree-l3><a class="reference internal"href=../06_manipulating_images/plot_resample_to_template.html>Resample an image to a template</a></li><li class=toctree-l3><a class="reference internal"href=../06_manipulating_images/plot_extract_rois_smith_atlas.html>Regions Extraction of Default Mode Networks using Smith Atlas</a></li><li class=toctree-l3><a class="reference internal"href=../06_manipulating_images/plot_nifti_simple.html>Simple example of NiftiMasker use</a></li><li class=toctree-l3><a class="reference internal"href=../06_manipulating_images/plot_nifti_labels_simple.html>Extracting signals from brain regions using the NiftiLabelsMasker</a></li><li class=toctree-l3><a class="reference internal"href=../06_manipulating_images/plot_extract_rois_statistical_maps.html>Region Extraction using a t-statistical map (3D)</a></li><li class=toctree-l3><a class="reference internal"href=../06_manipulating_images/plot_mask_computation.html>Understanding NiftiMasker and mask computation</a></li><li class=toctree-l3><a class="reference internal"href=../06_manipulating_images/plot_affine_transformation.html>Visualization of affine resamplings</a></li><li class=toctree-l3><a class="reference internal"href=../06_manipulating_images/plot_roi_extraction.html>Computing a Region of Interest (ROI) mask manually</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../07_advanced/index.html>Advanced statistical analysis of brain images</a><input class=toctree-checkbox id=toctree-checkbox-9 name=toctree-checkbox-9 role=switch type=checkbox><label for=toctree-checkbox-9><div class=visually-hidden>Toggle navigation of Advanced statistical analysis of brain images</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../07_advanced/plot_localizer_simple_analysis.html>Massively univariate analysis of a calculation task from the Localizer dataset</a></li><li class=toctree-l3><a class="reference internal"href=../07_advanced/plot_ica_resting_state.html>Multivariate decompositions: Independent component analysis of fMRI</a></li><li class=toctree-l3><a class="reference internal"href=../07_advanced/plot_bids_analysis.html>BIDS dataset first and second level analysis</a></li><li class=toctree-l3><a class="reference internal"href=../07_advanced/plot_neurovault_meta_analysis.html>NeuroVault meta-analysis of stop-go paradigm studies</a></li><li class=toctree-l3><a class="reference internal"href=../07_advanced/plot_age_group_prediction_cross_val.html>Functional connectivity predicts age group</a></li><li class=toctree-l3><a class="reference internal"href=../07_advanced/plot_localizer_mass_univariate_methods.html>Massively univariate analysis of a motor task from the Localizer dataset</a></li><li class=toctree-l3><a class="reference internal"href=../07_advanced/plot_surface_bids_analysis.html>Surface-based dataset first and second level analysis of a dataset</a></li><li class=toctree-l3><a class="reference internal"href=../07_advanced/plot_ica_neurovault.html>NeuroVault cross-study ICA maps</a></li><li class=toctree-l3><a class="reference internal"href=../07_advanced/plot_haxby_mass_univariate.html>Massively univariate analysis of face vs house recognition</a></li><li class=toctree-l3><a class="reference internal"href=../07_advanced/plot_advanced_decoding_scikit.html>Advanced decoding using scikit learn</a></li><li class=toctree-l3><a class="reference internal"href=../07_advanced/plot_beta_series.html>Beta-Series Modeling for Task-Based Functional Connectivity and Decoding</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../08_experimental/index.html>Examples for experimental modules</a><input class=toctree-checkbox id=toctree-checkbox-10 name=toctree-checkbox-10 role=switch type=checkbox><label for=toctree-checkbox-10><div class=visually-hidden>Toggle navigation of Examples for experimental modules</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../08_experimental/plot_surface_image_and_maskers.html>A short demo of the surface images & maskers</a></li></ul></li></ul></li><li class="toctree-l1 has-children"><a class="reference internal"href=../../user_guide.html>User guide</a><input class=toctree-checkbox id=toctree-checkbox-11 name=toctree-checkbox-11 role=switch type=checkbox><label for=toctree-checkbox-11><div class=visually-hidden>Toggle navigation of User guide</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l2><a class="reference internal"href=../../introduction.html>1. Introduction</a></li><li class=toctree-l2><a class="reference internal"href=../../introduction.html#what-is-nilearn>2. What is <code class="docutils literal notranslate"><span class=pre>nilearn</span></code>?</a></li><li class=toctree-l2><a class="reference internal"href=../../introduction.html#using-nilearn-for-the-first-time>3. Using <code class="docutils literal notranslate"><span class=pre>nilearn</span></code> for the first time</a></li><li class=toctree-l2><a class="reference internal"href=../../introduction.html#machine-learning-applications-to-neuroimaging>4. Machine learning applications to Neuroimaging</a></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../decoding/index.html>5. Decoding and MVPA: predicting from brain images</a><input class=toctree-checkbox id=toctree-checkbox-12 name=toctree-checkbox-12 role=switch type=checkbox><label for=toctree-checkbox-12><div class=visually-hidden>Toggle navigation of 5. Decoding and MVPA: predicting from brain images</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../decoding/decoding_intro.html>5.1. An introduction to decoding</a></li><li class=toctree-l3><a class="reference internal"href=../../decoding/estimator_choice.html>5.2. Choosing the right predictive model for neuroimaging</a></li><li class=toctree-l3><a class="reference internal"href=../../decoding/frem.html>5.3. FREM: fast ensembling of regularized models for robust decoding</a></li><li class=toctree-l3><a class="reference internal"href=../../decoding/space_net.html>5.4. SpaceNet: decoding with spatial structure for better maps</a></li><li class=toctree-l3><a class="reference internal"href=../../decoding/searchlight.html>5.5. Searchlight : finding voxels containing information</a></li><li class=toctree-l3><a class="reference internal"href=../../decoding/going_further.html>5.6. Running scikit-learn functions for more control on the analysis</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../connectivity/index.html>6. Functional connectivity and resting state</a><input class=toctree-checkbox id=toctree-checkbox-13 name=toctree-checkbox-13 role=switch type=checkbox><label for=toctree-checkbox-13><div class=visually-hidden>Toggle navigation of 6. Functional connectivity and resting state</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../connectivity/functional_connectomes.html>6.1. Extracting times series to build a functional connectome</a></li><li class="toctree-l3 has-children"><a class="reference internal"href=../../connectivity/connectome_extraction.html>6.2. Connectome extraction: inverse covariance for direct connections</a><input class=toctree-checkbox id=toctree-checkbox-14 name=toctree-checkbox-14 role=switch type=checkbox><label for=toctree-checkbox-14><div class=visually-hidden>Toggle navigation of 6.2. Connectome extraction: inverse covariance for direct connections</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l4><a class="reference internal"href=../../developers/group_sparse_covariance.html>6.2.3.1. Group-sparse covariance estimation</a></li></ul></li><li class=toctree-l3><a class="reference internal"href=../../connectivity/resting_state_networks.html>6.3. Extracting functional brain networks: ICA and related</a></li><li class=toctree-l3><a class="reference internal"href=../../connectivity/region_extraction.html>6.4. Region Extraction for better brain parcellations</a></li><li class=toctree-l3><a class="reference internal"href=../../connectivity/parcellating.html>6.5. Clustering to parcellate the brain in regions</a></li></ul></li><li class=toctree-l2><a class="reference internal"href=../../plotting/index.html>7. Plotting brain images</a></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../glm/index.html>8. Analyzing fMRI using GLMs</a><input class=toctree-checkbox id=toctree-checkbox-15 name=toctree-checkbox-15 role=switch type=checkbox><label for=toctree-checkbox-15><div class=visually-hidden>Toggle navigation of 8. Analyzing fMRI using GLMs</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../glm/glm_intro.html>8.1. An introduction to GLMs in fMRI statistical analysis</a></li><li class=toctree-l3><a class="reference internal"href=../../glm/first_level_model.html>8.2. First level models</a></li><li class=toctree-l3><a class="reference internal"href=../../glm/second_level_model.html>8.3. Second level models</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../manipulating_images/index.html>9. Manipulation brain volumes with nilearn</a><input class=toctree-checkbox id=toctree-checkbox-16 name=toctree-checkbox-16 role=switch type=checkbox><label for=toctree-checkbox-16><div class=visually-hidden>Toggle navigation of 9. Manipulation brain volumes with nilearn</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../manipulating_images/input_output.html>9.1. Input and output: neuroimaging data representation</a></li><li class=toctree-l3><a class="reference internal"href=../../manipulating_images/manipulating_images.html>9.2. Manipulating images: resampling, smoothing, masking, ROIs…</a></li><li class=toctree-l3><a class="reference internal"href=../../manipulating_images/masker_objects.html>9.3. From neuroimaging volumes to data matrices: the masker objects</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../building_blocks/index.html>10. Advanced usage: manual pipelines and scaling up</a><input class=toctree-checkbox id=toctree-checkbox-17 name=toctree-checkbox-17 role=switch type=checkbox><label for=toctree-checkbox-17><div class=visually-hidden>Toggle navigation of 10. Advanced usage: manual pipelines and scaling up</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../building_blocks/manual_pipeline.html>10.1. Building your own neuroimaging machine-learning pipeline</a></li><li class=toctree-l3><a class="reference internal"href=../../building_blocks/neurovault.html>10.2. Downloading statistical maps from the Neurovault repository</a></li></ul></li></ul></li><li class="toctree-l1 has-children"><a class="reference internal"href=../../modules/index.html>API References</a><input class=toctree-checkbox id=toctree-checkbox-18 name=toctree-checkbox-18 role=switch type=checkbox><label for=toctree-checkbox-18><div class=visually-hidden>Toggle navigation of API References</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/connectome.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.connectome</span></code>: Functional Connectivity</a><input class=toctree-checkbox id=toctree-checkbox-19 name=toctree-checkbox-19 role=switch type=checkbox><label for=toctree-checkbox-19><div class=visually-hidden>Toggle navigation of nilearn.connectome: Functional Connectivity</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.connectome.ConnectivityMeasure.html>nilearn.connectome.ConnectivityMeasure</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.connectome.GroupSparseCovariance.html>nilearn.connectome.GroupSparseCovariance</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.connectome.GroupSparseCovarianceCV.html>nilearn.connectome.GroupSparseCovarianceCV</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.connectome.sym_matrix_to_vec.html>nilearn.connectome.sym_matrix_to_vec</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.connectome.vec_to_sym_matrix.html>nilearn.connectome.vec_to_sym_matrix</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.connectome.group_sparse_covariance.html>nilearn.connectome.group_sparse_covariance</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.connectome.cov_to_corr.html>nilearn.connectome.cov_to_corr</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.connectome.prec_to_partial.html>nilearn.connectome.prec_to_partial</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/datasets.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.datasets</span></code>: Automatic Dataset Fetching</a><input class=toctree-checkbox id=toctree-checkbox-20 name=toctree-checkbox-20 role=switch type=checkbox><label for=toctree-checkbox-20><div class=visually-hidden>Toggle navigation of nilearn.datasets: Automatic Dataset Fetching</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_icbm152_2009.html>nilearn.datasets.fetch_icbm152_2009</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_icbm152_brain_gm_mask.html>nilearn.datasets.fetch_icbm152_brain_gm_mask</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_surf_fsaverage.html>nilearn.datasets.fetch_surf_fsaverage</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.load_mni152_brain_mask.html>nilearn.datasets.load_mni152_brain_mask</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.load_mni152_gm_mask.html>nilearn.datasets.load_mni152_gm_mask</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.load_mni152_gm_template.html>nilearn.datasets.load_mni152_gm_template</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.load_mni152_template.html>nilearn.datasets.load_mni152_template</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.load_mni152_wm_mask.html>nilearn.datasets.load_mni152_wm_mask</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.load_mni152_wm_template.html>nilearn.datasets.load_mni152_wm_template</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_aal.html>nilearn.datasets.fetch_atlas_aal</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_allen_2011.html>nilearn.datasets.fetch_atlas_allen_2011</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_basc_multiscale_2015.html>nilearn.datasets.fetch_atlas_basc_multiscale_2015</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_craddock_2012.html>nilearn.datasets.fetch_atlas_craddock_2012</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_destrieux_2009.html>nilearn.datasets.fetch_atlas_destrieux_2009</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_difumo.html>nilearn.datasets.fetch_atlas_difumo</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_harvard_oxford.html>nilearn.datasets.fetch_atlas_harvard_oxford</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_juelich.html>nilearn.datasets.fetch_atlas_juelich</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_msdl.html>nilearn.datasets.fetch_atlas_msdl</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_pauli_2017.html>nilearn.datasets.fetch_atlas_pauli_2017</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_schaefer_2018.html>nilearn.datasets.fetch_atlas_schaefer_2018</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_smith_2009.html>nilearn.datasets.fetch_atlas_smith_2009</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_surf_destrieux.html>nilearn.datasets.fetch_atlas_surf_destrieux</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_talairach.html>nilearn.datasets.fetch_atlas_talairach</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_atlas_yeo_2011.html>nilearn.datasets.fetch_atlas_yeo_2011</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_coords_dosenbach_2010.html>nilearn.datasets.fetch_coords_dosenbach_2010</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_coords_power_2011.html>nilearn.datasets.fetch_coords_power_2011</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_coords_seitzman_2018.html>nilearn.datasets.fetch_coords_seitzman_2018</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_abide_pcp.html>nilearn.datasets.fetch_abide_pcp</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_adhd.html>nilearn.datasets.fetch_adhd</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_bids_langloc_dataset.html>nilearn.datasets.fetch_bids_langloc_dataset</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_development_fmri.html>nilearn.datasets.fetch_development_fmri</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_ds000030_urls.html>nilearn.datasets.fetch_ds000030_urls</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_fiac_first_level.html>nilearn.datasets.fetch_fiac_first_level</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_haxby.html>nilearn.datasets.fetch_haxby</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_language_localizer_demo_dataset.html>nilearn.datasets.fetch_language_localizer_demo_dataset</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_localizer_first_level.html>nilearn.datasets.fetch_localizer_first_level</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_miyawaki2008.html>nilearn.datasets.fetch_miyawaki2008</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_openneuro_dataset_index.html>nilearn.datasets.fetch_openneuro_dataset_index</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_spm_auditory.html>nilearn.datasets.fetch_spm_auditory</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_spm_multimodal_fmri.html>nilearn.datasets.fetch_spm_multimodal_fmri</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_surf_nki_enhanced.html>nilearn.datasets.fetch_surf_nki_enhanced</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_localizer_button_task.html>nilearn.datasets.fetch_localizer_button_task</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_localizer_calculation_task.html>nilearn.datasets.fetch_localizer_calculation_task</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_localizer_contrasts.html>nilearn.datasets.fetch_localizer_contrasts</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_megatrawls_netmats.html>nilearn.datasets.fetch_megatrawls_netmats</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_mixed_gambles.html>nilearn.datasets.fetch_mixed_gambles</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_oasis_vbm.html>nilearn.datasets.fetch_oasis_vbm</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_neurovault_auditory_computation_task.html>nilearn.datasets.fetch_neurovault_auditory_computation_task</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_neurovault_motor_task.html>nilearn.datasets.fetch_neurovault_motor_task</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_neurovault.html>nilearn.datasets.fetch_neurovault</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_neurovault_ids.html>nilearn.datasets.fetch_neurovault_ids</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_openneuro_dataset.html>nilearn.datasets.fetch_openneuro_dataset</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.get_data_dirs.html>nilearn.datasets.get_data_dirs</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.patch_openneuro_dataset.html>nilearn.datasets.patch_openneuro_dataset</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.select_from_index.html>nilearn.datasets.select_from_index</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.datasets.load_sample_motor_activation_image.html>nilearn.datasets.load_sample_motor_activation_image</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/decoding.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.decoding</span></code>: Decoding</a><input class=toctree-checkbox id=toctree-checkbox-21 name=toctree-checkbox-21 role=switch type=checkbox><label for=toctree-checkbox-21><div class=visually-hidden>Toggle navigation of nilearn.decoding: Decoding</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.decoding.Decoder.html>nilearn.decoding.Decoder</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.decoding.DecoderRegressor.html>nilearn.decoding.DecoderRegressor</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.decoding.FREMClassifier.html>nilearn.decoding.FREMClassifier</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.decoding.FREMRegressor.html>nilearn.decoding.FREMRegressor</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.decoding.SpaceNetClassifier.html>nilearn.decoding.SpaceNetClassifier</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.decoding.SpaceNetRegressor.html>nilearn.decoding.SpaceNetRegressor</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.decoding.SearchLight.html>nilearn.decoding.SearchLight</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/decomposition.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.decomposition</span></code>: Multivariate Decompositions</a><input class=toctree-checkbox id=toctree-checkbox-22 name=toctree-checkbox-22 role=switch type=checkbox><label for=toctree-checkbox-22><div class=visually-hidden>Toggle navigation of nilearn.decomposition: Multivariate Decompositions</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.decomposition.CanICA.html>nilearn.decomposition.CanICA</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.decomposition.DictLearning.html>nilearn.decomposition.DictLearning</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/experimental.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.experimental</span></code>: Experimental Modules</a><input class=toctree-checkbox id=toctree-checkbox-23 name=toctree-checkbox-23 role=switch type=checkbox><label for=toctree-checkbox-23><div class=visually-hidden>Toggle navigation of nilearn.experimental: Experimental Modules</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.experimental.surface.FileMesh.html>nilearn.experimental.surface.FileMesh</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.experimental.surface.InMemoryMesh.html>nilearn.experimental.surface.InMemoryMesh</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.experimental.surface.Mesh.html>nilearn.experimental.surface.Mesh</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.experimental.surface.PolyMesh.html>nilearn.experimental.surface.PolyMesh</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.experimental.surface.SurfaceImage.html>nilearn.experimental.surface.SurfaceImage</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.experimental.surface.SurfaceLabelsMasker.html>nilearn.experimental.surface.SurfaceLabelsMasker</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.experimental.surface.SurfaceMasker.html>nilearn.experimental.surface.SurfaceMasker</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.experimental.surface.fetch_destrieux.html>nilearn.experimental.surface.fetch_destrieux</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.experimental.surface.fetch_nki.html>nilearn.experimental.surface.fetch_nki</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.experimental.surface.load_fsaverage.html>nilearn.experimental.surface.load_fsaverage</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/glm.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.glm</span></code>: Generalized Linear Models</a><input class=toctree-checkbox id=toctree-checkbox-24 name=toctree-checkbox-24 role=switch type=checkbox><label for=toctree-checkbox-24><div class=visually-hidden>Toggle navigation of nilearn.glm: Generalized Linear Models</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.Contrast.html>nilearn.glm.Contrast</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.FContrastResults.html>nilearn.glm.FContrastResults</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.TContrastResults.html>nilearn.glm.TContrastResults</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.ARModel.html>nilearn.glm.ARModel</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.OLSModel.html>nilearn.glm.OLSModel</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.LikelihoodModelResults.html>nilearn.glm.LikelihoodModelResults</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.RegressionResults.html>nilearn.glm.RegressionResults</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.SimpleRegressionResults.html>nilearn.glm.SimpleRegressionResults</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.compute_contrast.html>nilearn.glm.compute_contrast</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.compute_fixed_effects.html>nilearn.glm.compute_fixed_effects</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.expression_to_contrast_vector.html>nilearn.glm.expression_to_contrast_vector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.fdr_threshold.html>nilearn.glm.fdr_threshold</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.cluster_level_inference.html>nilearn.glm.cluster_level_inference</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.threshold_stats_img.html>nilearn.glm.threshold_stats_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.FirstLevelModel.html>nilearn.glm.first_level.FirstLevelModel</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.check_design_matrix.html>nilearn.glm.first_level.check_design_matrix</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.compute_regressor.html>nilearn.glm.first_level.compute_regressor</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.first_level_from_bids.html>nilearn.glm.first_level.first_level_from_bids</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.glover_dispersion_derivative.html>nilearn.glm.first_level.glover_dispersion_derivative</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.glover_hrf.html>nilearn.glm.first_level.glover_hrf</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.glover_time_derivative.html>nilearn.glm.first_level.glover_time_derivative</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.make_first_level_design_matrix.html>nilearn.glm.first_level.make_first_level_design_matrix</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.mean_scaling.html>nilearn.glm.first_level.mean_scaling</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.run_glm.html>nilearn.glm.first_level.run_glm</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.spm_dispersion_derivative.html>nilearn.glm.first_level.spm_dispersion_derivative</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.spm_hrf.html>nilearn.glm.first_level.spm_hrf</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.first_level.spm_time_derivative.html>nilearn.glm.first_level.spm_time_derivative</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.second_level.SecondLevelModel.html>nilearn.glm.second_level.SecondLevelModel</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.second_level.make_second_level_design_matrix.html>nilearn.glm.second_level.make_second_level_design_matrix</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.glm.second_level.non_parametric_inference.html>nilearn.glm.second_level.non_parametric_inference</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/image.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.image</span></code>: Image Processing and Resampling Utilities</a><input class=toctree-checkbox id=toctree-checkbox-25 name=toctree-checkbox-25 role=switch type=checkbox><label for=toctree-checkbox-25><div class=visually-hidden>Toggle navigation of nilearn.image: Image Processing and Resampling Utilities</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.binarize_img.html>nilearn.image.binarize_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.clean_img.html>nilearn.image.clean_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.concat_imgs.html>nilearn.image.concat_imgs</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.coord_transform.html>nilearn.image.coord_transform</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.copy_img.html>nilearn.image.copy_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.crop_img.html>nilearn.image.crop_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.get_data.html>nilearn.image.get_data</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.high_variance_confounds.html>nilearn.image.high_variance_confounds</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.index_img.html>nilearn.image.index_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.iter_img.html>nilearn.image.iter_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.largest_connected_component_img.html>nilearn.image.largest_connected_component_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.load_img.html>nilearn.image.load_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.math_img.html>nilearn.image.math_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.mean_img.html>nilearn.image.mean_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.new_img_like.html>nilearn.image.new_img_like</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.resample_img.html>nilearn.image.resample_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.resample_to_img.html>nilearn.image.resample_to_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.reorder_img.html>nilearn.image.reorder_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.smooth_img.html>nilearn.image.smooth_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.swap_img_hemispheres.html>nilearn.image.swap_img_hemispheres</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.image.threshold_img.html>nilearn.image.threshold_img</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/interfaces.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.interfaces</span></code>: Loading components from interfaces</a><input class=toctree-checkbox id=toctree-checkbox-26 name=toctree-checkbox-26 role=switch type=checkbox><label for=toctree-checkbox-26><div class=visually-hidden>Toggle navigation of nilearn.interfaces: Loading components from interfaces</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.interfaces.bids.get_bids_files.html>nilearn.interfaces.bids.get_bids_files</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.interfaces.bids.parse_bids_filename.html>nilearn.interfaces.bids.parse_bids_filename</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.interfaces.bids.save_glm_to_bids.html>nilearn.interfaces.bids.save_glm_to_bids</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.interfaces.fmriprep.load_confounds.html>nilearn.interfaces.fmriprep.load_confounds</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.interfaces.fmriprep.load_confounds_strategy.html>nilearn.interfaces.fmriprep.load_confounds_strategy</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.interfaces.fsl.get_design_from_fslmat.html>nilearn.interfaces.fsl.get_design_from_fslmat</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/maskers.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.maskers</span></code>: Extracting Signals from Brain Images</a><input class=toctree-checkbox id=toctree-checkbox-27 name=toctree-checkbox-27 role=switch type=checkbox><label for=toctree-checkbox-27><div class=visually-hidden>Toggle navigation of nilearn.maskers: Extracting Signals from Brain Images</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.maskers.BaseMasker.html>nilearn.maskers.BaseMasker</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.maskers.NiftiMasker.html>nilearn.maskers.NiftiMasker</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.maskers.MultiNiftiMasker.html>nilearn.maskers.MultiNiftiMasker</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.maskers.NiftiLabelsMasker.html>nilearn.maskers.NiftiLabelsMasker</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.maskers.MultiNiftiLabelsMasker.html>nilearn.maskers.MultiNiftiLabelsMasker</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.maskers.NiftiMapsMasker.html>nilearn.maskers.NiftiMapsMasker</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.maskers.MultiNiftiMapsMasker.html>nilearn.maskers.MultiNiftiMapsMasker</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.maskers.NiftiSpheresMasker.html>nilearn.maskers.NiftiSpheresMasker</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/masking.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.masking</span></code>: Data Masking Utilities</a><input class=toctree-checkbox id=toctree-checkbox-28 name=toctree-checkbox-28 role=switch type=checkbox><label for=toctree-checkbox-28><div class=visually-hidden>Toggle navigation of nilearn.masking: Data Masking Utilities</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.masking.compute_epi_mask.html>nilearn.masking.compute_epi_mask</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.masking.compute_multi_epi_mask.html>nilearn.masking.compute_multi_epi_mask</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.masking.compute_brain_mask.html>nilearn.masking.compute_brain_mask</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.masking.compute_multi_brain_mask.html>nilearn.masking.compute_multi_brain_mask</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.masking.compute_background_mask.html>nilearn.masking.compute_background_mask</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.masking.compute_multi_background_mask.html>nilearn.masking.compute_multi_background_mask</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.masking.intersect_masks.html>nilearn.masking.intersect_masks</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.masking.apply_mask.html>nilearn.masking.apply_mask</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.masking.unmask.html>nilearn.masking.unmask</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/mass_univariate.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.mass_univariate</span></code>: Mass-Univariate Analysis</a><input class=toctree-checkbox id=toctree-checkbox-29 name=toctree-checkbox-29 role=switch type=checkbox><label for=toctree-checkbox-29><div class=visually-hidden>Toggle navigation of nilearn.mass_univariate: Mass-Univariate Analysis</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.mass_univariate.permuted_ols.html>nilearn.mass_univariate.permuted_ols</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/plotting.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.plotting</span></code>: Plotting Brain Data</a><input class=toctree-checkbox id=toctree-checkbox-30 name=toctree-checkbox-30 role=switch type=checkbox><label for=toctree-checkbox-30><div class=visually-hidden>Toggle navigation of nilearn.plotting: Plotting Brain Data</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.find_cut_slices.html>nilearn.plotting.find_cut_slices</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.find_xyz_cut_coords.html>nilearn.plotting.find_xyz_cut_coords</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.find_parcellation_cut_coords.html>nilearn.plotting.find_parcellation_cut_coords</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.find_probabilistic_atlas_cut_coords.html>nilearn.plotting.find_probabilistic_atlas_cut_coords</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_anat.html>nilearn.plotting.plot_anat</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_img.html>nilearn.plotting.plot_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_epi.html>nilearn.plotting.plot_epi</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_matrix.html>nilearn.plotting.plot_matrix</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_roi.html>nilearn.plotting.plot_roi</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_stat_map.html>nilearn.plotting.plot_stat_map</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_glass_brain.html>nilearn.plotting.plot_glass_brain</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_connectome.html>nilearn.plotting.plot_connectome</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_markers.html>nilearn.plotting.plot_markers</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_prob_atlas.html>nilearn.plotting.plot_prob_atlas</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_carpet.html>nilearn.plotting.plot_carpet</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_surf.html>nilearn.plotting.plot_surf</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_surf_roi.html>nilearn.plotting.plot_surf_roi</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_surf_contours.html>nilearn.plotting.plot_surf_contours</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_surf_stat_map.html>nilearn.plotting.plot_surf_stat_map</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_img_on_surf.html>nilearn.plotting.plot_img_on_surf</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_img_comparison.html>nilearn.plotting.plot_img_comparison</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_design_matrix.html>nilearn.plotting.plot_design_matrix</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_event.html>nilearn.plotting.plot_event</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.plot_contrast_matrix.html>nilearn.plotting.plot_contrast_matrix</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.view_surf.html>nilearn.plotting.view_surf</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.view_img_on_surf.html>nilearn.plotting.view_img_on_surf</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.view_connectome.html>nilearn.plotting.view_connectome</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.view_markers.html>nilearn.plotting.view_markers</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.view_img.html>nilearn.plotting.view_img</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.show.html>nilearn.plotting.show</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.get_projector.html>nilearn.plotting.displays.get_projector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.get_slicer.html>nilearn.plotting.displays.get_slicer</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.OrthoProjector.html>nilearn.plotting.displays.OrthoProjector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.XZProjector.html>nilearn.plotting.displays.XZProjector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.YZProjector.html>nilearn.plotting.displays.YZProjector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.YXProjector.html>nilearn.plotting.displays.YXProjector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.XProjector.html>nilearn.plotting.displays.XProjector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.YProjector.html>nilearn.plotting.displays.YProjector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.ZProjector.html>nilearn.plotting.displays.ZProjector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.LZRYProjector.html>nilearn.plotting.displays.LZRYProjector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.LYRZProjector.html>nilearn.plotting.displays.LYRZProjector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.LYRProjector.html>nilearn.plotting.displays.LYRProjector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.LZRProjector.html>nilearn.plotting.displays.LZRProjector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.LRProjector.html>nilearn.plotting.displays.LRProjector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.LProjector.html>nilearn.plotting.displays.LProjector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.RProjector.html>nilearn.plotting.displays.RProjector</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.BaseAxes.html>nilearn.plotting.displays.BaseAxes</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.CutAxes.html>nilearn.plotting.displays.CutAxes</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.GlassBrainAxes.html>nilearn.plotting.displays.GlassBrainAxes</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.BaseSlicer.html>nilearn.plotting.displays.BaseSlicer</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.OrthoSlicer.html>nilearn.plotting.displays.OrthoSlicer</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.PlotlySurfaceFigure.html>nilearn.plotting.displays.PlotlySurfaceFigure</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.TiledSlicer.html>nilearn.plotting.displays.TiledSlicer</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.MosaicSlicer.html>nilearn.plotting.displays.MosaicSlicer</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.XZSlicer.html>nilearn.plotting.displays.XZSlicer</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.YZSlicer.html>nilearn.plotting.displays.YZSlicer</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.YXSlicer.html>nilearn.plotting.displays.YXSlicer</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.XSlicer.html>nilearn.plotting.displays.XSlicer</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.YSlicer.html>nilearn.plotting.displays.YSlicer</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.plotting.displays.ZSlicer.html>nilearn.plotting.displays.ZSlicer</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/regions.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.regions</span></code>: Operating on Regions</a><input class=toctree-checkbox id=toctree-checkbox-31 name=toctree-checkbox-31 role=switch type=checkbox><label for=toctree-checkbox-31><div class=visually-hidden>Toggle navigation of nilearn.regions: Operating on Regions</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.regions.connected_regions.html>nilearn.regions.connected_regions</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.regions.connected_label_regions.html>nilearn.regions.connected_label_regions</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.regions.img_to_signals_labels.html>nilearn.regions.img_to_signals_labels</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.regions.signals_to_img_labels.html>nilearn.regions.signals_to_img_labels</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.regions.img_to_signals_maps.html>nilearn.regions.img_to_signals_maps</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.regions.signals_to_img_maps.html>nilearn.regions.signals_to_img_maps</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.regions.recursive_neighbor_agglomeration.html>nilearn.regions.recursive_neighbor_agglomeration</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.regions.RegionExtractor.html>nilearn.regions.RegionExtractor</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.regions.Parcellations.html>nilearn.regions.Parcellations</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.regions.ReNA.html>nilearn.regions.ReNA</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.regions.HierarchicalKMeans.html>nilearn.regions.HierarchicalKMeans</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/reporting.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.reporting</span></code>: Reporting Functions</a><input class=toctree-checkbox id=toctree-checkbox-32 name=toctree-checkbox-32 role=switch type=checkbox><label for=toctree-checkbox-32><div class=visually-hidden>Toggle navigation of nilearn.reporting: Reporting Functions</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.reporting.HTMLReport.html>nilearn.reporting.HTMLReport</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.reporting.get_clusters_table.html>nilearn.reporting.get_clusters_table</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.reporting.make_glm_report.html>nilearn.reporting.make_glm_report</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/signal.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.signal</span></code>: Preprocessing Time Series</a><input class=toctree-checkbox id=toctree-checkbox-33 name=toctree-checkbox-33 role=switch type=checkbox><label for=toctree-checkbox-33><div class=visually-hidden>Toggle navigation of nilearn.signal: Preprocessing Time Series</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.signal.butterworth.html>nilearn.signal.butterworth</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.signal.clean.html>nilearn.signal.clean</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.signal.high_variance_confounds.html>nilearn.signal.high_variance_confounds</a></li></ul></li><li class="toctree-l2 has-children"><a class="reference internal"href=../../modules/surface.html><code class="xref py py-mod docutils literal notranslate"><span class=pre>nilearn.surface</span></code>: Manipulating Surface Data</a><input class=toctree-checkbox id=toctree-checkbox-34 name=toctree-checkbox-34 role=switch type=checkbox><label for=toctree-checkbox-34><div class=visually-hidden>Toggle navigation of nilearn.surface: Manipulating Surface Data</div><i class=icon><svg><use href=#svg-arrow-right></use></svg></i></label><ul><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.surface.load_surf_data.html>nilearn.surface.load_surf_data</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.surface.load_surf_mesh.html>nilearn.surface.load_surf_mesh</a></li><li class=toctree-l3><a class="reference internal"href=../../modules/generated/nilearn.surface.vol_to_surf.html>nilearn.surface.vol_to_surf</a></li></ul></li></ul></li><li class=toctree-l1><a class="reference internal"href=../../glossary.html>Glossary</a></li></ul><p class=caption role=heading><span class=caption-text>Development</span></p><ul><li class=toctree-l1><a class="reference internal"href=../../development.html>Contributing</a></li><li class=toctree-l1><a class="reference internal"href=../../maintenance.html>Maintenance</a></li><li class=toctree-l1><a class="reference internal"href=../../changes/whats_new.html>What’s new</a></li><li class=toctree-l1><a class="reference internal"href=../../authors.html>Team</a></li><li class=toctree-l1><a class="reference external"href=https://github.com/nilearn/nilearn>GitHub Repository</a></li></ul></div></div></div></div></aside><div class=main><div class=content><div class=article-container><a class="back-to-top muted-link"href=#> <svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path></svg> <span>Back to top</span> </a><div class=content-icon-container><div class=edit-this-page><a title="Edit this page"class=muted-link href=https://github.com/nilearn/nilearn/edit/main/doc/auto_examples/03_connectivity/plot_data_driven_parcellations.rst> <svg viewbox="0 0 24 24"aria-hidden=true fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=1.5><path d="M0 0h24v24H0z"fill=none stroke=none /><path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4"/><line x1=13.5 x2=17.5 y1=6.5 y2=10.5 /></svg> <span class=visually-hidden>Edit this page</span> </a></div><div class="theme-toggle-container theme-toggle-content"><button class=theme-toggle><div class=visually-hidden>Toggle Light / Dark / Auto color theme</div> <svg class=theme-icon-when-auto><use href=#svg-sun-half></use></svg> <svg class=theme-icon-when-dark><use href=#svg-moon></use></svg> <svg class=theme-icon-when-light><use href=#svg-sun></use></svg></button></div><label class="toc-overlay-icon toc-content-icon"for=__toc><div class=visually-hidden>Toggle table of contents sidebar</div> <i class=icon><svg><use href=#svg-toc></use></svg></i></label></div><article role=main><div class="sphx-glr-download-link-note admonition note"><p class=admonition-title>Note</p><p><a class="reference internal"href=#sphx-glr-download-auto-examples-03-connectivity-plot-data-driven-parcellations-py><span class="std std-ref">Go to the end</span></a> to download the full example code or to run this example in your browser via Binder</p></div><section class=sphx-glr-example-title id=clustering-methods-to-learn-a-brain-parcellation-from-fmri><span id=sphx-glr-auto-examples-03-connectivity-plot-data-driven-parcellations-py></span><h1>Clustering methods to learn a brain parcellation from fMRI<a title="Permalink to this heading"class=headerlink href=#clustering-methods-to-learn-a-brain-parcellation-from-fmri>#</a></h1><p>We use spatially-constrained Ward-clustering, KMeans, Hierarchical KMeans and Recursive Neighbor Agglomeration (ReNA) to create a set of parcels.</p><p>In a high dimensional regime, these methods can be interesting to create a ‘compressed’ representation of the data, replacing the data in the fMRI images by mean signals on the parcellation, which can subsequently be used for statistical analysis or machine learning.</p><p>Also, these methods can be used to learn functional connectomes and subsequently for classification tasks or to analyze data at a local level.</p><section id=references><h2>References<a title="Permalink to this heading"class=headerlink href=#references>#</a></h2><p>Which clustering method to use, an empirical comparison can be found in this paper:</p><dl class=simple><dt>Bertrand Thirion, Gael Varoquaux, Elvis Dohmatob, Jean-Baptiste Poline.</dt><dd><p><a class="reference external"href=https://doi.org/10.3389/fnins.2014.00167>Which fMRI clustering gives good brain parcellations ?</a> Frontiers in Neuroscience, 2014.</p></dd></dl><p>This parcellation may be useful in a supervised learning, see for instance:</p><dl class=simple><dt>Vincent Michel, Alexandre Gramfort, Gael Varoquaux, Evelyn Eger,</dt><dd><p>Christine Keribin, Bertrand Thirion. <a class="reference external"href=http://dx.doi.org/10.1016/j.patcog.2011.04.006>A supervised clustering approach for fMRI-based inference of brain states.</a>. Pattern Recognition, Elsevier, 2011.</p></dd></dl><p>The big picture discussion corresponding to this example can be found in the documentation section <a class="reference internal"href=../../connectivity/parcellating.html#parcellating-brain><span class="std std-ref">Clustering to parcellate the brain in regions</span></a>.</p></section><section id=download-a-brain-development-fmri-dataset-and-turn-it-to-a-data-matrix><h2>Download a brain development fmri dataset and turn it to a data matrix<a title="Permalink to this heading"class=headerlink href=#download-a-brain-development-fmri-dataset-and-turn-it-to-a-data-matrix>#</a></h2><p>We download one subject of the movie watching dataset from Internet</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>import</span> <span class=nn>time</span>

<span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
<span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=kn>from</span> <span class=nn>matplotlib</span> <span class=kn>import</span> <span class=n>patches</span><span class=p>,</span> <span class=n>ticker</span>

<span class=kn>from</span> <span class=nn>nilearn</span> <span class=kn>import</span> <span class=n>datasets</span><span class=p>,</span> <span class=n>plotting</span>
<span class=kn>from</span> <span class=nn>nilearn.image</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.get_data.html#nilearn.image.get_data title=nilearn.image.get_data><span class=n>get_data</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.index_img.html#nilearn.image.index_img title=nilearn.image.index_img><span class=n>index_img</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.mean_img.html#nilearn.image.mean_img title=nilearn.image.mean_img><span class=n>mean_img</span></a>
<span class=kn>from</span> <span class=nn>nilearn.regions</span> <span class=kn>import</span> <a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations title=nilearn.regions.Parcellations><span class=n>Parcellations</span></a>

<a class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch title=sklearn.utils.Bunch><span class=n>dataset</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.datasets.fetch_development_fmri.html#nilearn.datasets.fetch_development_fmri title=nilearn.datasets.fetch_development_fmri><span class=n>datasets</span><span class=o>.</span><span class=n>fetch_development_fmri</span></a><span class=p>(</span><span class=n>n_subjects</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>

<span class=c1># print basic information on the dataset</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"First subject functional nifti image (4D) is at: </span><span class=si>{</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>dataset</span><span class=o>.</span><span class=n>func</span></a><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</pre></div></div><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>First subject functional nifti image (4D) is at: /home/remi/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz
</pre></div></div></section><section id=brain-parcellations-with-ward-clustering><h2>Brain parcellations with Ward Clustering<a title="Permalink to this heading"class=headerlink href=#brain-parcellations-with-ward-clustering>#</a></h2><p>Transforming list of images to data matrix and build brain parcellations, all can be done at once using <cite>Parcellations</cite> object.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=c1># Computing ward for the first time, will be long... This can be seen by</span>
<span class=c1># measuring using time</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/functions.html#float title=builtins.float><span class=n>start</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-time sphx-glr-backref-type-py-function"href=https://docs.python.org/3.9/library/time.html#time.time title=time.time><span class=n>time</span><span class=o>.</span><span class=n>time</span></a><span class=p>()</span>

<span class=c1># Agglomerative Clustering: ward</span>

<span class=c1># We build parameters of our own for this object. Parameters related to</span>
<span class=c1># masking, caching and defining number of clusters and specific parcellations</span>
<span class=c1># method.</span>
<a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations title=nilearn.regions.Parcellations><span class=n>ward</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations title=nilearn.regions.Parcellations><span class=n>Parcellations</span></a><span class=p>(</span>
    <span class=n>method</span><span class=o>=</span><span class=s2>"ward"</span><span class=p>,</span>
    <span class=n>n_parcels</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span>
    <span class=n>standardize</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
    <span class=n>smoothing_fwhm</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
    <span class=n>memory</span><span class=o>=</span><span class=s2>"nilearn_cache"</span><span class=p>,</span>
    <span class=n>memory_level</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
    <span class=n>verbose</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<span class=p>)</span>
<span class=c1># Call fit on functional dataset: single subject (less samples).</span>
<a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations.fit title=nilearn.regions.Parcellations.fit><span class=n>ward</span><span class=o>.</span><span class=n>fit</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>dataset</span><span class=o>.</span><span class=n>func</span></a><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Ward agglomeration 1000 clusters: </span><span class=si>{</span><a class="sphx-glr-backref-module-time sphx-glr-backref-type-py-function"href=https://docs.python.org/3.9/library/time.html#time.time title=time.time><span class=n>time</span><span class=o>.</span><span class=n>time</span></a><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/functions.html#float title=builtins.float><span class=n>start</span></a><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>s"</span><span class=p>)</span>

<span class=c1># We compute now ward clustering with 2000 clusters and compare</span>
<span class=c1># time with 1000 clusters. To see the benefits of caching for second time.</span>

<span class=c1># We initialize class again with n_parcels=2000 this time.</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/functions.html#float title=builtins.float><span class=n>start</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-time sphx-glr-backref-type-py-function"href=https://docs.python.org/3.9/library/time.html#time.time title=time.time><span class=n>time</span><span class=o>.</span><span class=n>time</span></a><span class=p>()</span>
<a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations title=nilearn.regions.Parcellations><span class=n>ward</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations title=nilearn.regions.Parcellations><span class=n>Parcellations</span></a><span class=p>(</span>
    <span class=n>method</span><span class=o>=</span><span class=s2>"ward"</span><span class=p>,</span>
    <span class=n>n_parcels</span><span class=o>=</span><span class=mi>2000</span><span class=p>,</span>
    <span class=n>standardize</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
    <span class=n>smoothing_fwhm</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
    <span class=n>memory</span><span class=o>=</span><span class=s2>"nilearn_cache"</span><span class=p>,</span>
    <span class=n>memory_level</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
    <span class=n>verbose</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<span class=p>)</span>
<a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations.fit title=nilearn.regions.Parcellations.fit><span class=n>ward</span><span class=o>.</span><span class=n>fit</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>dataset</span><span class=o>.</span><span class=n>func</span></a><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Ward agglomeration 2000 clusters: </span><span class=si>{</span><a class="sphx-glr-backref-module-time sphx-glr-backref-type-py-function"href=https://docs.python.org/3.9/library/time.html#time.time title=time.time><span class=n>time</span><span class=o>.</span><span class=n>time</span></a><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/functions.html#float title=builtins.float><span class=n>start</span></a><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>s"</span><span class=p>)</span>
</pre></div></div><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>[MultiNiftiMasker.fit] Loading data from [/home/remi/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz].
[{self.__class__.__name__}.fit] Computing mask
/home/remi/github/nilearn/env/lib/python3.11/site-packages/nilearn/_utils/cache_mixin.py:241: UserWarning:

memory_level is currently set to 0 but a Memory object has been provided. Setting memory_level to 1.

[MultiNiftiMasker.transform] Resampling mask
[Parcellations] Loading data
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/remi/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[Parcellations] computing ward
________________________________________________________________________________
[Memory] Calling nilearn.regions.parcellations._estimator_fit...
_estimator_fit(array([[-0.015617, ...,  0.000716],
       ...,
       [-0.002017, ...,  0.000423]]),
AgglomerativeClustering(connectivity=&LT24256x24256 sparse matrix of type '&LTclass 'numpy.int64'>'
        with 162682 stored elements in COOrdinate format>,
                        memory=Memory(location=nilearn_cache/joblib),
                        n_clusters=1000))
________________________________________________________________________________
[Memory] Calling sklearn.cluster._agglomerative.ward_tree...
ward_tree(array([[-0.015617, ..., -0.002017],
       ...,
       [ 0.000716, ...,  0.000423]]), connectivity=&LT24256x24256 sparse matrix of type '&LTclass 'numpy.int64'>'
        with 162682 stored elements in COOrdinate format>, n_clusters=1000, return_distance=False)
________________________________________________________ward_tree - 2.4s, 0.0min
____________________________________________________estimator_fit - 2.5s, 0.0min
/home/remi/github/nilearn/env/lib/python3.11/site-packages/nilearn/masking.py:974: UserWarning:

Data array used to create a new image contains 64-bit ints. This is likely due to creating the array with numpy and passing `int` as the `dtype`. Many tools such as FSL and SPM cannot deal with int64 in Nifti images, so for compatibility the data has been converted to int32.

Ward agglomeration 1000 clusters: 9.59s
[MultiNiftiMasker.fit] Loading data from [/home/remi/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz].
[{self.__class__.__name__}.fit] Computing mask
/home/remi/github/nilearn/env/lib/python3.11/site-packages/nilearn/_utils/cache_mixin.py:241: UserWarning:

memory_level is currently set to 0 but a Memory object has been provided. Setting memory_level to 1.

[MultiNiftiMasker.transform] Resampling mask
[Parcellations] Loading data
[Parcellations] computing ward
________________________________________________________________________________
[Memory] Calling nilearn.regions.parcellations._estimator_fit...
_estimator_fit(array([[-0.015617, ...,  0.000716],
       ...,
       [-0.002017, ...,  0.000423]]),
AgglomerativeClustering(connectivity=&LT24256x24256 sparse matrix of type '&LTclass 'numpy.int64'>'
        with 162682 stored elements in COOrdinate format>,
                        memory=Memory(location=nilearn_cache/joblib),
                        n_clusters=2000))
________________________________________________________________________________
[Memory] Calling sklearn.cluster._agglomerative.ward_tree...
ward_tree(array([[-0.015617, ..., -0.002017],
       ...,
       [ 0.000716, ...,  0.000423]]), connectivity=&LT24256x24256 sparse matrix of type '&LTclass 'numpy.int64'>'
        with 162682 stored elements in COOrdinate format>, n_clusters=2000, return_distance=False)
________________________________________________________ward_tree - 2.3s, 0.0min
____________________________________________________estimator_fit - 2.5s, 0.0min
/home/remi/github/nilearn/env/lib/python3.11/site-packages/nilearn/masking.py:974: UserWarning:

Data array used to create a new image contains 64-bit ints. This is likely due to creating the array with numpy and passing `int` as the `dtype`. Many tools such as FSL and SPM cannot deal with int64 in Nifti images, so for compatibility the data has been converted to int32.

Ward agglomeration 2000 clusters: 7.35s
</pre></div></div><section id=visualize-brain-parcellations-ward><h3>Visualize: Brain parcellations (Ward)<a title="Permalink to this heading"class=headerlink href=#visualize-brain-parcellations-ward>#</a></h3><p>First, we display the parcellations of the brain image stored in attribute <cite>labels_img_</cite></p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>ward_labels_img</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>ward</span><span class=o>.</span><span class=n>labels_img_</span></a>

<span class=c1># Now, ward_labels_img are Nifti1Image object, it can be saved to file</span>
<span class=c1># with the following code:</span>
<a class="sphx-glr-backref-module-nibabel-filebasedimages sphx-glr-backref-type-py-method"href=https://nipy.org/nibabel/reference/nibabel.filebasedimages.html#nibabel.filebasedimages.FileBasedImage.to_filename title=nibabel.filebasedimages.FileBasedImage.to_filename><span class=n>ward_labels_img</span><span class=o>.</span><span class=n>to_filename</span></a><span class=p>(</span><span class=s2>"ward_parcellation.nii.gz"</span><span class=p>)</span>


<a class="sphx-glr-backref-module-nilearn-plotting-displays sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.plotting.displays.XZSlicer.html#nilearn.plotting.displays.XZSlicer title=nilearn.plotting.displays.XZSlicer><span class=n>first_plot</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_roi.html#nilearn.plotting.plot_roi title=nilearn.plotting.plot_roi><span class=n>plotting</span><span class=o>.</span><span class=n>plot_roi</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>ward_labels_img</span></a><span class=p>,</span> <span class=n>title</span><span class=o>=</span><span class=s2>"Ward parcellation"</span><span class=p>,</span> <span class=n>display_mode</span><span class=o>=</span><span class=s2>"xz"</span>
<span class=p>)</span>

<span class=c1># Grab cut coordinates from this plot to use as a common for all plots</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>cut_coords</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>first_plot</span><span class=o>.</span><span class=n>cut_coords</span></a>
</pre></div></div><img alt="plot data driven parcellations"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_data_driven_parcellations_001.png srcset=../../_images/sphx_glr_plot_data_driven_parcellations_001.png></section><section id=compressed-representation-of-ward-clustering><h3>Compressed representation of Ward clustering<a title="Permalink to this heading"class=headerlink href=#compressed-representation-of-ward-clustering>#</a></h3><p>Second, we illustrate the effect that the clustering has on the signal. We show the original data, and the approximation provided by the clustering by averaging the signal on each parcel.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=c1># Grab number of voxels from attribute mask image (mask_img_).</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.int64 title=numpy.int64><span class=n>original_voxels</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.sum.html#numpy.sum title=numpy.sum><span class=n>np</span><span class=o>.</span><span class=n>sum</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.get_data.html#nilearn.image.get_data title=nilearn.image.get_data><span class=n>get_data</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>ward</span><span class=o>.</span><span class=n>mask_img_</span></a><span class=p>))</span>

<span class=c1># Compute mean over time on the functional image to use the mean</span>
<span class=c1># image for compressed representation comparisons</span>
<a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>mean_func_img</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.mean_img.html#nilearn.image.mean_img title=nilearn.image.mean_img><span class=n>mean_img</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>dataset</span><span class=o>.</span><span class=n>func</span></a><span class=p>[</span><span class=mi>0</span><span class=p>])</span>

<span class=c1># Compute common vmin and vmax</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmin</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.min.html#numpy.min title=numpy.min><span class=n>np</span><span class=o>.</span><span class=n>min</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.get_data.html#nilearn.image.get_data title=nilearn.image.get_data><span class=n>get_data</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>mean_func_img</span></a><span class=p>))</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmax</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.max.html#numpy.max title=numpy.max><span class=n>np</span><span class=o>.</span><span class=n>max</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.get_data.html#nilearn.image.get_data title=nilearn.image.get_data><span class=n>get_data</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>mean_func_img</span></a><span class=p>))</span>

<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_epi.html#nilearn.plotting.plot_epi title=nilearn.plotting.plot_epi><span class=n>plotting</span><span class=o>.</span><span class=n>plot_epi</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>mean_func_img</span></a><span class=p>,</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>cut_coords</span></a><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>cut_coords</span></a><span class=p>,</span>
    <span class=n>title</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Original (</span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.int64 title=numpy.int64><span class=n>original_voxels</span></a><span class=p>)</span><span class=si>}</span><span class=s2> voxels)"</span><span class=p>,</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmax</span></a><span class=o>=</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmax</span></a><span class=p>,</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmin</span></a><span class=o>=</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmin</span></a><span class=p>,</span>
    <span class=n>display_mode</span><span class=o>=</span><span class=s2>"xz"</span><span class=p>,</span>
<span class=p>)</span>

<span class=c1># A reduced dataset can be created by taking the parcel-level average:</span>
<span class=c1># Note that Parcellation objects with any method have the opportunity to</span>
<span class=c1># use a `transform` call that modifies input features. Here it reduces their</span>
<span class=c1># dimension. Note that we `fit` before calling a `transform` so that average</span>
<span class=c1># signals can be created on the brain parcellations with fit call.</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>fmri_reduced</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations.transform title=nilearn.regions.Parcellations.transform><span class=n>ward</span><span class=o>.</span><span class=n>transform</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>dataset</span><span class=o>.</span><span class=n>func</span></a><span class=p>)</span>

<span class=c1># Display the corresponding data compressed using the parcellation using</span>
<span class=c1># parcels=2000.</span>
<a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>fmri_compressed</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations.inverse_transform title=nilearn.regions.Parcellations.inverse_transform><span class=n>ward</span><span class=o>.</span><span class=n>inverse_transform</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>fmri_reduced</span></a><span class=p>)</span>

<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_epi.html#nilearn.plotting.plot_epi title=nilearn.plotting.plot_epi><span class=n>plotting</span><span class=o>.</span><span class=n>plot_epi</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.index_img.html#nilearn.image.index_img title=nilearn.image.index_img><span class=n>index_img</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>fmri_compressed</span></a><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>cut_coords</span></a><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>cut_coords</span></a><span class=p>,</span>
    <span class=n>title</span><span class=o>=</span><span class=s2>"Ward compressed representation (2000 parcels)"</span><span class=p>,</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmin</span></a><span class=o>=</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmin</span></a><span class=p>,</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmax</span></a><span class=o>=</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmax</span></a><span class=p>,</span>
    <span class=n>display_mode</span><span class=o>=</span><span class=s2>"xz"</span><span class=p>,</span>
<span class=p>)</span>
<span class=c1># As you can see below, this approximation is almost good, although there</span>
<span class=c1># are only 2000 parcels, instead of the original 60000 voxels</span>
</pre></div></div><ul class=sphx-glr-horizontal><li><img alt="plot data driven parcellations"class=sphx-glr-multi-img src=../../_images/sphx_glr_plot_data_driven_parcellations_002.png srcset=../../_images/sphx_glr_plot_data_driven_parcellations_002.png></li><li><img alt="plot data driven parcellations"class=sphx-glr-multi-img src=../../_images/sphx_glr_plot_data_driven_parcellations_003.png srcset=../../_images/sphx_glr_plot_data_driven_parcellations_003.png></li></ul><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>[Parcellations.wrapped] loading data from Nifti1Image('ward_parcellation.nii.gz')
[Parcellations.wrapped] loading data from Nifti1Image(
shape=(50, 59, 50),
affine=array([[   4.,    0.,    0.,  -96.],
       [   0.,    4.,    0., -132.],
       [   0.,    0.,    4.,  -78.],
       [   0.,    0.,    0.,    1.]])
)
________________________________________________________________________________
[Memory] Calling nilearn.maskers.base_masker._filter_and_extract...
_filter_and_extract(&LTnibabel.nifti1.Nifti1Image object at 0x7fd1b37f6490>, &LTnilearn.maskers.nifti_labels_masker._ExtractionFunctor object at 0x7fd1f258fa50>,
{ 'background_label': 0,
  'clean_kwargs': {},
  'detrend': False,
  'dtype': None,
  'high_pass': None,
  'high_variance_confounds': False,
  'keep_masked_labels': True,
  'labels': None,
  'labels_img': &LTnibabel.nifti1.Nifti1Image object at 0x7fd1b2ec4bd0>,
  'low_pass': None,
  'mask_img': &LTnibabel.nifti1.Nifti1Image object at 0x7fd1b4954410>,
  'reports': True,
  'smoothing_fwhm': 2.0,
  'standardize': False,
  'standardize_confounds': True,
  'strategy': 'mean',
  't_r': None,
  'target_affine': None,
  'target_shape': None}, confounds=None, sample_mask=None, dtype=None, memory=Memory(location=nilearn_cache/joblib), memory_level=1, verbose=1)
[NiftiLabelsMasker.transform_single_imgs] Loading data from Nifti1Image('/home/remi/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[NiftiLabelsMasker.transform_single_imgs] Smoothing images
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
_______________________________________________filter_and_extract - 1.6s, 0.0min

&LTnilearn.plotting.displays._slicers.XZSlicer object at 0x7fd1b26775d0>
</pre></div></div></section></section><section id=brain-parcellations-with-kmeans-clustering><h2>Brain parcellations with KMeans Clustering<a title="Permalink to this heading"class=headerlink href=#brain-parcellations-with-kmeans-clustering>#</a></h2><p>We use the same approach as with building parcellations using Ward clustering. But, in the range of a small number of clusters, it is most likely that we want to use standardization. Indeed with standardization and smoothing, the clusters will form as regions.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=c1># class/functions can be used here as they are already imported above.</span>

<span class=c1># This object uses method='kmeans' for KMeans clustering with 10mm smoothing</span>
<span class=c1># and standardization ON</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/functions.html#float title=builtins.float><span class=n>start</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-time sphx-glr-backref-type-py-function"href=https://docs.python.org/3.9/library/time.html#time.time title=time.time><span class=n>time</span><span class=o>.</span><span class=n>time</span></a><span class=p>()</span>
<a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations title=nilearn.regions.Parcellations><span class=n>kmeans</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations title=nilearn.regions.Parcellations><span class=n>Parcellations</span></a><span class=p>(</span>
    <span class=n>method</span><span class=o>=</span><span class=s2>"kmeans"</span><span class=p>,</span>
    <span class=n>n_parcels</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
    <span class=n>standardize</span><span class=o>=</span><span class=s2>"zscore_sample"</span><span class=p>,</span>
    <span class=n>smoothing_fwhm</span><span class=o>=</span><span class=mf>10.0</span><span class=p>,</span>
    <span class=n>memory</span><span class=o>=</span><span class=s2>"nilearn_cache"</span><span class=p>,</span>
    <span class=n>memory_level</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
    <span class=n>verbose</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<span class=p>)</span>
<span class=c1># Call fit on functional dataset: single subject (less samples)</span>
<a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations.fit title=nilearn.regions.Parcellations.fit><span class=n>kmeans</span><span class=o>.</span><span class=n>fit</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>dataset</span><span class=o>.</span><span class=n>func</span></a><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"KMeans clusters: </span><span class=si>{</span><a class="sphx-glr-backref-module-time sphx-glr-backref-type-py-function"href=https://docs.python.org/3.9/library/time.html#time.time title=time.time><span class=n>time</span><span class=o>.</span><span class=n>time</span></a><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/functions.html#float title=builtins.float><span class=n>start</span></a><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>s"</span><span class=p>)</span>
</pre></div></div><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>[MultiNiftiMasker.fit] Loading data from [/home/remi/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz].
[{self.__class__.__name__}.fit] Computing mask
/home/remi/github/nilearn/env/lib/python3.11/site-packages/nilearn/_utils/cache_mixin.py:241: UserWarning:

memory_level is currently set to 0 but a Memory object has been provided. Setting memory_level to 1.

[MultiNiftiMasker.transform] Resampling mask
[Parcellations] Loading data
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/remi/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[Parcellations] computing kmeans
________________________________________________________________________________
[Memory] Calling nilearn.regions.parcellations._estimator_fit...
_estimator_fit(array([[-0.006183, ...,  0.010417],
       ...,
       [-0.011582, ...,  0.000419]]),
MiniBatchKMeans(n_clusters=50, n_init=3, random_state=0))
____________________________________________________estimator_fit - 1.0s, 0.0min
KMeans clusters: 7.85s
</pre></div></div><section id=visualize-brain-parcellations-kmeans><h3>Visualize: Brain parcellations (KMeans)<a title="Permalink to this heading"class=headerlink href=#visualize-brain-parcellations-kmeans>#</a></h3><p>Grab parcellations of brain image stored in attribute <cite>labels_img_</cite></p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>kmeans_labels_img</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>kmeans</span><span class=o>.</span><span class=n>labels_img_</span></a>

<a class="sphx-glr-backref-module-nilearn-plotting-displays sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.plotting.displays.XZSlicer.html#nilearn.plotting.displays.XZSlicer title=nilearn.plotting.displays.XZSlicer><span class=n>display</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_roi.html#nilearn.plotting.plot_roi title=nilearn.plotting.plot_roi><span class=n>plotting</span><span class=o>.</span><span class=n>plot_roi</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>kmeans_labels_img</span></a><span class=p>,</span>
    <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>mean_func_img</span></a><span class=p>,</span>
    <span class=n>title</span><span class=o>=</span><span class=s2>"KMeans parcellation"</span><span class=p>,</span>
    <span class=n>display_mode</span><span class=o>=</span><span class=s2>"xz"</span><span class=p>,</span>
<span class=p>)</span>

<span class=c1># kmeans_labels_img is a Nifti1Image object, it can be saved to file with</span>
<span class=c1># the following code:</span>
<a class="sphx-glr-backref-module-nibabel-filebasedimages sphx-glr-backref-type-py-method"href=https://nipy.org/nibabel/reference/nibabel.filebasedimages.html#nibabel.filebasedimages.FileBasedImage.to_filename title=nibabel.filebasedimages.FileBasedImage.to_filename><span class=n>kmeans_labels_img</span><span class=o>.</span><span class=n>to_filename</span></a><span class=p>(</span><span class=s2>"kmeans_parcellation.nii.gz"</span><span class=p>)</span>
</pre></div></div><img alt="plot data driven parcellations"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_data_driven_parcellations_004.png srcset=../../_images/sphx_glr_plot_data_driven_parcellations_004.png></section></section><section id=brain-parcellations-with-hierarchical-kmeans-clustering><h2>Brain parcellations with Hierarchical KMeans Clustering<a title="Permalink to this heading"class=headerlink href=#brain-parcellations-with-hierarchical-kmeans-clustering>#</a></h2><p>As the number of images from which we try to cluster grows, voxels display more and more specific activity patterns causing KMeans clusters to be very unbalanced with a few big clusters and many voxels left as singletons. Hierarchical Kmeans algorithm is tailored to enforce more balanced clusterings. To do this, Hierarchical Kmeans does a first Kmeans clustering in square root of n_parcels. In a second step, it clusters voxels inside each of these parcels in m pieces with m adapted to the size of the cluster in order to have n balanced clusters in the end.</p><p>This object uses method=’hierarchical_kmeans’ for Hierarchical KMeans clustering and 10mm smoothing and standardization to compare with the previous method.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/functions.html#float title=builtins.float><span class=n>start</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-time sphx-glr-backref-type-py-function"href=https://docs.python.org/3.9/library/time.html#time.time title=time.time><span class=n>time</span><span class=o>.</span><span class=n>time</span></a><span class=p>()</span>
<a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations title=nilearn.regions.Parcellations><span class=n>hkmeans</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations title=nilearn.regions.Parcellations><span class=n>Parcellations</span></a><span class=p>(</span>
    <span class=n>method</span><span class=o>=</span><span class=s2>"hierarchical_kmeans"</span><span class=p>,</span>
    <span class=n>n_parcels</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
    <span class=n>standardize</span><span class=o>=</span><span class=s2>"zscore_sample"</span><span class=p>,</span>
    <span class=n>smoothing_fwhm</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
    <span class=n>memory</span><span class=o>=</span><span class=s2>"nilearn_cache"</span><span class=p>,</span>
    <span class=n>memory_level</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
    <span class=n>verbose</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<span class=p>)</span>
<span class=c1># Call fit on functional dataset: single subject (less samples)</span>
<a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations.fit title=nilearn.regions.Parcellations.fit><span class=n>hkmeans</span><span class=o>.</span><span class=n>fit</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>dataset</span><span class=o>.</span><span class=n>func</span></a><span class=p>)</span>
</pre></div></div><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>[MultiNiftiMasker.fit] Loading data from [/home/remi/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz].
[{self.__class__.__name__}.fit] Computing mask
/home/remi/github/nilearn/env/lib/python3.11/site-packages/nilearn/_utils/cache_mixin.py:241: UserWarning:

memory_level is currently set to 0 but a Memory object has been provided. Setting memory_level to 1.

[MultiNiftiMasker.transform] Resampling mask
[Parcellations] Loading data
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/remi/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[Parcellations] computing hierarchical_kmeans
________________________________________________________________________________
[Memory] Calling nilearn.regions.parcellations._estimator_fit...
_estimator_fit(array([[-0.006183, ...,  0.010417],
       ...,
       [-0.011582, ...,  0.000419]]),
HierarchicalKMeans(n_clusters=50))
____________________________________________________estimator_fit - 6.7s, 0.1min
/home/remi/github/nilearn/env/lib/python3.11/site-packages/nilearn/masking.py:974: UserWarning:

Data array used to create a new image contains 64-bit ints. This is likely due to creating the array with numpy and passing `int` as the `dtype`. Many tools such as FSL and SPM cannot deal with int64 in Nifti images, so for compatibility the data has been converted to int32.
</pre></div></div><div class="output_subarea output_html rendered_html output_result"><style>#sk-container-id-5{color:#000}#sk-container-id-5 pre{padding:0}#sk-container-id-5 div.sk-toggleable{background-color:#fff}#sk-container-id-5 label.sk-toggleable__label{cursor:pointer;box-sizing:border-box;text-align:center;width:100%;margin-bottom:0;padding:.3em;display:block}#sk-container-id-5 label.sk-toggleable__label-arrow:before{content:"▸";float:left;color:#696969;margin-right:.25em}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before,#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before{color:#000}#sk-container-id-5 div.sk-toggleable__content{text-align:left;background-color:#f0f8ff;max-width:0;max-height:0;overflow:hidden}#sk-container-id-5 div.sk-toggleable__content pre{color:#000;background-color:#f0f8ff;border-radius:.25em;margin:.2em}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content{max-width:100%;max-height:200px;overflow:auto}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before{content:"▾"}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label,#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label{background-color:#d4ebff}#sk-container-id-5 input.sk-hidden--visually{clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);border:0;width:1px;height:1px;margin:-1px;padding:0;position:absolute;overflow:hidden}#sk-container-id-5 div.sk-estimator{box-sizing:border-box;background-color:#f0f8ff;border:1px dotted #000;border-radius:.25em;margin-bottom:.5em;font-family:monospace}#sk-container-id-5 div.sk-estimator:hover{background-color:#d4ebff}#sk-container-id-5 div.sk-parallel-item:after{content:"";border-bottom:1px solid gray;flex-grow:1;width:100%}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label{background-color:#d4ebff}#sk-container-id-5 div.sk-serial:before{content:"";box-sizing:border-box;z-index:0;border-left:1px solid gray;position:absolute;top:0;bottom:0;left:50%}#sk-container-id-5 div.sk-serial{background-color:#fff;flex-direction:column;align-items:center;padding-left:.2em;padding-right:.2em;display:flex;position:relative}#sk-container-id-5 div.sk-item{z-index:1;position:relative}#sk-container-id-5 div.sk-parallel{background-color:#fff;justify-content:center;align-items:stretch;display:flex;position:relative}#sk-container-id-5 div.sk-item:before,#sk-container-id-5 div.sk-parallel-item:before{content:"";box-sizing:border-box;z-index:-1;border-left:1px solid gray;position:absolute;top:0;bottom:0;left:50%}#sk-container-id-5 div.sk-parallel-item{z-index:1;background-color:#fff;flex-direction:column;display:flex;position:relative}#sk-container-id-5 div.sk-parallel-item:first-child:after{align-self:flex-end;width:50%}#sk-container-id-5 div.sk-parallel-item:last-child:after{align-self:flex-start;width:50%}#sk-container-id-5 div.sk-parallel-item:only-child:after{width:0}#sk-container-id-5 div.sk-dashed-wrapped{box-sizing:border-box;background-color:#fff;border:1px dashed gray;margin:0 .4em .5em;padding-bottom:.4em}#sk-container-id-5 div.sk-label label{font-family:monospace;font-weight:700;line-height:1.2em;display:inline-block}#sk-container-id-5 div.sk-label-container{text-align:center}#sk-container-id-5 div.sk-container{position:relative;display:inline-block!important}#sk-container-id-5 div.sk-text-repr-fallback{display:none}</style><div class=sk-top-container id=sk-container-id-5><div class=sk-text-repr-fallback><pre>Parcellations(memory=Memory(location=nilearn_cache/joblib), memory_level=1,
              method='hierarchical_kmeans', smoothing_fwhm=10,
              standardize='zscore_sample')</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=sk-container hidden><div class=sk-item><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually"checked id=sk-estimator-id-5 type=checkbox><label class="sk-toggleable__label sk-toggleable__label-arrow"for=sk-estimator-id-5>Parcellations</label><div class=sk-toggleable__content><pre>Parcellations(memory=Memory(location=nilearn_cache/joblib), memory_level=1,
              method='hierarchical_kmeans', smoothing_fwhm=10,
              standardize='zscore_sample')</pre></div></div></div></div></div></div><br><br><section id=visualize-brain-parcellations-hierarchical-kmeans><h3>Visualize: Brain parcellations (Hierarchical KMeans)<a title="Permalink to this heading"class=headerlink href=#visualize-brain-parcellations-hierarchical-kmeans>#</a></h3><p>Grab parcellations of brain image stored in attribute <cite>labels_img_</cite></p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>hkmeans_labels_img</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>hkmeans</span><span class=o>.</span><span class=n>labels_img_</span></a>

<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_roi.html#nilearn.plotting.plot_roi title=nilearn.plotting.plot_roi><span class=n>plotting</span><span class=o>.</span><span class=n>plot_roi</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>hkmeans_labels_img</span></a><span class=p>,</span>
    <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>mean_func_img</span></a><span class=p>,</span>
    <span class=n>title</span><span class=o>=</span><span class=s2>"Hierarchical KMeans parcellation"</span><span class=p>,</span>
    <span class=n>display_mode</span><span class=o>=</span><span class=s2>"xz"</span><span class=p>,</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>cut_coords</span></a><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>display</span><span class=o>.</span><span class=n>cut_coords</span></a><span class=p>,</span>
<span class=p>)</span>

<span class=c1># kmeans_labels_img is a :class:`nibabel.nifti1.Nifti1Image` object, it can be</span>
<span class=c1># saved to file with the following code:</span>
<a class="sphx-glr-backref-module-nibabel-filebasedimages sphx-glr-backref-type-py-method"href=https://nipy.org/nibabel/reference/nibabel.filebasedimages.html#nibabel.filebasedimages.FileBasedImage.to_filename title=nibabel.filebasedimages.FileBasedImage.to_filename><span class=n>hkmeans_labels_img</span><span class=o>.</span><span class=n>to_filename</span></a><span class=p>(</span><span class=s2>"hierarchical_kmeans_parcellation.nii.gz"</span><span class=p>)</span>
</pre></div></div><img alt="plot data driven parcellations"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_data_driven_parcellations_005.png srcset=../../_images/sphx_glr_plot_data_driven_parcellations_005.png></section><section id=compare-hierarchical-kmeans-clusters-with-those-from-kmeans><h3>Compare Hierarchical Kmeans clusters with those from Kmeans<a title="Permalink to this heading"class=headerlink href=#compare-hierarchical-kmeans-clusters-with-those-from-kmeans>#</a></h3><p>To compare those, we’ll first count how many voxels are contained in each of the 50 clusters for both algorithms and compare those sizes distribution. Hierarchical KMeans should give clusters closer to average (600 here) than KMeans.</p><p>First count how many voxels have each label (except 0 which is the background).</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>_</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>kmeans_counts</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.unique.html#numpy.unique title=numpy.unique><span class=n>np</span><span class=o>.</span><span class=n>unique</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.get_data.html#nilearn.image.get_data title=nilearn.image.get_data><span class=n>get_data</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>kmeans_labels_img</span></a><span class=p>),</span> <span class=n>return_counts</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>_</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>hkmeans_counts</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.unique.html#numpy.unique title=numpy.unique><span class=n>np</span><span class=o>.</span><span class=n>unique</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.get_data.html#nilearn.image.get_data title=nilearn.image.get_data><span class=n>get_data</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>hkmeans_labels_img</span></a><span class=p>),</span> <span class=n>return_counts</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>voxel_ratio</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.round.html#numpy.round title=numpy.round><span class=n>np</span><span class=o>.</span><span class=n>round</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.sum.html#numpy.sum title=numpy.sum><span class=n>np</span><span class=o>.</span><span class=n>sum</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>kmeans_counts</span></a><span class=p>[</span><span class=mi>1</span><span class=p>:])</span> <span class=o>/</span> <span class=mi>50</span><span class=p>)</span>

<span class=c1># If all voxels not in background were balanced between clusters ...</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"... each cluster should contain </span><span class=si>{</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>voxel_ratio</span></a><span class=si>}</span><span class=s2> voxels"</span><span class=p>)</span>
</pre></div></div><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>... each cluster should contain 485.0 voxels
</pre></div></div><p>Let’s plot clusters sizes distributions for both algorithms</p><p>You can just skip the plotting code, the important part is the figure</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>bins</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate title=numpy.concatenate><span class=n>np</span><span class=o>.</span><span class=n>concatenate</span></a><span class=p>(</span>
    <span class=p>[</span>
        <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace title=numpy.linspace><span class=n>np</span><span class=o>.</span><span class=n>linspace</span></a><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>11</span><span class=p>),</span>
        <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace title=numpy.linspace><span class=n>np</span><span class=o>.</span><span class=n>linspace</span></a><span class=p>(</span><span class=mi>600</span><span class=p>,</span> <span class=mi>2000</span><span class=p>,</span> <span class=mi>15</span><span class=p>),</span>
        <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace title=numpy.linspace><span class=n>np</span><span class=o>.</span><span class=n>linspace</span></a><span class=p>(</span><span class=mi>3000</span><span class=p>,</span> <span class=mi>10000</span><span class=p>,</span> <span class=mi>8</span><span class=p>),</span>
    <span class=p>]</span>
<span class=p>)</span>
<a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure title=matplotlib.figure.Figure><span class=n>fig</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots title=matplotlib.pyplot.subplots><span class=n>plt</span><span class=o>.</span><span class=n>subplots</span></a><span class=p>(</span>
    <span class=n>nrows</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>sharex</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>gridspec_kw</span><span class=o>=</span><span class=p>{</span><span class=s2>"height_ratios"</span><span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>]}</span>
<span class=p>)</span>
<a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.semilogx.html#matplotlib.pyplot.semilogx title=matplotlib.pyplot.semilogx><span class=n>plt</span><span class=o>.</span><span class=n>semilogx</span></a><span class=p>()</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>hist</span><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>kmeans_counts</span></a><span class=p>[</span><span class=mi>1</span><span class=p>:],</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>bins</span></a><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>"blue"</span><span class=p>)</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>hist</span><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>hkmeans_counts</span></a><span class=p>[</span><span class=mi>1</span><span class=p>:],</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>bins</span></a><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>"green"</span><span class=p>)</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>16</span><span class=p>)</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>xaxis</span><span class=o>.</span><span class=n>set_major_formatter</span><span class=p>(</span><a class="sphx-glr-backref-module-matplotlib-ticker sphx-glr-backref-type-py-class"href=https://matplotlib.org/stable/api/ticker_api.html#matplotlib.ticker.ScalarFormatter title=matplotlib.ticker.ScalarFormatter><span class=n>ticker</span><span class=o>.</span><span class=n>ScalarFormatter</span></a><span class=p>())</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>axes</span></a><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>yaxis</span><span class=o>.</span><span class=n>set_label_coords</span><span class=p>(</span><span class=o>-</span><span class=mf>0.08</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
<a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure.subplots_adjust title=matplotlib.figure.Figure.subplots_adjust><span class=n>fig</span><span class=o>.</span><span class=n>subplots_adjust</span></a><span class=p>(</span><span class=n>hspace</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel title=matplotlib.pyplot.xlabel><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span></a><span class=p>(</span><span class=s2>"Number of voxels (log)"</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
<a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel title=matplotlib.pyplot.ylabel><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span></a><span class=p>(</span><span class=s2>"Number of clusters"</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>handles</span></a> <span class=o>=</span> <span class=p>[</span>
    <a class="sphx-glr-backref-module-matplotlib-patches sphx-glr-backref-type-py-class"href=https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Rectangle.html#matplotlib.patches.Rectangle title=matplotlib.patches.Rectangle><span class=n>patches</span><span class=o>.</span><span class=n>Rectangle</span></a><span class=p>((</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>c</span><span class=p>,</span> <span class=n>ec</span><span class=o>=</span><span class=s2>"k"</span><span class=p>)</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>"blue"</span><span class=p>,</span> <span class=s2>"green"</span><span class=p>]</span>
<span class=p>]</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>labels</span></a> <span class=o>=</span> <span class=p>[</span><span class=s2>"Kmeans"</span><span class=p>,</span> <span class=s2>"Hierarchical Kmeans"</span><span class=p>]</span>
<a class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"href=https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure.legend title=matplotlib.figure.Figure.legend><span class=n>fig</span><span class=o>.</span><span class=n>legend</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>handles</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>labels</span></a><span class=p>,</span> <span class=n>loc</span><span class=o>=</span><span class=p>(</span><span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.8</span><span class=p>))</span>
</pre></div></div><img alt="plot data driven parcellations"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_data_driven_parcellations_006.png srcset=../../_images/sphx_glr_plot_data_driven_parcellations_006.png><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>&LTmatplotlib.legend.Legend object at 0x7fd1efd20f50>
</pre></div></div><p>As we can see, half of the 50 KMeans clusters contain less than 100 voxels whereas three contain several thousands voxels Hierarchical KMeans yield better balanced clusters, with a significant proportion of them containing hundreds to thousands of voxels.</p></section></section><section id=brain-parcellations-with-rena-clustering><h2>Brain parcellations with ReNA Clustering<a title="Permalink to this heading"class=headerlink href=#brain-parcellations-with-rena-clustering>#</a></h2><p>One interesting algorithmic property of ReNA (see References) is that it is very fast for a large number of parcels (notably faster than Ward). As before, the parcellation is done with a Parcellations object. The spatial constraints are implemented inside the Parcellations object.</p><section id=id1><h3>References<a title="Permalink to this heading"class=headerlink href=#id1>#</a></h3><p>More about ReNA clustering algorithm in the original paper</p><blockquote><div><ul class=simple><li><p>A. Hoyos-Idrobo, G. Varoquaux, J. Kahn and B. Thirion, “Recursive Nearest Agglomeration (ReNA): Fast Clustering for Approximation of Structured Signals,” in IEEE Transactions on Pattern Analysis and Machine Intelligence, vol. 41, no. 3, pp. 669-681, 1 March 2019. <a class="reference external"href=https://hal.archives-ouvertes.fr/hal-01366651/>https://hal.archives-ouvertes.fr/hal-01366651/</a></p></li></ul></div></blockquote><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/functions.html#float title=builtins.float><span class=n>start</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-time sphx-glr-backref-type-py-function"href=https://docs.python.org/3.9/library/time.html#time.time title=time.time><span class=n>time</span><span class=o>.</span><span class=n>time</span></a><span class=p>()</span>
<a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations title=nilearn.regions.Parcellations><span class=n>rena</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations title=nilearn.regions.Parcellations><span class=n>Parcellations</span></a><span class=p>(</span>
    <span class=n>method</span><span class=o>=</span><span class=s2>"rena"</span><span class=p>,</span>
    <span class=n>n_parcels</span><span class=o>=</span><span class=mi>5000</span><span class=p>,</span>
    <span class=n>standardize</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
    <span class=n>smoothing_fwhm</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span>
    <span class=n>scaling</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>memory</span><span class=o>=</span><span class=s2>"nilearn_cache"</span><span class=p>,</span>
    <span class=n>memory_level</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
    <span class=n>verbose</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<span class=p>)</span>

<a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations.fit_transform title=nilearn.regions.Parcellations.fit_transform><span class=n>rena</span><span class=o>.</span><span class=n>fit_transform</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>dataset</span><span class=o>.</span><span class=n>func</span></a><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"ReNA 5000 clusters: </span><span class=si>{</span><a class="sphx-glr-backref-module-time sphx-glr-backref-type-py-function"href=https://docs.python.org/3.9/library/time.html#time.time title=time.time><span class=n>time</span><span class=o>.</span><span class=n>time</span></a><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/functions.html#float title=builtins.float><span class=n>start</span></a><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>s"</span><span class=p>)</span>
</pre></div></div><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>[MultiNiftiMasker.fit] Loading data from [/home/remi/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz].
[{self.__class__.__name__}.fit] Computing mask
/home/remi/github/nilearn/env/lib/python3.11/site-packages/nilearn/_utils/cache_mixin.py:241: UserWarning:

memory_level is currently set to 0 but a Memory object has been provided. Setting memory_level to 1.

[MultiNiftiMasker.transform] Resampling mask
[Parcellations] Loading data
[Parcellations] computing rena
________________________________________________________________________________
[Memory] Calling nilearn.regions.parcellations._estimator_fit...
_estimator_fit(array([[-0.015617, ...,  0.000716],
       ...,
       [-0.002017, ...,  0.000423]]),
ReNA(mask_img=&LTnibabel.nifti1.Nifti1Image object at 0x7fd1cf1bcc90>,
     memory=Memory(location=nilearn_cache/joblib), n_clusters=5000,
     scaling=True),
'rena')
________________________________________________________________________________
[Memory] Calling nilearn.regions.rena_clustering.recursive_neighbor_agglomeration...
recursive_neighbor_agglomeration(array([[-0.015617, ...,  0.000716],
       ...,
       [-0.002017, ...,  0.000423]]),
&LTnibabel.nifti1.Nifti1Image object at 0x7fd1cf1bcc90>, 5000, n_iter=10, threshold=1e-07, verbose=0)
_________________________________recursive_neighbor_agglomeration - 0.9s, 0.0min
____________________________________________________estimator_fit - 1.1s, 0.0min
[Parcellations.wrapped] loading data from Nifti1Image(
shape=(50, 59, 50),
affine=array([[   4.,    0.,    0.,  -96.],
       [   0.,    4.,    0., -132.],
       [   0.,    0.,    4.,  -78.],
       [   0.,    0.,    0.,    1.]])
)
[Parcellations.wrapped] loading data from Nifti1Image(
shape=(50, 59, 50),
affine=array([[   4.,    0.,    0.,  -96.],
       [   0.,    4.,    0., -132.],
       [   0.,    0.,    4.,  -78.],
       [   0.,    0.,    0.,    1.]])
)
________________________________________________________________________________
[Memory] Calling nilearn.maskers.base_masker._filter_and_extract...
_filter_and_extract(&LTnibabel.nifti1.Nifti1Image object at 0x7fd1f00094d0>, &LTnilearn.maskers.nifti_labels_masker._ExtractionFunctor object at 0x7fd1b2e49010>,
{ 'background_label': 0,
  'clean_kwargs': {},
  'detrend': False,
  'dtype': None,
  'high_pass': None,
  'high_variance_confounds': False,
  'keep_masked_labels': True,
  'labels': None,
  'labels_img': &LTnibabel.nifti1.Nifti1Image object at 0x7fd1f258ea90>,
  'low_pass': None,
  'mask_img': &LTnibabel.nifti1.Nifti1Image object at 0x7fd1b3426290>,
  'reports': True,
  'smoothing_fwhm': 2.0,
  'standardize': False,
  'standardize_confounds': True,
  'strategy': 'mean',
  't_r': None,
  'target_affine': None,
  'target_shape': None}, confounds=None, sample_mask=None, dtype=None, memory=Memory(location=nilearn_cache/joblib), memory_level=1, verbose=1)
[NiftiLabelsMasker.transform_single_imgs] Loading data from Nifti1Image('/home/remi/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[NiftiLabelsMasker.transform_single_imgs] Smoothing images
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
_______________________________________________filter_and_extract - 1.8s, 0.0min
ReNA 5000 clusters: 8.89s
</pre></div></div></section><section id=visualize-brain-parcellations-rena><h3>Visualize: Brain parcellations (ReNA)<a title="Permalink to this heading"class=headerlink href=#visualize-brain-parcellations-rena>#</a></h3><p>First, we display the parcellations of the brain image stored in attribute <cite>labels_img_</cite></p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>rena_labels_img</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>rena</span><span class=o>.</span><span class=n>labels_img_</span></a>

<span class=c1># Now, rena_labels_img are Nifti1Image object, it can be saved to file</span>
<span class=c1># with the following code:</span>
<a class="sphx-glr-backref-module-nibabel-filebasedimages sphx-glr-backref-type-py-method"href=https://nipy.org/nibabel/reference/nibabel.filebasedimages.html#nibabel.filebasedimages.FileBasedImage.to_filename title=nibabel.filebasedimages.FileBasedImage.to_filename><span class=n>rena_labels_img</span><span class=o>.</span><span class=n>to_filename</span></a><span class=p>(</span><span class=s2>"rena_parcellation.nii.gz"</span><span class=p>)</span>

<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_roi.html#nilearn.plotting.plot_roi title=nilearn.plotting.plot_roi><span class=n>plotting</span><span class=o>.</span><span class=n>plot_roi</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>ward_labels_img</span></a><span class=p>,</span>
    <span class=n>title</span><span class=o>=</span><span class=s2>"ReNA parcellation"</span><span class=p>,</span>
    <span class=n>display_mode</span><span class=o>=</span><span class=s2>"xz"</span><span class=p>,</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>cut_coords</span></a><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>cut_coords</span></a><span class=p>,</span>
<span class=p>)</span>
</pre></div></div><img alt="plot data driven parcellations"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_data_driven_parcellations_007.png srcset=../../_images/sphx_glr_plot_data_driven_parcellations_007.png><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>&LTnilearn.plotting.displays._slicers.XZSlicer object at 0x7fd1ecf25d10>
</pre></div></div></section><section id=compressed-representation-of-rena-clustering><h3>Compressed representation of ReNA clustering<a title="Permalink to this heading"class=headerlink href=#compressed-representation-of-rena-clustering>#</a></h3><p>We illustrate the effect that the clustering has on the signal. We show the original data, and the approximation provided by the clustering by averaging the signal on each parcel.</p><p>We can then compare the results with the compressed representation obtained with Ward.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=c1># Display the original data</span>
<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_epi.html#nilearn.plotting.plot_epi title=nilearn.plotting.plot_epi><span class=n>plotting</span><span class=o>.</span><span class=n>plot_epi</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>mean_func_img</span></a><span class=p>,</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>cut_coords</span></a><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>cut_coords</span></a><span class=p>,</span>
    <span class=n>title</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Original (</span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.int64 title=numpy.int64><span class=n>original_voxels</span></a><span class=p>)</span><span class=si>}</span><span class=s2> voxels)"</span><span class=p>,</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmax</span></a><span class=o>=</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmax</span></a><span class=p>,</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmin</span></a><span class=o>=</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmin</span></a><span class=p>,</span>
    <span class=n>display_mode</span><span class=o>=</span><span class=s2>"xz"</span><span class=p>,</span>
<span class=p>)</span>

<span class=c1># A reduced data can be created by taking the parcel-level average:</span>
<span class=c1># Note that, as many scikit-learn objects, the ReNA object exposes</span>
<span class=c1># a transform method that modifies input features. Here it reduces their</span>
<span class=c1># dimension.</span>
<span class=c1># However, the data are in one single large 4D image, we need to use</span>
<span class=c1># index_img to do the split easily:</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>fmri_reduced_rena</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations.transform title=nilearn.regions.Parcellations.transform><span class=n>rena</span><span class=o>.</span><span class=n>transform</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>dataset</span><span class=o>.</span><span class=n>func</span></a><span class=p>)</span>

<span class=c1># Display the corresponding data compression using the parcellation</span>
<a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>compressed_img_rena</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.regions.Parcellations.html#nilearn.regions.Parcellations.inverse_transform title=nilearn.regions.Parcellations.inverse_transform><span class=n>rena</span><span class=o>.</span><span class=n>inverse_transform</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>fmri_reduced_rena</span></a><span class=p>)</span>

<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_epi.html#nilearn.plotting.plot_epi title=nilearn.plotting.plot_epi><span class=n>plotting</span><span class=o>.</span><span class=n>plot_epi</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.index_img.html#nilearn.image.index_img title=nilearn.image.index_img><span class=n>index_img</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>compressed_img_rena</span></a><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>cut_coords</span></a><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.9/library/stdtypes.html#list title=builtins.list><span class=n>cut_coords</span></a><span class=p>,</span>
    <span class=n>title</span><span class=o>=</span><span class=s2>"ReNA compressed representation (5000 parcels)"</span><span class=p>,</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmin</span></a><span class=o>=</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmin</span></a><span class=p>,</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmax</span></a><span class=o>=</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"href=https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64 title=numpy.float64><span class=n>vmax</span></a><span class=p>,</span>
    <span class=n>display_mode</span><span class=o>=</span><span class=s2>"xz"</span><span class=p>,</span>
<span class=p>)</span>
</pre></div></div><ul class=sphx-glr-horizontal><li><img alt="plot data driven parcellations"class=sphx-glr-multi-img src=../../_images/sphx_glr_plot_data_driven_parcellations_008.png srcset=../../_images/sphx_glr_plot_data_driven_parcellations_008.png></li><li><img alt="plot data driven parcellations"class=sphx-glr-multi-img src=../../_images/sphx_glr_plot_data_driven_parcellations_009.png srcset=../../_images/sphx_glr_plot_data_driven_parcellations_009.png></li></ul><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>[Parcellations.wrapped] loading data from Nifti1Image('rena_parcellation.nii.gz')
[Parcellations.wrapped] loading data from Nifti1Image(
shape=(50, 59, 50),
affine=array([[   4.,    0.,    0.,  -96.],
       [   0.,    4.,    0., -132.],
       [   0.,    0.,    4.,  -78.],
       [   0.,    0.,    0.,    1.]])
)
________________________________________________________________________________
[Memory] Calling nilearn.maskers.base_masker._filter_and_extract...
_filter_and_extract(&LTnibabel.nifti1.Nifti1Image object at 0x7fd1b54359d0>, &LTnilearn.maskers.nifti_labels_masker._ExtractionFunctor object at 0x7fd1b38980d0>,
{ 'background_label': 0,
  'clean_kwargs': {},
  'detrend': False,
  'dtype': None,
  'high_pass': None,
  'high_variance_confounds': False,
  'keep_masked_labels': True,
  'labels': None,
  'labels_img': &LTnibabel.nifti1.Nifti1Image object at 0x7fd1b3743190>,
  'low_pass': None,
  'mask_img': &LTnibabel.nifti1.Nifti1Image object at 0x7fd1b31a2ed0>,
  'reports': True,
  'smoothing_fwhm': 2.0,
  'standardize': False,
  'standardize_confounds': True,
  'strategy': 'mean',
  't_r': None,
  'target_affine': None,
  'target_shape': None}, confounds=None, sample_mask=None, dtype=None, memory=Memory(location=nilearn_cache/joblib), memory_level=1, verbose=1)
[NiftiLabelsMasker.transform_single_imgs] Loading data from Nifti1Image('/home/remi/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[NiftiLabelsMasker.transform_single_imgs] Smoothing images
[NiftiLabelsMasker.transform_single_imgs] Extracting region signals
[NiftiLabelsMasker.transform_single_imgs] Cleaning extracted signals
_______________________________________________filter_and_extract - 1.8s, 0.0min

&LTnilearn.plotting.displays._slicers.XZSlicer object at 0x7fd1cf1bdd90>
</pre></div></div><p>Even if the compressed signal is relatively close to the original signal, we can notice that Ward Clustering gives a slightly more accurate compressed representation. However, as said in the previous section, the computation time is reduced which could still make ReNA more relevant than Ward in some cases.</p><p class=sphx-glr-timing><strong>Total running time of the script:</strong> (1 minutes 11.434 seconds)</p><p><strong>Estimated memory usage:</strong> 1978 MB</p><div class="sphx-glr-footer sphx-glr-footer-example docutils container"id=sphx-glr-download-auto-examples-03-connectivity-plot-data-driven-parcellations-py><div class="binder-badge docutils container"><a class="reference external image-reference"href=https://mybinder.org/v2/gh/nilearn/nilearn/0.10.2?urlpath=lab/tree/notebooks/auto_examples/03_connectivity/plot_data_driven_parcellations.ipynb><img alt="Launch binder"src=../../_images/binder_badge_logo3.svg width=150px></a></div><div class="sphx-glr-download sphx-glr-download-python docutils container"><p><a class="reference download internal"download href=../../_downloads/386459a6054ce7cb5a9328ff8bd14379/plot_data_driven_parcellations.py><code class="xref download docutils literal notranslate"><span class=pre>Download</span> <span class=pre>Python</span> <span class=pre>source</span> <span class=pre>code:</span> <span class=pre>plot_data_driven_parcellations.py</span></code></a></p></div><div class="sphx-glr-download sphx-glr-download-jupyter docutils container"><p><a class="reference download internal"download href=../../_downloads/34fef91c90f36da995898e159cc3d8e6/plot_data_driven_parcellations.ipynb><code class="xref download docutils literal notranslate"><span class=pre>Download</span> <span class=pre>Jupyter</span> <span class=pre>notebook:</span> <span class=pre>plot_data_driven_parcellations.ipynb</span></code></a></p></div></div><p class=sphx-glr-signature><a class="reference external"href=https://sphinx-gallery.github.io>Gallery generated by Sphinx-Gallery</a></p></section></section></section></article></div><footer><div class=related-pages><a class=next-page href=../04_glm_first_level/index.html> <div class=page-info><div class=context><span>Next</span></div><div class=title>GLM: First level analysis</div></div> <svg class=furo-related-icon><use href=#svg-arrow-right></use></svg> </a><a class=prev-page href=plot_sphere_based_connectome.html> <svg class=furo-related-icon><use href=#svg-arrow-right></use></svg> <div class=page-info><div class=context><span>Previous</span></div><div class=title>Extract signals on spheres and plot a connectome</div></div> </a></div><div class=bottom-of-page><div class=left-details><div class=copyright>Copyright © The nilearn developers 2010-2023</div> Made with <a href=https://www.sphinx-doc.org/>Sphinx</a> and <a class=muted-link href=https://pradyunsg.me>@pradyunsg</a>'s <a href=https://github.com/pradyunsg/furo>Furo</a></div><div class=right-details><div class=icons><a class="muted-link fa-brands fa-solid fa-github fa-2x"aria-label=GitHub href=https://github.com/nilearn/nilearn></a><a class="muted-link fa-brands fa-solid fa-twitter fa-2x"aria-label=Twitter href=https://twitter.com/nilearn></a><a class="muted-link fa-brands fa-solid fa-mastodon fa-2x"aria-label=Mastodon href=https://fosstodon.org/@nilearn></a><a class="muted-link fa-brands fa-solid fa-discord fa-2x"aria-label=Discord href=https://discord.gg/SsQABEJHkZ></a></div></div></div></footer></div><aside class=toc-drawer><div class="toc-sticky toc-scroll"><div class=toc-title-container><span class=toc-title> On this page </span></div><div class=toc-tree-container><div class=toc-tree><ul><li><a class="reference internal"href=#>Clustering methods to learn a brain parcellation from fMRI</a><ul><li><a class="reference internal"href=#references>References</a></li><li><a class="reference internal"href=#download-a-brain-development-fmri-dataset-and-turn-it-to-a-data-matrix>Download a brain development fmri dataset and turn it to a data matrix</a></li><li><a class="reference internal"href=#brain-parcellations-with-ward-clustering>Brain parcellations with Ward Clustering</a><ul><li><a class="reference internal"href=#visualize-brain-parcellations-ward>Visualize: Brain parcellations (Ward)</a></li><li><a class="reference internal"href=#compressed-representation-of-ward-clustering>Compressed representation of Ward clustering</a></li></ul></li><li><a class="reference internal"href=#brain-parcellations-with-kmeans-clustering>Brain parcellations with KMeans Clustering</a><ul><li><a class="reference internal"href=#visualize-brain-parcellations-kmeans>Visualize: Brain parcellations (KMeans)</a></li></ul></li><li><a class="reference internal"href=#brain-parcellations-with-hierarchical-kmeans-clustering>Brain parcellations with Hierarchical KMeans Clustering</a><ul><li><a class="reference internal"href=#visualize-brain-parcellations-hierarchical-kmeans>Visualize: Brain parcellations (Hierarchical KMeans)</a></li><li><a class="reference internal"href=#compare-hierarchical-kmeans-clusters-with-those-from-kmeans>Compare Hierarchical Kmeans clusters with those from Kmeans</a></li></ul></li><li><a class="reference internal"href=#brain-parcellations-with-rena-clustering>Brain parcellations with ReNA Clustering</a><ul><li><a class="reference internal"href=#id1>References</a></li><li><a class="reference internal"href=#visualize-brain-parcellations-rena>Visualize: Brain parcellations (ReNA)</a></li><li><a class="reference internal"href=#compressed-representation-of-rena-clustering>Compressed representation of ReNA clustering</a></li></ul></li></ul></li></ul></div></div></div></aside></div></div><script data-url_root=../../ id=documentation_options src=../../_static/documentation_options.js?v=b3ba4146></script><script src=../../_static/doctools.js?v=888ff710></script><script src=../../_static/sphinx_highlight.js?v=4825356b></script><script src=../../_static/scripts/furo.js?v=32e29ea5></script><script src=../../_static/clipboard.min.js?v=a7894cd8></script><script src=../../_static/copybutton.js?v=4ea706d9></script><script src=../../_static/design-tabs.js?v=36754332></script></body></html>