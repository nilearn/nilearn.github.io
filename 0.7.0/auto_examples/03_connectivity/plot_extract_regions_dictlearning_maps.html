<!doctypehtml><html lang=en xmlns=http://www.w3.org/1999/xhtml><meta content=IE=Edge http-equiv=X-UA-Compatible><meta content="text/html; charset=utf-8"http-equiv=Content-Type><title>Nilearn: Statistical Analysis for NeuroImaging in Python — Machine learning for NeuroImaging</title><link href=../../_static/nature.css rel=stylesheet><link href=../../_static/pygments.css rel=stylesheet><link href=../../_static/gallery.css rel=stylesheet><link href=../../_static/gallery-binder.css rel=stylesheet><link href=../../_static/gallery-dataframe.css rel=stylesheet><script data-url_root=../../ id=documentation_options src=../../_static/documentation_options.js></script><script src=../../_static/jquery.js></script><script src=../../_static/underscore.js></script><script src=../../_static/doctools.js></script><script src=../../_static/language_data.js></script><script src=../../_static/copybutton.js></script><link rel="shortcut icon"href=../../_static/favicon.ico><link href=../../search.html rel=search title=Search><link title="9.4.11. Clustering methods to learn a brain parcellation from fMRI"href=plot_data_driven_parcellations.html rel=next><link title="9.4.9. Classification of age groups using functional connectivity"href=plot_group_level_connectivity.html rel=prev><meta content=True name=HandheldFriendly><meta content=width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0 name=viewport><meta content="nilearn, neuroimaging, python, neuroscience, machinelearning"name=keywords><script>function updateTopMenuPosition(height, width) {
    if($(window).scrollTop() > height && $(window).outerWidth() > 1024) {
        //begin to scroll
        $('.related-wrapper').css("z-index", 1000);
        $('.related-wrapper').css("position", "sticky");
        $('.related-wrapper').css("top", 0);
        $('.related-wrapper').css("width", width)
    } else {
        //lock it back into place
        $('.related-wrapper').css("position", "relative");
        $('.related-wrapper').css("top", 0)
    }
}

$(function() {
    var banner_height = $('#logo-banner').outerHeight();
    var banner_width = $('#logo-banner').outerWidth();
    var width = $('.related-wrapper').css("height", $('.related').outerHeight());

    updateTopMenuPosition(banner_height, width);

    $(window).scroll(function(event) {
        updateTopMenuPosition(banner_height, width)
    });

    $(window).resize(function(event) {
        var banner_width = $('#logo-banner').outerWidth();
        var menu_height = $('.related').outerHeight();
        $('.related').css("width", banner_width);
        $('.related-wrapper').css("height", menu_height);
        updateTopMenuPosition(banner_height, width)
    })
});</script><script>function updateSideBarPosition(top, offset, sections) {
    var pos = $(window).scrollTop();
    // Lock the table of content to a fixed position once we scroll enough
    var topShift = 2 * offset;
    if(pos > top + topShift + 1) {
        // begin to scroll with sticky menu bar
        var topShift = -topShift + 1;
        if ($(window).outerWidth() < 1024) {
            // compensate top menu that disappears
            topShift -= offset + 1
        }
        $('.sphinxsidebarwrapper').css("position", "fixed");
        $('.sphinxsidebarwrapper').css("top", topShift)
    }
    else {
        //lock it back into place
        $('.sphinxsidebarwrapper').css("position", "relative");
        $('.sphinxsidebarwrapper').css("top",0)
    }

    // Highlight the current section
    i = 0;
    current_section = 0;
    $('a.internal').removeClass('active');
    for(i in sections) {
        if(sections[i] > pos) {
            break
        }
        if($('a.internal[href$="' + i + '"]').is(':visible')){
            current_section = i
        }
    }
    $('a.internal[href$="' + current_section + '"]').addClass('active');
    $('a.internal[href$="' + current_section + '"]').parent().addClass('active')
}

$(function () {
    // Lock the table of content to a fixed position once we scroll enough
    var tocOffset = $('.related-wrapper').outerHeight();
    var marginTop = parseFloat($('.sphinxsidebarwrapper').css('margin-top').replace(/auto/, 0));
    var top = $('.sphinxsidebarwrapper').offset().top - marginTop;
    sections = {};
    url = document.URL.replace(/#.*$/, "");

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50
    });

    updateSideBarPosition(top, tocOffset, sections);

    $(window).scroll(function(event) {
        updateSideBarPosition(top, tocOffset, sections)
    });

    $(window).resize(function(event) {
        tocOffset = $('.related-wrapper').outerHeight();
        updateSideBarPosition(top, tocOffset, sections)
    });
});</script><script>var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-41920728-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();</script></head><body><div id=logo-banner><div class=logo><a href=../../index.html> <img alt="Nilearn logo"border=0 src=../../_static/nilearn-logo.png> </a></div><div class=tags><ul><li><big><a href=../decoding/plot_haxby_anova_svm.html>SVM</a></big></li><li><small><a href=../../connectivity/parcellating.html>Ward clustering</a></small></li><li><a href=../../decoding/searchlight.html>Searchlight</a></li><li><big><a href=../../connectivity/resting_state_networks.html>ICA</a></big></li><li><a href=../../manipulating_images/data_preparation.html>Nifti IO</a></li><li><a href=../../modules/reference.html#module-nilearn.datasets>Datasets</a></li></ul></div><div class=banner><h1>Nilearn:</h1><h2>Statistics for NeuroImaging in Python</h2></div><div class=search_form><div class=gcse-search id=cse style=width:100%></div><script>(function() {
        var cx = '017289614950330089114:elrt9qoutrq';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();</script></div></div><div class=related-wrapper><div aria-label="related navigation"class=related role=navigation><h3>Navigation</h3><ul><li class=right style=margin-right:10px><a title="Python Module Index"href=../../py-modindex.html>modules</a></li><li class=right><a title="9.4.11. Clustering methods to learn a brain parcellation from fMRI"accesskey=N href=plot_data_driven_parcellations.html>next</a> |</li><li class=right><a title="9.4.9. Classification of age groups using functional connectivity"accesskey=P href=plot_group_level_connectivity.html>previous</a> |</li><li><a href=../../index.html>Nilearn Home</a> | </li><li><a href=../../user_guide.html>User Guide</a> | </li><li><a href=../index.html>Examples</a> | </li><li><a href=../../modules/reference.html>Reference</a> | </li><li id=navbar-about><a href=../../authors.html>About</a>| </li><li id=navbar-ecosystem><a href=http://www.nipy.org/>Nipy ecosystem</a></li><li class="nav-item nav-item-1"><a href=../../user_guide.html>User guide: table of contents</a> »</li><li class="nav-item nav-item-2"><a accesskey=U href=../index.html>9. Nilearn usage examples</a> »</li></ul></div></div><div class=document><div class=documentwrapper><div class=bodywrapper><div class=body role=main><div class="sphx-glr-download-link-note admonition note"><p class="first admonition-title">Note</p><p class=last>Click <a class="reference internal"href=#sphx-glr-download-auto-examples-03-connectivity-plot-extract-regions-dictlearning-maps-py><span class="std std-ref">here</span></a> to download the full example code or to run this example in your browser via Binder</p></div><div class="sphx-glr-example-title section"id=regions-extraction-using-dictionary-learning-and-functional-connectomes><span id=sphx-glr-auto-examples-03-connectivity-plot-extract-regions-dictlearning-maps-py></span><h1>9.4.10. Regions extraction using Dictionary Learning and functional connectomes<a title="Permalink to this headline"class=headerlink href=#regions-extraction-using-dictionary-learning-and-functional-connectomes>¶</a></h1><p>This example shows how to use <a class="reference internal"href=../../modules/generated/nilearn.regions.RegionExtractor.html#nilearn.regions.RegionExtractor title=nilearn.regions.RegionExtractor><code class="xref py py-class docutils literal notranslate"><span class=pre>nilearn.regions.RegionExtractor</span></code></a> to extract spatially constrained brain regions from whole brain maps decomposed using dictionary learning and use them to build a functional connectome.</p><p>We used 20 movie-watching functional datasets from <a class="reference internal"href=../../modules/generated/nilearn.datasets.fetch_development_fmri.html#nilearn.datasets.fetch_development_fmri title=nilearn.datasets.fetch_development_fmri><code class="xref py py-func docutils literal notranslate"><span class=pre>nilearn.datasets.fetch_development_fmri</span></code></a> and <a class="reference internal"href=../../modules/generated/nilearn.decomposition.DictLearning.html#nilearn.decomposition.DictLearning title=nilearn.decomposition.DictLearning><code class="xref py py-class docutils literal notranslate"><span class=pre>nilearn.decomposition.DictLearning</span></code></a> for set of brain atlas maps.</p><p>This example can also be inspired to apply the same steps to even regions extraction using ICA maps. In that case, idea would be to replace dictionary learning to canonical ICA decomposition using <a class="reference internal"href=../../modules/generated/nilearn.decomposition.CanICA.html#nilearn.decomposition.CanICA title=nilearn.decomposition.CanICA><code class="xref py py-class docutils literal notranslate"><span class=pre>nilearn.decomposition.CanICA</span></code></a></p><p>Please see the related documentation of <a class="reference internal"href=../../modules/generated/nilearn.regions.RegionExtractor.html#nilearn.regions.RegionExtractor title=nilearn.regions.RegionExtractor><code class="xref py py-class docutils literal notranslate"><span class=pre>nilearn.regions.RegionExtractor</span></code></a> for more details.</p><div class="admonition note"><p class="first admonition-title">Note</p><p class=last>The use of the attribute <cite>components_img_</cite> from dictionary learning estimator is implemented from version 0.4.1. For older versions, unmask the deprecated attribute <cite>components_</cite> to get the components image using attribute <cite>masker_</cite> embedded in estimator. See the <a class="reference internal"href=../../manipulating_images/masker_objects.html#unmasking-step><span class="std std-ref">section Inverse transform: unmasking data</span></a>.</p></div><div class=section id=fetch-brain-development-functional-datasets><h2>9.4.10.1. Fetch brain development functional datasets<a title="Permalink to this headline"class=headerlink href=#fetch-brain-development-functional-datasets>¶</a></h2><p>We use nilearn’s datasets downloading utilities</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn</span> <span class=k>import</span> <span class=n>datasets</span>

<a class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"href=https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch title=sklearn.utils.Bunch><span class=n>rest_dataset</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.datasets.fetch_development_fmri.html#nilearn.datasets.fetch_development_fmri title=nilearn.datasets.fetch_development_fmri><span class=n>datasets</span><span class=o>.</span><span class=n>fetch_development_fmri</span></a><span class=p>(</span><span class=n>n_subjects</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>func_filenames</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>rest_dataset</span><span class=o>.</span><span class=n>func</span></a>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>confounds</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>rest_dataset</span><span class=o>.</span><span class=n>confounds</span></a>
</pre></div></div></div><div class=section id=extract-functional-networks-with-dictionarylearning><h2>9.4.10.2. Extract functional networks with DictionaryLearning<a title="Permalink to this headline"class=headerlink href=#extract-functional-networks-with-dictionarylearning>¶</a></h2><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=c1># Import dictionary learning algorithm from decomposition module and call the</span>
<span class=c1># object and fit the model to the functional datasets</span>
<span class=kn>from</span> <span class=nn>nilearn.decomposition</span> <span class=k>import</span> <a class="sphx-glr-backref-module-nilearn-decomposition sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.decomposition.DictLearning.html#nilearn.decomposition.DictLearning title=nilearn.decomposition.DictLearning><span class=n>DictLearning</span></a>

<span class=c1># Initialize DictLearning object</span>
<a class="sphx-glr-backref-module-nilearn-decomposition sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.decomposition.DictLearning.html#nilearn.decomposition.DictLearning title=nilearn.decomposition.DictLearning><span class=n>dict_learn</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-decomposition sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.decomposition.DictLearning.html#nilearn.decomposition.DictLearning title=nilearn.decomposition.DictLearning><span class=n>DictLearning</span></a><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>smoothing_fwhm</span><span class=o>=</span><span class=mf>6.</span><span class=p>,</span>
                          <span class=n>memory</span><span class=o>=</span><span class=s2>"nilearn_cache"</span><span class=p>,</span> <span class=n>memory_level</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
                          <span class=n>random_state</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=c1># Fit to the data</span>
<a class="sphx-glr-backref-module-nilearn-decomposition sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.decomposition.DictLearning.html#nilearn.decomposition.DictLearning.fit title=nilearn.decomposition.DictLearning.fit><span class=n>dict_learn</span><span class=o>.</span><span class=n>fit</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>func_filenames</span></a><span class=p>)</span>
<span class=c1># Resting state networks/maps in attribute `components_img_`</span>
<span class=c1># Note that this attribute is implemented from version 0.4.1.</span>
<span class=c1># For older versions, see the note section above for details.</span>
<a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>components_img</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>dict_learn</span><span class=o>.</span><span class=n>components_img_</span></a>

<span class=c1># Visualization of functional networks</span>
<span class=c1># Show networks using plotting utilities</span>
<span class=kn>from</span> <span class=nn>nilearn</span> <span class=k>import</span> <span class=n>plotting</span>

<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_prob_atlas.html#nilearn.plotting.plot_prob_atlas title=nilearn.plotting.plot_prob_atlas><span class=n>plotting</span><span class=o>.</span><span class=n>plot_prob_atlas</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>components_img</span></a><span class=p>,</span> <span class=n>view_type</span><span class=o>=</span><span class=s1>'filled_contours'</span><span class=p>,</span>
                         <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>title</span></a><span class=o>=</span><span class=s1>'Dictionary Learning maps'</span><span class=p>)</span>
</pre></div></div><img alt="plot extract regions dictlearning maps"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_extract_regions_dictlearning_maps_001.png><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>/home/varoquau/dev/nilearn/nilearn/plotting/displays.py:97: UserWarning: linewidths is ignored by contourf
  im = getattr(ax, type)(data_2d.copy(),
/home/varoquau/dev/nilearn/nilearn/plotting/displays.py:97: UserWarning: No contour levels were found within the data range.
  im = getattr(ax, type)(data_2d.copy(),

&LTnilearn.plotting.displays.OrthoSlicer object at 0x7f8bfbcfd130>
</pre></div></div></div><div class=section id=extract-regions-from-networks><h2>9.4.10.3. Extract regions from networks<a title="Permalink to this headline"class=headerlink href=#extract-regions-from-networks>¶</a></h2><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=c1># Import Region Extractor algorithm from regions module</span>
<span class=c1># threshold=0.5 indicates that we keep nominal of amount nonzero voxels across all</span>
<span class=c1># maps, less the threshold means that more intense non-voxels will be survived.</span>
<span class=kn>from</span> <span class=nn>nilearn.regions</span> <span class=k>import</span> <a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.regions.RegionExtractor.html#nilearn.regions.RegionExtractor title=nilearn.regions.RegionExtractor><span class=n>RegionExtractor</span></a>

<a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.regions.RegionExtractor.html#nilearn.regions.RegionExtractor title=nilearn.regions.RegionExtractor><span class=n>extractor</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.regions.RegionExtractor.html#nilearn.regions.RegionExtractor title=nilearn.regions.RegionExtractor><span class=n>RegionExtractor</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>components_img</span></a><span class=p>,</span> <span class=n>threshold</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span>
                            <span class=n>thresholding_strategy</span><span class=o>=</span><span class=s1>'ratio_n_voxels'</span><span class=p>,</span>
                            <a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.regions.RegionExtractor.html#nilearn.regions.RegionExtractor title=nilearn.regions.RegionExtractor><span class=n>extractor</span></a><span class=o>=</span><span class=s1>'local_regions'</span><span class=p>,</span>
                            <span class=n>standardize</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>min_region_size</span><span class=o>=</span><span class=mi>1350</span><span class=p>)</span>
<span class=c1># Just call fit() to process for regions extraction</span>
<a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.regions.RegionExtractor.html#nilearn.regions.RegionExtractor.fit title=nilearn.regions.RegionExtractor.fit><span class=n>extractor</span><span class=o>.</span><span class=n>fit</span></a><span class=p>()</span>
<span class=c1># Extracted regions are stored in regions_img_</span>
<a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>regions_extracted_img</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>extractor</span><span class=o>.</span><span class=n>regions_img_</span></a>
<span class=c1># Each region index is stored in index_</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>regions_index</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>extractor</span><span class=o>.</span><span class=n>index_</span></a>
<span class=c1># Total number of regions extracted</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>n_regions_extracted</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nibabel-dataobj_images sphx-glr-backref-type-py-method"href=https://nipy.org/nibabel/reference/nibabel.dataobj_images.html#nibabel.dataobj_images.DataobjImage.shape title=nibabel.dataobj_images.DataobjImage.shape><span class=n>regions_extracted_img</span><span class=o>.</span><span class=n>shape</span></a><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>

<span class=c1># Visualization of region extraction results</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>title</span></a> <span class=o>=</span> <span class=p>(</span><span class=s1>'</span><span class=si>%d</span><span class=s1> regions are extracted from </span><span class=si>%d</span><span class=s1> components.'</span>
         <span class=s1>'</span><span class=se>\n</span><span class=s1>Each separate color of region indicates extracted region'</span>
         <span class=o>%</span> <span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>n_regions_extracted</span></a><span class=p>,</span> <span class=mi>8</span><span class=p>))</span>
<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_prob_atlas.html#nilearn.plotting.plot_prob_atlas title=nilearn.plotting.plot_prob_atlas><span class=n>plotting</span><span class=o>.</span><span class=n>plot_prob_atlas</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>regions_extracted_img</span></a><span class=p>,</span> <span class=n>view_type</span><span class=o>=</span><span class=s1>'filled_contours'</span><span class=p>,</span>
                         <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>title</span></a><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>title</span></a><span class=p>)</span>
</pre></div></div><img alt="plot extract regions dictlearning maps"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_extract_regions_dictlearning_maps_002.png><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>/home/varoquau/dev/nilearn/nilearn/plotting/displays.py:97: UserWarning: No contour levels were found within the data range.
  im = getattr(ax, type)(data_2d.copy(),
/home/varoquau/dev/nilearn/nilearn/plotting/displays.py:97: UserWarning: linewidths is ignored by contourf
  im = getattr(ax, type)(data_2d.copy(),
/usr/lib/python3/dist-packages/numpy/ma/core.py:2785: UserWarning: Warning: converting a masked element to nan.
  _data = np.array(data, dtype=dtype, copy=copy,

&LTnilearn.plotting.displays.OrthoSlicer object at 0x7f8bf7e23be0>
</pre></div></div></div><div class=section id=compute-correlation-coefficients><h2>9.4.10.4. Compute correlation coefficients<a title="Permalink to this headline"class=headerlink href=#compute-correlation-coefficients>¶</a></h2><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=c1># First we need to do subjects timeseries signals extraction and then estimating</span>
<span class=c1># correlation matrices on those signals.</span>
<span class=c1># To extract timeseries signals, we call transform() from RegionExtractor object</span>
<span class=c1># onto each subject functional data stored in func_filenames.</span>
<span class=c1># To estimate correlation matrices we import connectome utilities from nilearn</span>
<span class=kn>from</span> <span class=nn>nilearn.connectome</span> <span class=k>import</span> <a class="sphx-glr-backref-module-nilearn-connectome sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.connectome.ConnectivityMeasure.html#nilearn.connectome.ConnectivityMeasure title=nilearn.connectome.ConnectivityMeasure><span class=n>ConnectivityMeasure</span></a>

<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>correlations</span></a> <span class=o>=</span> <span class=p>[]</span>
<span class=c1># Initializing ConnectivityMeasure object with kind='correlation'</span>
<a class="sphx-glr-backref-module-nilearn-connectome sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.connectome.ConnectivityMeasure.html#nilearn.connectome.ConnectivityMeasure title=nilearn.connectome.ConnectivityMeasure><span class=n>connectome_measure</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-connectome sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.connectome.ConnectivityMeasure.html#nilearn.connectome.ConnectivityMeasure title=nilearn.connectome.ConnectivityMeasure><span class=n>ConnectivityMeasure</span></a><span class=p>(</span><span class=n>kind</span><span class=o>=</span><span class=s1>'correlation'</span><span class=p>)</span>
<span class=k>for</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>filename</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>confound</span></a> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>func_filenames</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>confounds</span></a><span class=p>):</span>
    <span class=c1># call transform from RegionExtractor object to extract timeseries signals</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>timeseries_each_subject</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-regions sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.regions.RegionExtractor.html#nilearn.regions.RegionExtractor.transform title=nilearn.regions.RegionExtractor.transform><span class=n>extractor</span><span class=o>.</span><span class=n>transform</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>filename</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>confounds</span></a><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>confound</span></a><span class=p>)</span>
    <span class=c1># call fit_transform from ConnectivityMeasure object</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>correlation</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-connectome sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.connectome.ConnectivityMeasure.html#nilearn.connectome.ConnectivityMeasure.fit_transform title=nilearn.connectome.ConnectivityMeasure.fit_transform><span class=n>connectome_measure</span><span class=o>.</span><span class=n>fit_transform</span></a><span class=p>([</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>timeseries_each_subject</span></a><span class=p>])</span>
    <span class=c1># saving each subject correlation to correlations</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>correlations</span></a><span class=o>.</span><span class=n>append</span><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>correlation</span></a><span class=p>)</span>

<span class=c1># Mean of all correlations</span>
<span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>mean_correlations</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean title=numpy.mean><span class=n>np</span><span class=o>.</span><span class=n>mean</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>correlations</span></a><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>n_regions_extracted</span></a><span class=p>,</span>
                                                          <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>n_regions_extracted</span></a><span class=p>)</span>
</pre></div></div></div><div class=section id=plot-resulting-connectomes><h2>9.4.10.5. Plot resulting connectomes<a title="Permalink to this headline"class=headerlink href=#plot-resulting-connectomes>¶</a></h2><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>title</span></a> <span class=o>=</span> <span class=s1>'Correlation between </span><span class=si>%d</span><span class=s1> regions'</span> <span class=o>%</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>n_regions_extracted</span></a>

<span class=c1># First plot the matrix</span>
<a class="sphx-glr-backref-module-nilearn-plotting-displays sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.plotting.displays.OrthoSlicer.html#nilearn.plotting.displays.OrthoSlicer title=nilearn.plotting.displays.OrthoSlicer><span class=n>display</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_matrix.html#nilearn.plotting.plot_matrix title=nilearn.plotting.plot_matrix><span class=n>plotting</span><span class=o>.</span><span class=n>plot_matrix</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>mean_correlations</span></a><span class=p>,</span> <span class=n>vmax</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>vmin</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
                               <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>title</span></a><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>title</span></a><span class=p>)</span>

<span class=c1># Then find the center of the regions and plot a connectome</span>
<a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>regions_img</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>regions_extracted_img</span></a>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>coords_connectome</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.find_probabilistic_atlas_cut_coords.html#nilearn.plotting.find_probabilistic_atlas_cut_coords title=nilearn.plotting.find_probabilistic_atlas_cut_coords><span class=n>plotting</span><span class=o>.</span><span class=n>find_probabilistic_atlas_cut_coords</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>regions_img</span></a><span class=p>)</span>

<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_connectome.html#nilearn.plotting.plot_connectome title=nilearn.plotting.plot_connectome><span class=n>plotting</span><span class=o>.</span><span class=n>plot_connectome</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>mean_correlations</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>coords_connectome</span></a><span class=p>,</span>
                         <span class=n>edge_threshold</span><span class=o>=</span><span class=s1>'90%'</span><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>title</span></a><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>title</span></a><span class=p>)</span>
</pre></div></div><ul class=sphx-glr-horizontal><li><img alt="plot extract regions dictlearning maps"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_extract_regions_dictlearning_maps_003.png></li><li><img alt="plot extract regions dictlearning maps"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_extract_regions_dictlearning_maps_004.png></li></ul><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>&LTnilearn.plotting.displays.OrthoProjector object at 0x7f8bfbcfd9a0>
</pre></div></div></div><div class=section id=plot-regions-extracted-for-only-one-specific-network><h2>9.4.10.6. Plot regions extracted for only one specific network<a title="Permalink to this headline"class=headerlink href=#plot-regions-extracted-for-only-one-specific-network>¶</a></h2><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=c1># First, we plot a network of index=4 without region extraction (left plot)</span>
<span class=kn>from</span> <span class=nn>nilearn</span> <span class=k>import</span> <span class=n>image</span>

<a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>img</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.index_img.html#nilearn.image.index_img title=nilearn.image.index_img><span class=n>image</span><span class=o>.</span><span class=n>index_img</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>components_img</span></a><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>coords</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.find_xyz_cut_coords.html#nilearn.plotting.find_xyz_cut_coords title=nilearn.plotting.find_xyz_cut_coords><span class=n>plotting</span><span class=o>.</span><span class=n>find_xyz_cut_coords</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>img</span></a><span class=p>)</span>
<a class="sphx-glr-backref-module-nilearn-plotting-displays sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.plotting.displays.OrthoSlicer.html#nilearn.plotting.displays.OrthoSlicer title=nilearn.plotting.displays.OrthoSlicer><span class=n>display</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map title=nilearn.plotting.plot_stat_map><span class=n>plotting</span><span class=o>.</span><span class=n>plot_stat_map</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>img</span></a><span class=p>,</span> <span class=n>cut_coords</span><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>coords</span></a><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                                 <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>title</span></a><span class=o>=</span><span class=s1>'Showing one specific network'</span><span class=p>)</span>
</pre></div></div><img alt="plot extract regions dictlearning maps"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_extract_regions_dictlearning_maps_005.png><p>Now, we plot (right side) same network after region extraction to show that connected regions are nicely seperated. Each brain extracted region is identified as separate color.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=c1># For this, we take the indices of the all regions extracted related to original</span>
<span class=c1># network given as 4.</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#tuple title=builtins.tuple><span class=n>regions_indices_of_map3</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where title=numpy.where><span class=n>np</span><span class=o>.</span><span class=n>where</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array title=numpy.array><span class=n>np</span><span class=o>.</span><span class=n>array</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>regions_index</span></a><span class=p>)</span> <span class=o>==</span> <span class=mi>4</span><span class=p>)</span>

<a class="sphx-glr-backref-module-nilearn-plotting-displays sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.plotting.displays.OrthoSlicer.html#nilearn.plotting.displays.OrthoSlicer title=nilearn.plotting.displays.OrthoSlicer><span class=n>display</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_anat.html#nilearn.plotting.plot_anat title=nilearn.plotting.plot_anat><span class=n>plotting</span><span class=o>.</span><span class=n>plot_anat</span></a><span class=p>(</span><span class=n>cut_coords</span><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>coords</span></a><span class=p>,</span>
                             <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>title</span></a><span class=o>=</span><span class=s1>'Regions from this network'</span><span class=p>)</span>

<span class=c1># Add as an overlay all the regions of index 4</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>colors</span></a> <span class=o>=</span> <span class=s1>'rgbcmyk'</span>
<span class=k>for</span> <span class=n>each_index_of_map3</span><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>color</span></a> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#tuple title=builtins.tuple><span class=n>regions_indices_of_map3</span></a><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>colors</span></a><span class=p>):</span>
    <a class="sphx-glr-backref-module-nilearn-plotting-displays sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.plotting.displays.OrthoSlicer.html#nilearn.plotting.displays.OrthoSlicer.add_overlay title=nilearn.plotting.displays.OrthoSlicer.add_overlay><span class=n>display</span><span class=o>.</span><span class=n>add_overlay</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.index_img.html#nilearn.image.index_img title=nilearn.image.index_img><span class=n>image</span><span class=o>.</span><span class=n>index_img</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>regions_extracted_img</span></a><span class=p>,</span> <span class=n>each_index_of_map3</span><span class=p>),</span>
                        <span class=n>cmap</span><span class=o>=</span><span class=n>plotting</span><span class=o>.</span><span class=n>cm</span><span class=o>.</span><span class=n>alpha_cmap</span><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#str title=builtins.str><span class=n>color</span></a><span class=p>))</span>

<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.show.html#nilearn.plotting.show title=nilearn.plotting.show><span class=n>plotting</span><span class=o>.</span><span class=n>show</span></a><span class=p>()</span>
</pre></div></div><img alt="plot extract regions dictlearning maps"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_extract_regions_dictlearning_maps_006.png><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>/usr/lib/python3/dist-packages/numpy/ma/core.py:2785: UserWarning: Warning: converting a masked element to nan.
  _data = np.array(data, dtype=dtype, copy=copy,
</pre></div></div><p class=sphx-glr-timing><strong>Total running time of the script:</strong> ( 2 minutes 30.270 seconds)</p><div class="sphx-glr-footer class sphx-glr-footer-example docutils container"id=sphx-glr-download-auto-examples-03-connectivity-plot-extract-regions-dictlearning-maps-py><div class="binder-badge docutils container"><a class="reference external image-reference"href=https://mybinder.org/v2/gh/nilearn/nilearn.github.io/master?filepath=examples/auto_examples/03_connectivity/plot_extract_regions_dictlearning_maps.ipynb><img alt=https://mybinder.org/badge_logo.svg src=https://mybinder.org/badge_logo.svg width=150px></a></div><div class="sphx-glr-download sphx-glr-download-python docutils container"><a class="reference download internal"download href=../../_downloads/2002f5d0c70b1223f14a1b2bac383088/plot_extract_regions_dictlearning_maps.py><code class="xref download docutils literal notranslate"><span class=pre>Download</span> <span class=pre>Python</span> <span class=pre>source</span> <span class=pre>code:</span> <span class=pre>plot_extract_regions_dictlearning_maps.py</span></code></a></div><div class="sphx-glr-download sphx-glr-download-jupyter docutils container"><a class="reference download internal"download href=../../_downloads/5976cdcff7162de25d2cd5d570937b0d/plot_extract_regions_dictlearning_maps.ipynb><code class="xref download docutils literal notranslate"><span class=pre>Download</span> <span class=pre>Jupyter</span> <span class=pre>notebook:</span> <span class=pre>plot_extract_regions_dictlearning_maps.ipynb</span></code></a></div></div><p class=sphx-glr-signature><a class="reference external"href=https://sphinx-gallery.github.io>Gallery generated by Sphinx-Gallery</a></p></div></div></div></div></div><div aria-label="main navigation"class=sphinxsidebar role=navigation><div class=sphinxsidebarwrapper><h4>Giving credit</h4><ul class=simple><li><p>Please consider <a href=../../authors.html#citing>citing the papers</a>.</p></li></ul><h3><a href=../../index.html>Table of Contents</a></h3><ul><li><a class="reference internal"href=#>9.4.10. Regions extraction using Dictionary Learning and functional connectomes</a><ul><li><a class="reference internal"href=#fetch-brain-development-functional-datasets>9.4.10.1. Fetch brain development functional datasets</a></li><li><a class="reference internal"href=#extract-functional-networks-with-dictionarylearning>9.4.10.2. Extract functional networks with DictionaryLearning</a></li><li><a class="reference internal"href=#extract-regions-from-networks>9.4.10.3. Extract regions from networks</a></li><li><a class="reference internal"href=#compute-correlation-coefficients>9.4.10.4. Compute correlation coefficients</a></li><li><a class="reference internal"href=#plot-resulting-connectomes>9.4.10.5. Plot resulting connectomes</a></li><li><a class="reference internal"href=#plot-regions-extracted-for-only-one-specific-network>9.4.10.6. Plot regions extracted for only one specific network</a></li></ul></li></ul><h4>Previous topic</h4><p class=topless><a title="previous chapter"href=plot_group_level_connectivity.html>9.4.9. Classification of age groups using functional connectivity</a></p><h4>Next topic</h4><p class=topless><a title="next chapter"href=plot_data_driven_parcellations.html>9.4.11. Clustering methods to learn a brain parcellation from fMRI</a></p><div id=searchbox role=search style=display:none><h3>Quick search</h3><div class=searchformwrapper><form action=../../search.html class=search><input name=q><input type=submit value=Go><input name=check_keywords type=hidden value=yes><input name=area type=hidden value=default></form></div></div><script>$('#searchbox').show(0);</script></div></div><div class=clearer></div></div><div class=footer>© The nilearn developers 2010-2020. Created using <a href=http://sphinx.pocoo.org/>Sphinx</a> 1.8.5. <span style=padding-left:5ex> <a href=../../_sources/auto_examples/03_connectivity/plot_extract_regions_dictlearning_maps.rst.txt rel=nofollow>Show this page source</a> </span></div></body></html>