<!doctypehtml><html lang=en xmlns=http://www.w3.org/1999/xhtml><meta content=IE=Edge http-equiv=X-UA-Compatible><meta content="text/html; charset=utf-8"http-equiv=Content-Type><title>Nilearn: Statistical Analysis for NeuroImaging in Python — Machine learning for NeuroImaging</title><link href=../../_static/nature.css rel=stylesheet><link href=../../_static/pygments.css rel=stylesheet><link href=../../_static/gallery.css rel=stylesheet><link href=../../_static/gallery-binder.css rel=stylesheet><link href=../../_static/gallery-dataframe.css rel=stylesheet><script data-url_root=../../ id=documentation_options src=../../_static/documentation_options.js></script><script src=../../_static/jquery.js></script><script src=../../_static/underscore.js></script><script src=../../_static/doctools.js></script><script src=../../_static/language_data.js></script><script src=../../_static/copybutton.js></script><link rel="shortcut icon"href=../../_static/favicon.ico><link href=../../search.html rel=search title=Search><link title="9.4.6. Comparing connectomes on different reference atlases"href=plot_atlas_comparison.html rel=next><link title="9.4.4. Connectivity structure estimation on simulated data"href=plot_simulated_connectome.html rel=prev><meta content=True name=HandheldFriendly><meta content=width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0 name=viewport><meta content="nilearn, neuroimaging, python, neuroscience, machinelearning"name=keywords><script>function updateTopMenuPosition(height, width) {
    if($(window).scrollTop() > height && $(window).outerWidth() > 1024) {
        //begin to scroll
        $('.related-wrapper').css("z-index", 1000);
        $('.related-wrapper').css("position", "sticky");
        $('.related-wrapper').css("top", 0);
        $('.related-wrapper').css("width", width)
    } else {
        //lock it back into place
        $('.related-wrapper').css("position", "relative");
        $('.related-wrapper').css("top", 0)
    }
}

$(function() {
    var banner_height = $('#logo-banner').outerHeight();
    var banner_width = $('#logo-banner').outerWidth();
    var width = $('.related-wrapper').css("height", $('.related').outerHeight());

    updateTopMenuPosition(banner_height, width);

    $(window).scroll(function(event) {
        updateTopMenuPosition(banner_height, width)
    });

    $(window).resize(function(event) {
        var banner_width = $('#logo-banner').outerWidth();
        var menu_height = $('.related').outerHeight();
        $('.related').css("width", banner_width);
        $('.related-wrapper').css("height", menu_height);
        updateTopMenuPosition(banner_height, width)
    })
});</script><script>function updateSideBarPosition(top, offset, sections) {
    var pos = $(window).scrollTop();
    // Lock the table of content to a fixed position once we scroll enough
    var topShift = 2 * offset;
    if(pos > top + topShift + 1) {
        // begin to scroll with sticky menu bar
        var topShift = -topShift + 1;
        if ($(window).outerWidth() < 1024) {
            // compensate top menu that disappears
            topShift -= offset + 1
        }
        $('.sphinxsidebarwrapper').css("position", "fixed");
        $('.sphinxsidebarwrapper').css("top", topShift)
    }
    else {
        //lock it back into place
        $('.sphinxsidebarwrapper').css("position", "relative");
        $('.sphinxsidebarwrapper').css("top",0)
    }

    // Highlight the current section
    i = 0;
    current_section = 0;
    $('a.internal').removeClass('active');
    for(i in sections) {
        if(sections[i] > pos) {
            break
        }
        if($('a.internal[href$="' + i + '"]').is(':visible')){
            current_section = i
        }
    }
    $('a.internal[href$="' + current_section + '"]').addClass('active');
    $('a.internal[href$="' + current_section + '"]').parent().addClass('active')
}

$(function () {
    // Lock the table of content to a fixed position once we scroll enough
    var tocOffset = $('.related-wrapper').outerHeight();
    var marginTop = parseFloat($('.sphinxsidebarwrapper').css('margin-top').replace(/auto/, 0));
    var top = $('.sphinxsidebarwrapper').offset().top - marginTop;
    sections = {};
    url = document.URL.replace(/#.*$/, "");

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50
    });

    updateSideBarPosition(top, tocOffset, sections);

    $(window).scroll(function(event) {
        updateSideBarPosition(top, tocOffset, sections)
    });

    $(window).resize(function(event) {
        tocOffset = $('.related-wrapper').outerHeight();
        updateSideBarPosition(top, tocOffset, sections)
    });
});</script><script>var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-41920728-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();</script></head><body><div id=logo-banner><div class=logo><a href=../../index.html> <img alt="Nilearn logo"border=0 src=../../_static/nilearn-logo.png> </a></div><div class=tags><ul><li><big><a href=../decoding/plot_haxby_anova_svm.html>SVM</a></big></li><li><small><a href=../../connectivity/parcellating.html>Ward clustering</a></small></li><li><a href=../../decoding/searchlight.html>Searchlight</a></li><li><big><a href=../../connectivity/resting_state_networks.html>ICA</a></big></li><li><a href=../../manipulating_images/data_preparation.html>Nifti IO</a></li><li><a href=../../modules/reference.html#module-nilearn.datasets>Datasets</a></li></ul></div><div class=banner><h1>Nilearn:</h1><h2>Statistics for NeuroImaging in Python</h2></div><div class=search_form><div class=gcse-search id=cse style=width:100%></div><script>(function() {
        var cx = '017289614950330089114:elrt9qoutrq';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();</script></div></div><div class=related-wrapper><div aria-label="related navigation"class=related role=navigation><h3>Navigation</h3><ul><li class=right style=margin-right:10px><a title="Python Module Index"href=../../py-modindex.html>modules</a></li><li class=right><a title="9.4.6. Comparing connectomes on different reference atlases"accesskey=N href=plot_atlas_comparison.html>next</a> |</li><li class=right><a title="9.4.4. Connectivity structure estimation on simulated data"accesskey=P href=plot_simulated_connectome.html>previous</a> |</li><li><a href=../../index.html>Nilearn Home</a> | </li><li><a href=../../user_guide.html>User Guide</a> | </li><li><a href=../index.html>Examples</a> | </li><li><a href=../../modules/reference.html>Reference</a> | </li><li id=navbar-about><a href=../../authors.html>About</a>| </li><li id=navbar-ecosystem><a href=http://www.nipy.org/>Nipy ecosystem</a></li><li class="nav-item nav-item-1"><a href=../../user_guide.html>User guide: table of contents</a> »</li><li class="nav-item nav-item-2"><a accesskey=U href=../index.html>9. Nilearn usage examples</a> »</li></ul></div></div><div class=document><div class=documentwrapper><div class=bodywrapper><div class=body role=main><div class="sphx-glr-download-link-note admonition note"><p class="first admonition-title">Note</p><p class=last>Click <a class="reference internal"href=#sphx-glr-download-auto-examples-03-connectivity-plot-compare-decomposition-py><span class="std std-ref">here</span></a> to download the full example code or to run this example in your browser via Binder</p></div><div class="sphx-glr-example-title section"id=deriving-spatial-maps-from-group-fmri-data-using-ica-and-dictionary-learning><span id=sphx-glr-auto-examples-03-connectivity-plot-compare-decomposition-py></span><h1>9.4.5. Deriving spatial maps from group fMRI data using ICA and Dictionary Learning<a title="Permalink to this headline"class=headerlink href=#deriving-spatial-maps-from-group-fmri-data-using-ica-and-dictionary-learning>¶</a></h1><p>Various approaches exist to derive spatial maps or networks from group fmr data. The methods extract distributed brain regions that exhibit similar BOLD fluctuations over time. Decomposition methods allow for generation of many independent maps simultaneously without the need to provide a priori information (e.g. seeds or priors.)</p><p>This example will apply two popular decomposition methods, ICA and Dictionary Learning, to fMRI data measured while children and young adults watch movies. The resulting maps will be visualized using atlas plotting tools.</p><p>CanICA is an ICA method for group-level analysis of fMRI data. Compared to other strategies, it brings a well-controlled group model, as well as a thresholding algorithm controlling for specificity and sensitivity with an explicit model of the signal. The reference paper is:</p><blockquote><div><ul class=simple><li>G. Varoquaux et al. “A group model for stable multi-subject ICA on fMRI datasets”, NeuroImage Vol 51 (2010), p. 288-299 <a class="reference external"href=https://hal.inria.fr/hal-00489507/>preprint</a></li></ul></div></blockquote><div class=section id=load-brain-development-fmri-dataset><h2>9.4.5.1. Load brain development fmri dataset<a title="Permalink to this headline"class=headerlink href=#load-brain-development-fmri-dataset>¶</a></h2><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn</span> <span class=k>import</span> <span class=n>datasets</span>

<a class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"href=https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch title=sklearn.utils.Bunch><span class=n>rest_dataset</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.datasets.fetch_development_fmri.html#nilearn.datasets.fetch_development_fmri title=nilearn.datasets.fetch_development_fmri><span class=n>datasets</span><span class=o>.</span><span class=n>fetch_development_fmri</span></a><span class=p>(</span><span class=n>n_subjects</span><span class=o>=</span><span class=mi>30</span><span class=p>)</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>func_filenames</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>rest_dataset</span><span class=o>.</span><span class=n>func</span></a>  <span class=c1># list of 4D nifti files for each subject</span>

<span class=c1># print basic information on the dataset</span>
<span class=nb>print</span><span class=p>(</span><span class=s1>'First functional nifti image (4D) is at: </span><span class=si>%s</span><span class=s1>'</span> <span class=o>%</span>
      <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>rest_dataset</span><span class=o>.</span><span class=n>func</span></a><span class=p>[</span><span class=mi>0</span><span class=p>])</span>  <span class=c1># 4D data</span>
</pre></div></div><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>First functional nifti image (4D) is at: /home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz
</pre></div></div></div><div class=section id=apply-canica-on-the-data><h2>9.4.5.2. Apply CanICA on the data<a title="Permalink to this headline"class=headerlink href=#apply-canica-on-the-data>¶</a></h2><p>We use as “template” as a strategy to compute the mask, as this leads to slightly faster and more reproducible results. However, the images need to be in MNI template space</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn.decomposition</span> <span class=k>import</span> <a class="sphx-glr-backref-module-nilearn-decomposition sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.decomposition.CanICA.html#nilearn.decomposition.CanICA title=nilearn.decomposition.CanICA><span class=n>CanICA</span></a>

<a class="sphx-glr-backref-module-nilearn-decomposition sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.decomposition.CanICA.html#nilearn.decomposition.CanICA title=nilearn.decomposition.CanICA><span class=n>canica</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-decomposition sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.decomposition.CanICA.html#nilearn.decomposition.CanICA title=nilearn.decomposition.CanICA><span class=n>CanICA</span></a><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
                <span class=n>memory</span><span class=o>=</span><span class=s2>"nilearn_cache"</span><span class=p>,</span> <span class=n>memory_level</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
                <span class=n>verbose</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
                <span class=n>mask_strategy</span><span class=o>=</span><span class=s1>'template'</span><span class=p>,</span>
                <span class=n>random_state</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<a class="sphx-glr-backref-module-nilearn-decomposition sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.decomposition.CanICA.html#nilearn.decomposition.CanICA.fit title=nilearn.decomposition.CanICA.fit><span class=n>canica</span><span class=o>.</span><span class=n>fit</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>func_filenames</span></a><span class=p>)</span>

<span class=c1># Retrieve the independent components in brain space. Directly</span>
<span class=c1># accesible through attribute `components_img_`.</span>
<a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>canica_components_img</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>canica</span><span class=o>.</span><span class=n>components_img_</span></a>
<span class=c1># components_img is a Nifti Image object, and can be saved to a file with</span>
<span class=c1># the following line:</span>
<a class="sphx-glr-backref-module-nibabel-filebasedimages sphx-glr-backref-type-py-method"href=https://nipy.org/nibabel/reference/nibabel.filebasedimages.html#nibabel.filebasedimages.FileBasedImage.to_filename title=nibabel.filebasedimages.FileBasedImage.to_filename><span class=n>canica_components_img</span><span class=o>.</span><span class=n>to_filename</span></a><span class=p>(</span><span class=s1>'canica_resting_state.nii.gz'</span><span class=p>)</span>
</pre></div></div><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>[MultiNiftiMasker.fit] Loading data from [/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz, /home/varoquau/nilearn_data/development_fmri/development_fmri
[MultiNiftiMasker.fit] Computing mask
Template mask computation
[MultiNiftiMasker.transform] Resampling mask
[CanICA] Loading data
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar124_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar125_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar126_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar127_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar128_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar001_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar002_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar003_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar004_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar005_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar006_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar007_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar008_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar009_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar010_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar011_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar012_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar013_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar014_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar015_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar016_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar017_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar018_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar019_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar020_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar021_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar022_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar023_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar024_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
________________________________________________________________________________
[Memory] Calling sklearn.utils.extmath.randomized_svd...
randomized_svd(array([[ 0.000122, ..., -0.002608],
       ...,
       [ 0.008465, ...,  0.014592]]), n_components=20, transpose=True, random_state=0, n_iter=3)
___________________________________________________randomized_svd - 1.2s, 0.0min
[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
________________________________________________________________________________
[Memory] Calling sklearn.decomposition._fastica.fastica...
fastica(array([[ 0.004444, ...,  0.00178 ],
       ...,
       [ 0.003941, ..., -0.000749]]), whiten=True, fun='cube', random_state=209652396)
__________________________________________________________fastica - 0.8s, 0.0min
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.8s remaining:    0.0s
________________________________________________________________________________
[Memory] Calling sklearn.decomposition._fastica.fastica...
fastica(array([[ 0.004444, ...,  0.00178 ],
       ...,
       [ 0.003941, ..., -0.000749]]), whiten=True, fun='cube', random_state=398764591)
__________________________________________________________fastica - 1.2s, 0.0min
[Parallel(n_jobs=1)]: Done   2 out of   2 | elapsed:    2.0s remaining:    0.0s
________________________________________________________________________________
[Memory] Calling sklearn.decomposition._fastica.fastica...
fastica(array([[ 0.004444, ...,  0.00178 ],
       ...,
       [ 0.003941, ..., -0.000749]]), whiten=True, fun='cube', random_state=924231285)
__________________________________________________________fastica - 1.1s, 0.0min
[Parallel(n_jobs=1)]: Done   3 out of   3 | elapsed:    3.1s remaining:    0.0s
________________________________________________________________________________
[Memory] Calling sklearn.decomposition._fastica.fastica...
fastica(array([[ 0.004444, ...,  0.00178 ],
       ...,
       [ 0.003941, ..., -0.000749]]), whiten=True, fun='cube', random_state=1478610112)
__________________________________________________________fastica - 1.1s, 0.0min
[Parallel(n_jobs=1)]: Done   4 out of   4 | elapsed:    4.2s remaining:    0.0s
________________________________________________________________________________
[Memory] Calling sklearn.decomposition._fastica.fastica...
fastica(array([[ 0.004444, ...,  0.00178 ],
       ...,
       [ 0.003941, ..., -0.000749]]), whiten=True, fun='cube', random_state=441365315)
__________________________________________________________fastica - 1.1s, 0.0min
[Parallel(n_jobs=1)]: Done   5 out of   5 | elapsed:    5.2s remaining:    0.0s
________________________________________________________________________________
[Memory] Calling sklearn.decomposition._fastica.fastica...
fastica(array([[ 0.004444, ...,  0.00178 ],
       ...,
       [ 0.003941, ..., -0.000749]]), whiten=True, fun='cube', random_state=1537364731)
__________________________________________________________fastica - 1.0s, 0.0min
[Parallel(n_jobs=1)]: Done   6 out of   6 | elapsed:    6.3s remaining:    0.0s
________________________________________________________________________________
[Memory] Calling sklearn.decomposition._fastica.fastica...
fastica(array([[ 0.004444, ...,  0.00178 ],
       ...,
       [ 0.003941, ..., -0.000749]]), whiten=True, fun='cube', random_state=192771779)
__________________________________________________________fastica - 1.0s, 0.0min
[Parallel(n_jobs=1)]: Done   7 out of   7 | elapsed:    7.3s remaining:    0.0s
________________________________________________________________________________
[Memory] Calling sklearn.decomposition._fastica.fastica...
fastica(array([[ 0.004444, ...,  0.00178 ],
       ...,
       [ 0.003941, ..., -0.000749]]), whiten=True, fun='cube', random_state=1491434855)
__________________________________________________________fastica - 1.0s, 0.0min
[Parallel(n_jobs=1)]: Done   8 out of   8 | elapsed:    8.2s remaining:    0.0s
________________________________________________________________________________
[Memory] Calling sklearn.decomposition._fastica.fastica...
fastica(array([[ 0.004444, ...,  0.00178 ],
       ...,
       [ 0.003941, ..., -0.000749]]), whiten=True, fun='cube', random_state=1819583497)
__________________________________________________________fastica - 1.0s, 0.0min
[Parallel(n_jobs=1)]: Done   9 out of   9 | elapsed:    9.3s remaining:    0.0s
________________________________________________________________________________
[Memory] Calling sklearn.decomposition._fastica.fastica...
fastica(array([[ 0.004444, ...,  0.00178 ],
       ...,
       [ 0.003941, ..., -0.000749]]), whiten=True, fun='cube', random_state=530702035)
__________________________________________________________fastica - 0.9s, 0.0min
[Parallel(n_jobs=1)]: Done  10 out of  10 | elapsed:   10.2s finished
</pre></div></div><p>To visualize we plot the outline of all components on one figure</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn.plotting</span> <span class=k>import</span> <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_prob_atlas.html#nilearn.plotting.plot_prob_atlas title=nilearn.plotting.plot_prob_atlas><span class=n>plot_prob_atlas</span></a>

<span class=c1># Plot all ICA components together</span>
<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_prob_atlas.html#nilearn.plotting.plot_prob_atlas title=nilearn.plotting.plot_prob_atlas><span class=n>plot_prob_atlas</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>canica_components_img</span></a><span class=p>,</span> <span class=n>title</span><span class=o>=</span><span class=s1>'All ICA components'</span><span class=p>)</span>
</pre></div></div><img alt="plot compare decomposition"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_compare_decomposition_001.png><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>/home/varoquau/dev/nilearn/nilearn/plotting/displays.py:97: UserWarning: linewidths is ignored by contourf
  im = getattr(ax, type)(data_2d.copy(),
/home/varoquau/dev/nilearn/nilearn/plotting/displays.py:97: UserWarning: No contour levels were found within the data range.
  im = getattr(ax, type)(data_2d.copy(),
/usr/lib/python3/dist-packages/numpy/ma/core.py:2785: UserWarning: Warning: converting a masked element to nan.
  _data = np.array(data, dtype=dtype, copy=copy,

&LTnilearn.plotting.displays.OrthoSlicer object at 0x7f8c0e6c5a60>
</pre></div></div><p>Finally, we plot the map for each ICA component separately</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn.image</span> <span class=k>import</span> <a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.iter_img.html#nilearn.image.iter_img title=nilearn.image.iter_img><span class=n>iter_img</span></a>
<span class=kn>from</span> <span class=nn>nilearn.plotting</span> <span class=k>import</span> <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map title=nilearn.plotting.plot_stat_map><span class=n>plot_stat_map</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.show.html#nilearn.plotting.show title=nilearn.plotting.show><span class=n>show</span></a>

<span class=k>for</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>i</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>cur_img</span></a> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.iter_img.html#nilearn.image.iter_img title=nilearn.image.iter_img><span class=n>iter_img</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>canica_components_img</span></a><span class=p>)):</span>
    <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map title=nilearn.plotting.plot_stat_map><span class=n>plot_stat_map</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>cur_img</span></a><span class=p>,</span> <span class=n>display_mode</span><span class=o>=</span><span class=s2>"z"</span><span class=p>,</span> <span class=n>title</span><span class=o>=</span><span class=s2>"IC </span><span class=si>%d</span><span class=s2>"</span> <span class=o>%</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>i</span></a><span class=p>,</span>
                  <span class=n>cut_coords</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</pre></div></div><ul class=sphx-glr-horizontal><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_002.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_003.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_004.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_005.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_006.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_007.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_008.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_009.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_010.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_011.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_012.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_013.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_014.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_015.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_016.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_017.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_018.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_019.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_020.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_021.png></li></ul><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>/home/varoquau/dev/nilearn/nilearn/plotting/displays.py:1608: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  ax = fh.add_axes([fraction * index * (x1 - x0) + x0, y0,
</pre></div></div></div><div class=section id=compare-canica-to-dictionary-learning><h2>9.4.5.3. Compare CanICA to dictionary learning<a title="Permalink to this headline"class=headerlink href=#compare-canica-to-dictionary-learning>¶</a></h2><p>Dictionary learning is a sparsity based decomposition method for extracting spatial maps. It extracts maps that are naturally sparse and usually cleaner than ICA. Here, we will compare networks built with CanICA to networks built with Dictionary Learning.</p><blockquote><div><ul class=simple><li>Arthur Mensch et al. <a class="reference external"href=https://hal.archives-ouvertes.fr/hal-01271033/>Compressed online dictionary learning for fast resting-state fMRI decomposition</a>, ISBI 2016, Lecture Notes in Computer Science</li></ul></div></blockquote><p>Create a dictionary learning estimator</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn.decomposition</span> <span class=k>import</span> <a class="sphx-glr-backref-module-nilearn-decomposition sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.decomposition.DictLearning.html#nilearn.decomposition.DictLearning title=nilearn.decomposition.DictLearning><span class=n>DictLearning</span></a>

<a class="sphx-glr-backref-module-nilearn-decomposition sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.decomposition.DictLearning.html#nilearn.decomposition.DictLearning title=nilearn.decomposition.DictLearning><span class=n>dict_learning</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-decomposition sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.decomposition.DictLearning.html#nilearn.decomposition.DictLearning title=nilearn.decomposition.DictLearning><span class=n>DictLearning</span></a><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
                             <span class=n>memory</span><span class=o>=</span><span class=s2>"nilearn_cache"</span><span class=p>,</span> <span class=n>memory_level</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
                             <span class=n>verbose</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
                             <span class=n>random_state</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
                             <span class=n>n_epochs</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
                             <span class=n>mask_strategy</span><span class=o>=</span><span class=s1>'template'</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s1>'[Example] Fitting dicitonary learning model'</span><span class=p>)</span>
<a class="sphx-glr-backref-module-nilearn-decomposition sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.decomposition.DictLearning.html#nilearn.decomposition.DictLearning.fit title=nilearn.decomposition.DictLearning.fit><span class=n>dict_learning</span><span class=o>.</span><span class=n>fit</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>func_filenames</span></a><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s1>'[Example] Saving results'</span><span class=p>)</span>
<span class=c1># Grab extracted components umasked back to Nifti image.</span>
<span class=c1># Note: For older versions, less than 0.4.1. components_img_</span>
<span class=c1># is not implemented. See Note section above for details.</span>
<a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>dictlearning_components_img</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>dict_learning</span><span class=o>.</span><span class=n>components_img_</span></a>
<a class="sphx-glr-backref-module-nibabel-filebasedimages sphx-glr-backref-type-py-method"href=https://nipy.org/nibabel/reference/nibabel.filebasedimages.html#nibabel.filebasedimages.FileBasedImage.to_filename title=nibabel.filebasedimages.FileBasedImage.to_filename><span class=n>dictlearning_components_img</span><span class=o>.</span><span class=n>to_filename</span></a><span class=p>(</span><span class=s1>'dictionary_learning_resting_state.nii.gz'</span><span class=p>)</span>
</pre></div></div><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>[Example] Fitting dicitonary learning model
[MultiNiftiMasker.fit] Loading data from [/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz, /home/varoquau/nilearn_data/development_fmri/development_fmri
[MultiNiftiMasker.fit] Computing mask
[MultiNiftiMasker.transform] Resampling mask
[DictLearning] Loading data
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar123_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar124_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar125_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar126_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar127_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar128_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar001_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar002_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar003_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar004_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar005_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar006_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar007_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar008_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar009_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar010_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar011_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar012_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar013_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar014_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar015_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar016_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar017_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar018_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar019_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar020_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar021_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar022_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar023_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[MultiNiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/home/varoquau/nilearn_data/development_fmri/development_fmri/sub-pixar024_task-pixar_space-MNI152NLin2009cAsym_desc-preproc_bold.nii.gz')
[MultiNiftiMasker.transform_single_imgs] Smoothing images
[MultiNiftiMasker.transform_single_imgs] Extracting region signals
[MultiNiftiMasker.transform_single_imgs] Cleaning extracted signals
[DictLearning] Learning initial components
________________________________________________________________________________
[Memory] Calling sklearn.utils.extmath.randomized_svd...
randomized_svd(array([[-0.004311, ..., -0.00529 ],
       ...,
       [ 0.000154, ..., -0.000616]]), n_components=20, transpose=True, random_state=0, n_iter=3)
___________________________________________________randomized_svd - 1.3s, 0.0min
[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
________________________________________________________________________________
[Memory] Calling sklearn.decomposition._fastica.fastica...
fastica(array([[ 0.003984, ..., -0.000365],
       ...,
       [ 0.003424, ..., -0.000217]]), whiten=True, fun='cube', random_state=209652396)
__________________________________________________________fastica - 0.7s, 0.0min
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.7s finished
[DictLearning] Computing initial loadings
________________________________________________________________________________
[Memory] Calling nilearn.decomposition.dict_learning._compute_loadings...
_compute_loadings(array([[ 0.000721, ...,  0.003171],
       ...,
       [-0.000765, ...,  0.002215]]),
array([[-2.447325, ...,  0.087449],
       ...,
       [-1.102784, ..., -0.128454]]))
_________________________________________________compute_loadings - 0.3s, 0.0min
[DictLearning] Learning dictionary
________________________________________________________________________________
[Memory] Calling sklearn.decomposition._dict_learning.dict_learning_online...
dict_learning_online(array([[-2.447325, ..., -1.102784],
       ...,
       [ 0.087449, ..., -0.128454]]),
20, alpha=10, n_iter=1428, batch_size=20, method='cd', dict_init=array([[ 0.110191, ...,  0.125407],
       ...,
       [ 0.635503, ..., -0.186259]]), verbose=0, random_state=0, return_code=True, shuffle=True, n_jobs=1)
_____________________________________________dict_learning_online - 5.6s, 0.1min
[Example] Saving results
</pre></div></div><p>Visualize the results</p><p>First plot all DictLearning components together</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_prob_atlas.html#nilearn.plotting.plot_prob_atlas title=nilearn.plotting.plot_prob_atlas><span class=n>plot_prob_atlas</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>dictlearning_components_img</span></a><span class=p>,</span>
                <span class=n>title</span><span class=o>=</span><span class=s1>'All DictLearning components'</span><span class=p>)</span>
</pre></div></div><img alt="plot compare decomposition"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_compare_decomposition_022.png><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>/home/varoquau/dev/nilearn/nilearn/plotting/displays.py:97: UserWarning: No contour levels were found within the data range.
  im = getattr(ax, type)(data_2d.copy(),
/home/varoquau/dev/nilearn/nilearn/plotting/displays.py:97: UserWarning: linewidths is ignored by contourf
  im = getattr(ax, type)(data_2d.copy(),

&LTnilearn.plotting.displays.OrthoSlicer object at 0x7f8bfaf20a30>
</pre></div></div><p>One plot of each component</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=k>for</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>i</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>cur_img</span></a> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><a class="sphx-glr-backref-module-nilearn-image sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.image.iter_img.html#nilearn.image.iter_img title=nilearn.image.iter_img><span class=n>iter_img</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>dictlearning_components_img</span></a><span class=p>)):</span>
    <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map title=nilearn.plotting.plot_stat_map><span class=n>plot_stat_map</span></a><span class=p>(</span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>cur_img</span></a><span class=p>,</span> <span class=n>display_mode</span><span class=o>=</span><span class=s2>"z"</span><span class=p>,</span> <span class=n>title</span><span class=o>=</span><span class=s2>"Comp </span><span class=si>%d</span><span class=s2>"</span> <span class=o>%</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>i</span></a><span class=p>,</span>
                  <span class=n>cut_coords</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</pre></div></div><ul class=sphx-glr-horizontal><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_023.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_024.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_025.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_026.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_027.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_028.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_029.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_030.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_031.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_032.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_033.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_034.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_035.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_036.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_037.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_038.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_039.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_040.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_041.png></li><li><img alt="plot compare decomposition"class="sphx-glr-multi-img first"src=../../_images/sphx_glr_plot_compare_decomposition_042.png></li></ul><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>/home/varoquau/dev/nilearn/nilearn/plotting/displays.py:1608: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  ax = fh.add_axes([fraction * index * (x1 - x0) + x0, y0,
</pre></div></div><p>Estimate explained variance per component and plot using matplotlib</p><p>The fitted object <cite>dict_learning</cite> can be used to calculate the score per component</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>scores</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-decomposition sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.decomposition.DictLearning.html#nilearn.decomposition.DictLearning.score title=nilearn.decomposition.DictLearning.score><span class=n>dict_learning</span><span class=o>.</span><span class=n>score</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>func_filenames</span></a><span class=p>,</span> <span class=n>per_component</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Plot the scores</span>
<span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=kn>from</span> <span class=nn>matplotlib</span> <span class=k>import</span> <span class=n>pyplot</span> <span class=k>as</span> <span class=n>plt</span>
<span class=kn>from</span> <span class=nn>matplotlib.ticker</span> <span class=k>import</span> <a class="sphx-glr-backref-module-matplotlib-ticker sphx-glr-backref-type-py-class"href=https://matplotlib.org/api/ticker_api.html#matplotlib.ticker.FormatStrFormatter title=matplotlib.ticker.FormatStrFormatter><span class=n>FormatStrFormatter</span></a>

<a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure title=matplotlib.pyplot.figure><span class=n>plt</span><span class=o>.</span><span class=n>figure</span></a><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>positions</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange title=numpy.arange><span class=n>np</span><span class=o>.</span><span class=n>arange</span></a><span class=p>(</span><span class=nb>len</span><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>scores</span></a><span class=p>))</span>
<a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/api/_as_gen/matplotlib.pyplot.barh.html#matplotlib.pyplot.barh title=matplotlib.pyplot.barh><span class=n>plt</span><span class=o>.</span><span class=n>barh</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>positions</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>scores</span></a><span class=p>)</span>
<a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel title=matplotlib.pyplot.ylabel><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span></a><span class=p>(</span><span class=s1>'Component #'</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
<a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel title=matplotlib.pyplot.xlabel><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span></a><span class=p>(</span><span class=s1>'Explained variance'</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
<a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks title=matplotlib.pyplot.yticks><span class=n>plt</span><span class=o>.</span><span class=n>yticks</span></a><span class=p>(</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange title=numpy.arange><span class=n>np</span><span class=o>.</span><span class=n>arange</span></a><span class=p>(</span><span class=mi>20</span><span class=p>))</span>
<a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/api/_as_gen/matplotlib.pyplot.gca.html#matplotlib.pyplot.gca title=matplotlib.pyplot.gca><span class=n>plt</span><span class=o>.</span><span class=n>gca</span></a><span class=p>()</span><span class=o>.</span><span class=n>xaxis</span><span class=o>.</span><span class=n>set_major_formatter</span><span class=p>(</span><a class="sphx-glr-backref-module-matplotlib-ticker sphx-glr-backref-type-py-class"href=https://matplotlib.org/api/ticker_api.html#matplotlib.ticker.FormatStrFormatter title=matplotlib.ticker.FormatStrFormatter><span class=n>FormatStrFormatter</span></a><span class=p>(</span><span class=s1>'</span><span class=si>%.3f</span><span class=s1>'</span><span class=p>))</span>
<a class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"href=https://matplotlib.org/api/_as_gen/matplotlib.pyplot.tight_layout.html#matplotlib.pyplot.tight_layout title=matplotlib.pyplot.tight_layout><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span></a><span class=p>()</span>

<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.show.html#nilearn.plotting.show title=nilearn.plotting.show><span class=n>show</span></a><span class=p>()</span>
</pre></div></div><img alt="plot compare decomposition"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_compare_decomposition_043.png><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>________________________________________________________________________________
[Memory] Calling nilearn.decomposition.base.explained_variance...
explained_variance(array([[-2.447329e+00, ...,  8.748525e-02],
       ...,
       [-2.399295e-14, ..., -4.933175e-16]]),
array([[0., ..., 0.],
       ...,
       [0., ..., 0.]]), per_component=True)
/home/varoquau/dev/nilearn/nilearn/decomposition/base.py:494: UserWarning: Persisting input arguments took 1.76s to run.
If this happens often in your code, it can cause performance problems
(results will be correct in all cases).
The reason for this is probably some large input arguments for a wrapped
 function (e.g. large strings).
THIS IS A JOBLIB ISSUE. If you can, kindly provide the joblib's team with an
 example so that they can fix the problem.
  return self._cache(explained_variance)(data, self.components_,
_____________________________________________explained_variance - 125.3s, 2.1min
</pre></div></div><div class="admonition note"><p class="first admonition-title">Note</p><p class=last>To see how to extract subject-level timeseries’ from regions created using Dictionary Learning, see <a class="reference internal"href=plot_extract_regions_dictlearning_maps.html#sphx-glr-auto-examples-03-connectivity-plot-extract-regions-dictlearning-maps-py><span class="std std-ref">example Regions extraction using Dictionary Learning and functional connectomes</span></a>.</p></div><p class=sphx-glr-timing><strong>Total running time of the script:</strong> ( 6 minutes 20.687 seconds)</p><div class="sphx-glr-footer class sphx-glr-footer-example docutils container"id=sphx-glr-download-auto-examples-03-connectivity-plot-compare-decomposition-py><div class="binder-badge docutils container"><a class="reference external image-reference"href=https://mybinder.org/v2/gh/nilearn/nilearn.github.io/master?filepath=examples/auto_examples/03_connectivity/plot_compare_decomposition.ipynb><img alt=https://mybinder.org/badge_logo.svg src=https://mybinder.org/badge_logo.svg width=150px></a></div><div class="sphx-glr-download sphx-glr-download-python docutils container"><a class="reference download internal"download href=../../_downloads/a01c2cea079d41388bb4285ccacc1b59/plot_compare_decomposition.py><code class="xref download docutils literal notranslate"><span class=pre>Download</span> <span class=pre>Python</span> <span class=pre>source</span> <span class=pre>code:</span> <span class=pre>plot_compare_decomposition.py</span></code></a></div><div class="sphx-glr-download sphx-glr-download-jupyter docutils container"><a class="reference download internal"download href=../../_downloads/228040370ea48e92e9ffdf4d7fe54686/plot_compare_decomposition.ipynb><code class="xref download docutils literal notranslate"><span class=pre>Download</span> <span class=pre>Jupyter</span> <span class=pre>notebook:</span> <span class=pre>plot_compare_decomposition.ipynb</span></code></a></div></div><p class=sphx-glr-signature><a class="reference external"href=https://sphinx-gallery.github.io>Gallery generated by Sphinx-Gallery</a></p></div></div></div></div></div><div aria-label="main navigation"class=sphinxsidebar role=navigation><div class=sphinxsidebarwrapper><h4>Giving credit</h4><ul class=simple><li><p>Please consider <a href=../../authors.html#citing>citing the papers</a>.</p></li></ul><h3><a href=../../index.html>Table of Contents</a></h3><ul><li><a class="reference internal"href=#>9.4.5. Deriving spatial maps from group fMRI data using ICA and Dictionary Learning</a><ul><li><a class="reference internal"href=#load-brain-development-fmri-dataset>9.4.5.1. Load brain development fmri dataset</a></li><li><a class="reference internal"href=#apply-canica-on-the-data>9.4.5.2. Apply CanICA on the data</a></li><li><a class="reference internal"href=#compare-canica-to-dictionary-learning>9.4.5.3. Compare CanICA to dictionary learning</a></li></ul></li></ul><h4>Previous topic</h4><p class=topless><a title="previous chapter"href=plot_simulated_connectome.html>9.4.4. Connectivity structure estimation on simulated data</a></p><h4>Next topic</h4><p class=topless><a title="next chapter"href=plot_atlas_comparison.html>9.4.6. Comparing connectomes on different reference atlases</a></p><div id=searchbox role=search style=display:none><h3>Quick search</h3><div class=searchformwrapper><form action=../../search.html class=search><input name=q><input type=submit value=Go><input name=check_keywords type=hidden value=yes><input name=area type=hidden value=default></form></div></div><script>$('#searchbox').show(0);</script></div></div><div class=clearer></div></div><div class=footer>© The nilearn developers 2010-2020. Created using <a href=http://sphinx.pocoo.org/>Sphinx</a> 1.8.5. <span style=padding-left:5ex> <a href=../../_sources/auto_examples/03_connectivity/plot_compare_decomposition.rst.txt rel=nofollow>Show this page source</a> </span></div></body></html>