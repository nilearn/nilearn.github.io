<!doctypehtml><html lang=en xmlns=http://www.w3.org/1999/xhtml><meta content=IE=Edge http-equiv=X-UA-Compatible><meta content="text/html; charset=utf-8"http-equiv=Content-Type><title>Nilearn: Statistical Analysis for NeuroImaging in Python — Machine learning for NeuroImaging</title><link href=../../_static/nature.css rel=stylesheet><link href=../../_static/pygments.css rel=stylesheet><link href=../../_static/gallery.css rel=stylesheet><link href=../../_static/gallery-binder.css rel=stylesheet><link href=../../_static/gallery-dataframe.css rel=stylesheet><script data-url_root=../../ id=documentation_options src=../../_static/documentation_options.js></script><script src=../../_static/jquery.js></script><script src=../../_static/underscore.js></script><script src=../../_static/doctools.js></script><script src=../../_static/language_data.js></script><script src=../../_static/copybutton.js></script><link rel="shortcut icon"href=../../_static/favicon.ico><link href=../../search.html rel=search title=Search><link title="9.6.4. Second-level fMRI model: a two-sample test"href=plot_second_level_two_sample_test.html rel=next><link title="9.6.2. Second-level fMRI model: true positive proportion in clusters"href=plot_proportion_activated_voxels.html rel=prev><meta content=True name=HandheldFriendly><meta content=width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0 name=viewport><meta content="nilearn, neuroimaging, python, neuroscience, machinelearning"name=keywords><script>function updateTopMenuPosition(height, width) {
    if($(window).scrollTop() > height && $(window).outerWidth() > 1024) {
        //begin to scroll
        $('.related-wrapper').css("z-index", 1000);
        $('.related-wrapper').css("position", "sticky");
        $('.related-wrapper').css("top", 0);
        $('.related-wrapper').css("width", width)
    } else {
        //lock it back into place
        $('.related-wrapper').css("position", "relative");
        $('.related-wrapper').css("top", 0)
    }
}

$(function() {
    var banner_height = $('#logo-banner').outerHeight();
    var banner_width = $('#logo-banner').outerWidth();
    var width = $('.related-wrapper').css("height", $('.related').outerHeight());

    updateTopMenuPosition(banner_height, width);

    $(window).scroll(function(event) {
        updateTopMenuPosition(banner_height, width)
    });

    $(window).resize(function(event) {
        var banner_width = $('#logo-banner').outerWidth();
        var menu_height = $('.related').outerHeight();
        $('.related').css("width", banner_width);
        $('.related-wrapper').css("height", menu_height);
        updateTopMenuPosition(banner_height, width)
    })
});</script><script>function updateSideBarPosition(top, offset, sections) {
    var pos = $(window).scrollTop();
    // Lock the table of content to a fixed position once we scroll enough
    var topShift = 2 * offset;
    if(pos > top + topShift + 1) {
        // begin to scroll with sticky menu bar
        var topShift = -topShift + 1;
        if ($(window).outerWidth() < 1024) {
            // compensate top menu that disappears
            topShift -= offset + 1
        }
        $('.sphinxsidebarwrapper').css("position", "fixed");
        $('.sphinxsidebarwrapper').css("top", topShift)
    }
    else {
        //lock it back into place
        $('.sphinxsidebarwrapper').css("position", "relative");
        $('.sphinxsidebarwrapper').css("top",0)
    }

    // Highlight the current section
    i = 0;
    current_section = 0;
    $('a.internal').removeClass('active');
    for(i in sections) {
        if(sections[i] > pos) {
            break
        }
        if($('a.internal[href$="' + i + '"]').is(':visible')){
            current_section = i
        }
    }
    $('a.internal[href$="' + current_section + '"]').addClass('active');
    $('a.internal[href$="' + current_section + '"]').parent().addClass('active')
}

$(function () {
    // Lock the table of content to a fixed position once we scroll enough
    var tocOffset = $('.related-wrapper').outerHeight();
    var marginTop = parseFloat($('.sphinxsidebarwrapper').css('margin-top').replace(/auto/, 0));
    var top = $('.sphinxsidebarwrapper').offset().top - marginTop;
    sections = {};
    url = document.URL.replace(/#.*$/, "");

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50
    });

    updateSideBarPosition(top, tocOffset, sections);

    $(window).scroll(function(event) {
        updateSideBarPosition(top, tocOffset, sections)
    });

    $(window).resize(function(event) {
        tocOffset = $('.related-wrapper').outerHeight();
        updateSideBarPosition(top, tocOffset, sections)
    });
});</script><script>var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-41920728-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();</script></head><body><div id=logo-banner><div class=logo><a href=../../index.html> <img alt="Nilearn logo"border=0 src=../../_static/nilearn-logo.png> </a></div><div class=tags><ul><li><big><a href=../decoding/plot_haxby_anova_svm.html>SVM</a></big></li><li><small><a href=../../connectivity/parcellating.html>Ward clustering</a></small></li><li><a href=../../decoding/searchlight.html>Searchlight</a></li><li><big><a href=../../connectivity/resting_state_networks.html>ICA</a></big></li><li><a href=../../manipulating_images/data_preparation.html>Nifti IO</a></li><li><a href=../../modules/reference.html#module-nilearn.datasets>Datasets</a></li></ul></div><div class=banner><h1>Nilearn:</h1><h2>Statistics for NeuroImaging in Python</h2></div><div class=search_form><div class=gcse-search id=cse style=width:100%></div><script>(function() {
        var cx = '017289614950330089114:elrt9qoutrq';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();</script></div></div><div class=related-wrapper><div aria-label="related navigation"class=related role=navigation><h3>Navigation</h3><ul><li class=right style=margin-right:10px><a title="Python Module Index"href=../../py-modindex.html>modules</a></li><li class=right><a title="9.6.4. Second-level fMRI model: a two-sample test"accesskey=N href=plot_second_level_two_sample_test.html>next</a> |</li><li class=right><a title="9.6.2. Second-level fMRI model: true positive proportion in clusters"accesskey=P href=plot_proportion_activated_voxels.html>previous</a> |</li><li><a href=../../index.html>Nilearn Home</a> | </li><li><a href=../../user_guide.html>User Guide</a> | </li><li><a href=../index.html>Examples</a> | </li><li><a href=../../modules/reference.html>Reference</a> | </li><li id=navbar-about><a href=../../authors.html>About</a>| </li><li id=navbar-ecosystem><a href=http://www.nipy.org/>Nipy ecosystem</a></li><li class="nav-item nav-item-1"><a href=../../user_guide.html>User guide: table of contents</a> »</li><li class="nav-item nav-item-2"><a accesskey=U href=../index.html>9. Nilearn usage examples</a> »</li></ul></div></div><div class=document><div class=documentwrapper><div class=bodywrapper><div class=body role=main><div class="sphx-glr-download-link-note admonition note"><p class="first admonition-title">Note</p><p class=last>Click <a class="reference internal"href=#sphx-glr-download-auto-examples-05-glm-second-level-plot-second-level-paired-sample-test-py><span class="std std-ref">here</span></a> to download the full example code or to run this example in your browser via Binder</p></div><div class="sphx-glr-example-title section"id=second-level-fmri-model-a-paired-sample-test><span id=sphx-glr-auto-examples-05-glm-second-level-plot-second-level-paired-sample-test-py></span><h1>9.6.3. Second-level fMRI model: a paired-sample test<a title="Permalink to this headline"class=headerlink href=#second-level-fmri-model-a-paired-sample-test>¶</a></h1><p>Full step-by-step example of fitting a GLM to perform a second level analysis in experimental data and visualizing the results.</p><p>More specifically:</p><ol class="arabic simple"><li>A sample of n=16 visual activity fMRIs are downloaded.</li><li>A paired one-sample t-test is applied to the brain maps in order to see the effect of the contrast difference across subjects.</li></ol><p>The contrast is between responses to vertical versus horizontal checkerboards that are retinotopically distinct. At the individual level, these stimuli are sometimes used to map the borders of primary visual areas. At the group level, such a mapping is not possible. Yet, we may observe some significant effects in these areas.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
<span class=kn>from</span> <span class=nn>nilearn</span> <span class=k>import</span> <span class=n>plotting</span>
<span class=kn>from</span> <span class=nn>nilearn.datasets</span> <span class=k>import</span> <a class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.datasets.fetch_localizer_contrasts.html#nilearn.datasets.fetch_localizer_contrasts title=nilearn.datasets.fetch_localizer_contrasts><span class=n>fetch_localizer_contrasts</span></a>
</pre></div></div><div class=section id=fetch-dataset><h2>9.6.3.1. Fetch dataset<a title="Permalink to this headline"class=headerlink href=#fetch-dataset>¶</a></h2><p>We download a list of left vs right button press contrasts from a localizer dataset.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>n_subjects</span></a> <span class=o>=</span> <span class=mi>16</span>
<a class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"href=https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch title=sklearn.utils.Bunch><span class=n>sample_vertical</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.datasets.fetch_localizer_contrasts.html#nilearn.datasets.fetch_localizer_contrasts title=nilearn.datasets.fetch_localizer_contrasts><span class=n>fetch_localizer_contrasts</span></a><span class=p>(</span>
    <span class=p>[</span><span class=s2>"vertical checkerboard"</span><span class=p>],</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>n_subjects</span></a><span class=p>,</span> <span class=n>get_tmaps</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"href=https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch title=sklearn.utils.Bunch><span class=n>sample_horizontal</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-datasets sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.datasets.fetch_localizer_contrasts.html#nilearn.datasets.fetch_localizer_contrasts title=nilearn.datasets.fetch_localizer_contrasts><span class=n>fetch_localizer_contrasts</span></a><span class=p>(</span>
    <span class=p>[</span><span class=s2>"horizontal checkerboard"</span><span class=p>],</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>n_subjects</span></a><span class=p>,</span> <span class=n>get_tmaps</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># What remains implicit here is that there is a one-to-one</span>
<span class=c1># correspondence between the two samples: the first image of both</span>
<span class=c1># samples comes from subject S1, the second from subject S2 etc.</span>
</pre></div></div><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>/usr/lib/python3/dist-packages/numpy/lib/npyio.py:2358: VisibleDeprecationWarning: Reading unicode strings without specifying the encoding argument is deprecated. Set the encoding, use None for the system default.
  output = genfromtxt(fname, **kwargs)
</pre></div></div></div><div class=section id=estimate-second-level-model><h2>9.6.3.2. Estimate second level model<a title="Permalink to this headline"class=headerlink href=#estimate-second-level-model>¶</a></h2><p>We define the input maps and the design matrix for the second level model and fit it.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>second_level_input</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"href=https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch title=sklearn.utils.Bunch><span class=n>sample_vertical</span></a><span class=p>[</span><span class=s1>'cmaps'</span><span class=p>]</span> <span class=o>+</span> <a class="sphx-glr-backref-module-sklearn-utils sphx-glr-backref-type-py-function"href=https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch title=sklearn.utils.Bunch><span class=n>sample_horizontal</span></a><span class=p>[</span><span class=s1>'cmaps'</span><span class=p>]</span>
</pre></div></div><p>Next, we model the effect of conditions (sample 1 vs sample 2).</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>condition_effect</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.hstack.html#numpy.hstack title=numpy.hstack><span class=n>np</span><span class=o>.</span><span class=n>hstack</span></a><span class=p>(([</span><span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>n_subjects</span></a><span class=p>,</span> <span class=p>[</span><span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>n_subjects</span></a><span class=p>))</span>
</pre></div></div><p>Subsequently, we can model the subject effect: each subject is observed in sample 1 and sample 2.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>subject_effect</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.vstack.html#numpy.vstack title=numpy.vstack><span class=n>np</span><span class=o>.</span><span class=n>vstack</span></a><span class=p>((</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.eye.html#numpy.eye title=numpy.eye><span class=n>np</span><span class=o>.</span><span class=n>eye</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>n_subjects</span></a><span class=p>),</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.eye.html#numpy.eye title=numpy.eye><span class=n>np</span><span class=o>.</span><span class=n>eye</span></a><span class=p>(</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>n_subjects</span></a><span class=p>)))</span>
<a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>subjects</span></a> <span class=o>=</span> <span class=p>[</span><span class=s1>'S</span><span class=si>%02d</span><span class=s1>'</span> <span class=o>%</span> <span class=n>i</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#int title=builtins.int><span class=n>n_subjects</span></a> <span class=o>+</span> <span class=mi>1</span><span class=p>)]</span>
</pre></div></div><p>We then assemble those in a design matrix and</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.DataFrame><span class=n>design_matrix</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-class"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.DataFrame><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"href=https://numpy.org/doc/stable/reference/generated/numpy.hstack.html#numpy.hstack title=numpy.hstack><span class=n>np</span><span class=o>.</span><span class=n>hstack</span></a><span class=p>((</span><a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>condition_effect</span></a><span class=p>[:,</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"href=https://numpy.org/doc/stable/reference/constants.html#numpy.newaxis title=numpy.newaxis><span class=n>np</span><span class=o>.</span><span class=n>newaxis</span></a><span class=p>],</span> <a class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray title=numpy.ndarray><span class=n>subject_effect</span></a><span class=p>)),</span>
    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>'vertical vs horizontal'</span><span class=p>]</span> <span class=o>+</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>subjects</span></a><span class=p>)</span>
</pre></div></div><p>plot the design_matrix.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn.plotting</span> <span class=k>import</span> <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_design_matrix.html#nilearn.plotting.plot_design_matrix title=nilearn.plotting.plot_design_matrix><span class=n>plot_design_matrix</span></a>
<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_design_matrix.html#nilearn.plotting.plot_design_matrix title=nilearn.plotting.plot_design_matrix><span class=n>plot_design_matrix</span></a><span class=p>(</span><a class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.DataFrame><span class=n>design_matrix</span></a><span class=p>)</span>
</pre></div></div><img alt="plot second level paired sample test"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_second_level_paired_sample_test_001.png><p class=sphx-glr-script-out>Out:</p><div class="sphx-glr-script-out highlight-none notranslate"><div class=highlight><pre><span></span>&LTmatplotlib.axes._subplots.AxesSubplot object at 0x7f8bfc607670>
</pre></div></div><p>We formally specify the analysis model and fit it.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><span class=kn>from</span> <span class=nn>nilearn.glm.second_level</span> <span class=k>import</span> <a class="sphx-glr-backref-module-nilearn-glm-second_level sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.glm.second_level.SecondLevelModel.html#nilearn.glm.second_level.SecondLevelModel title=nilearn.glm.second_level.SecondLevelModel><span class=n>SecondLevelModel</span></a>
<a class="sphx-glr-backref-module-nilearn-glm-second_level sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=../../modules/generated/nilearn.glm.second_level.SecondLevelModel.html#nilearn.glm.second_level.SecondLevelModel title=nilearn.glm.second_level.SecondLevelModel><span class=n>second_level_model</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-glm-second_level sphx-glr-backref-type-py-class"href=../../modules/generated/nilearn.glm.second_level.SecondLevelModel.html#nilearn.glm.second_level.SecondLevelModel title=nilearn.glm.second_level.SecondLevelModel><span class=n>SecondLevelModel</span></a><span class=p>()</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span>
    <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/stdtypes.html#list title=builtins.list><span class=n>second_level_input</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.DataFrame><span class=n>design_matrix</span></a><span class=o>=</span><a class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame title=pandas.DataFrame><span class=n>design_matrix</span></a><span class=p>)</span>
</pre></div></div><p>Estimating the contrast is very simple. We can just provide the column name of the design matrix.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>z_map</span></a> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-glm-second_level sphx-glr-backref-type-py-method"href=../../modules/generated/nilearn.glm.second_level.SecondLevelModel.html#nilearn.glm.second_level.SecondLevelModel.compute_contrast title=nilearn.glm.second_level.SecondLevelModel.compute_contrast><span class=n>second_level_model</span><span class=o>.</span><span class=n>compute_contrast</span></a><span class=p>(</span><span class=s1>'vertical vs horizontal'</span><span class=p>,</span>
                                            <span class=n>output_type</span><span class=o>=</span><span class=s1>'z_score'</span><span class=p>)</span>
</pre></div></div><p>We threshold the second level contrast and plot it.</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#float title=builtins.float><span class=n>threshold</span></a> <span class=o>=</span> <span class=mf>3.1</span>  <span class=c1># correponds to  p < .001, uncorrected</span>
<span class=n>display</span> <span class=o>=</span> <a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.plot_glass_brain.html#nilearn.plotting.plot_glass_brain title=nilearn.plotting.plot_glass_brain><span class=n>plotting</span><span class=o>.</span><span class=n>plot_glass_brain</span></a><span class=p>(</span>
    <a class="sphx-glr-backref-module-nibabel-nifti1 sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://nipy.org/nibabel/reference/nibabel.nifti1.html#nibabel.nifti1.Nifti1Image title=nibabel.nifti1.Nifti1Image><span class=n>z_map</span></a><span class=p>,</span> <a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#float title=builtins.float><span class=n>threshold</span></a><span class=o>=</span><a class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"href=https://docs.python.org/3.6/library/functions.html#float title=builtins.float><span class=n>threshold</span></a><span class=p>,</span> <span class=n>colorbar</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>plot_abs</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
    <span class=n>title</span><span class=o>=</span><span class=s1>'vertical vs horizontal checkerboard (unc p&LT0.001'</span><span class=p>)</span>

<a class="sphx-glr-backref-module-nilearn-plotting sphx-glr-backref-type-py-function"href=../../modules/generated/nilearn.plotting.show.html#nilearn.plotting.show title=nilearn.plotting.show><span class=n>plotting</span><span class=o>.</span><span class=n>show</span></a><span class=p>()</span>
</pre></div></div><img alt="plot second level paired sample test"class=sphx-glr-single-img src=../../_images/sphx_glr_plot_second_level_paired_sample_test_002.png><p>Unsurprisingly, we see activity in the primary visual cortex, both positive and negative.</p><p class=sphx-glr-timing><strong>Total running time of the script:</strong> ( 0 minutes 5.887 seconds)</p><div class="sphx-glr-footer class sphx-glr-footer-example docutils container"id=sphx-glr-download-auto-examples-05-glm-second-level-plot-second-level-paired-sample-test-py><div class="binder-badge docutils container"><a class="reference external image-reference"href=https://mybinder.org/v2/gh/nilearn/nilearn.github.io/master?filepath=examples/auto_examples/05_glm_second_level/plot_second_level_paired_sample_test.ipynb><img alt=https://mybinder.org/badge_logo.svg src=https://mybinder.org/badge_logo.svg width=150px></a></div><div class="sphx-glr-download sphx-glr-download-python docutils container"><a class="reference download internal"download href=../../_downloads/6fb116397ced8338d61c4a02502891ba/plot_second_level_paired_sample_test.py><code class="xref download docutils literal notranslate"><span class=pre>Download</span> <span class=pre>Python</span> <span class=pre>source</span> <span class=pre>code:</span> <span class=pre>plot_second_level_paired_sample_test.py</span></code></a></div><div class="sphx-glr-download sphx-glr-download-jupyter docutils container"><a class="reference download internal"download href=../../_downloads/6c1f81baea406506c015577f86ef2316/plot_second_level_paired_sample_test.ipynb><code class="xref download docutils literal notranslate"><span class=pre>Download</span> <span class=pre>Jupyter</span> <span class=pre>notebook:</span> <span class=pre>plot_second_level_paired_sample_test.ipynb</span></code></a></div></div><p class=sphx-glr-signature><a class="reference external"href=https://sphinx-gallery.github.io>Gallery generated by Sphinx-Gallery</a></p></div></div></div></div></div><div aria-label="main navigation"class=sphinxsidebar role=navigation><div class=sphinxsidebarwrapper><h4>Giving credit</h4><ul class=simple><li><p>Please consider <a href=../../authors.html#citing>citing the papers</a>.</p></li></ul><h3><a href=../../index.html>Table of Contents</a></h3><ul><li><a class="reference internal"href=#>9.6.3. Second-level fMRI model: a paired-sample test</a><ul><li><a class="reference internal"href=#fetch-dataset>9.6.3.1. Fetch dataset</a></li><li><a class="reference internal"href=#estimate-second-level-model>9.6.3.2. Estimate second level model</a></li></ul></li></ul><h4>Previous topic</h4><p class=topless><a title="previous chapter"href=plot_proportion_activated_voxels.html>9.6.2. Second-level fMRI model: true positive proportion in clusters</a></p><h4>Next topic</h4><p class=topless><a title="next chapter"href=plot_second_level_two_sample_test.html>9.6.4. Second-level fMRI model: a two-sample test</a></p><div id=searchbox role=search style=display:none><h3>Quick search</h3><div class=searchformwrapper><form action=../../search.html class=search><input name=q><input type=submit value=Go><input name=check_keywords type=hidden value=yes><input name=area type=hidden value=default></form></div></div><script>$('#searchbox').show(0);</script></div></div><div class=clearer></div></div><div class=footer>© The nilearn developers 2010-2020. Created using <a href=http://sphinx.pocoo.org/>Sphinx</a> 1.8.5. <span style=padding-left:5ex> <a href=../../_sources/auto_examples/05_glm_second_level/plot_second_level_paired_sample_test.rst.txt rel=nofollow>Show this page source</a> </span></div></body></html>